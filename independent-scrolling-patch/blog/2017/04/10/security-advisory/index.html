<!DOCTYPE html>
<html lang="en">
<head>
<title>
Important Scripting-related Security Advisory
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/blog/2017/04/10/security-advisory/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Important Scripting-related Security Advisory" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Important Scripting-related Security Advisory" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Important Scripting-related Security Advisory" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/blog/2017/04/10/security-advisory/" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Important Scripting-related Security Advisory" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.app-post-page h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<article class="container app-post-page">
<div class="app-!-display-flex">
<a class="app-back-link" href="/jenkins.io/independent-scrolling-patch/node/">
Back to blog
</a>
</div>
<h1>
Important Scripting-related Security Advisory
</h1>
<div class="post-attrs">
<a class="app-author-link" href="/blog/authors/daniel-beck/"><div class="app-avatar"></div> Daniel Beck</a>
April 10, 2017
<a class="twitter-share-button" data-lang="en" href="https://twitter.com/intent/tweet?text=Important+Scripting-related+Security+Advisory&amp;url=https%3A%2F%2Fwww.jenkins.io%2Fjenkins.io%2Findependent-scrolling-patch%2Fblog%2F2017%2F04%2F10%2Fsecurity-advisory%2F" rel="noreferrer nofollow" target="_blank">
Tweet
</a>
</div>
<div class="blog-content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
These are not security fixes you can apply blindly. We strongly recommend you read this post, as well as the <a href="/security/advisory/2017-04-10/">security advisory</a> to understand what the vulnerabilities are, whether and how they affect you, and what to expect when upgrading plugins.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Multiple Jenkins plugins received updates today that fix several security vulnerabilities or other security-related issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://plugins.jenkins.io/email-ext">Email Extension (Email-ext)</a></p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/envinject">Environment Injector (EnvInject)</a></p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/extensible-choice-parameter">Extensible Choice Parameter</a></p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/groovy">Groovy</a></p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/job-dsl">Job DSL</a></p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/lockable-resources">Lockable Resources</a></p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/matrix-auth">Matrix Authorization</a></p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/role-strategy">Role Strategy</a></p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/warnings">Warnings</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We also included some plugins that received security fixes in the past that haven&#8217;t been mentioned in a security advisory before:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Active+Choices+Plugin">Active Choices (uno-choice)</a></p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/extended-choice-parameter">Extended Choice Parameter</a></p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/groovy-postbuild">Groovy Postbuild</a></p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/groovy-label-assignment">Groovy Label Assignment</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, we included other plugins in the advisory that are not getting updated today, but whose vulnerabilities are similar to those of plugins getting fixed.
In total, over 30 plugins are part of the <a href="/security/advisory/2017-04-10/">advisory</a>.</p>
</div>
<div class="paragraph">
<p>While there are fixes for other vulnerabilities as well, the majority of the advisory (and the rest of this blog post) is about arbitrary code execution vulnerabilities in Jenkins plugins.</p>
</div>
<div class="sect2">
<h3 id="background"><a class="anchor" href="#background"></a>Background</h3>
<div class="paragraph">
<p>Jenkins administrators have long been able to use the Groovy script console and related functionality to execute arbitrary code in Jenkins for diagnostic or otherwise administrative purposes.
Rather than having to rely on plugins implementing the desired functionality, experienced Jenkins admins were able to run a number of scripts as needed to implement various administrative features.</p>
</div>
<div class="paragraph">
<p>This bled over into plugins:
It&#8217;s just <em>easy</em> for a plugin developer to build on top of Groovy and let the users figure out exactly what they want to do.
Unfortunately, for a long time, there was no technology in Jenkins to limit what could be done in Groovy scripts, so anywhere Groovy would be executed, arbitrary code could be executed.</p>
</div>
<div class="paragraph">
<p>We were treating this as a security issue for the first time in the fix for SECURITY-125, about two years ago, something that first required splitting off the Matrix Project type from core into a plugin, and making use of <a href="https://plugins.jenkins.io/script-security">Script Security Plugin</a>.</p>
</div>
<div class="paragraph">
<p>Unfortunately, other plugins weren&#8217;t integrating with Script Security plugin.
And even diligent administrators who understand the problem of arbitrary code execution via Groovy scripts may not be able to tell whether a given plugin is affected:
In some cases, you&#8217;d need to dive into the source code to see whether, and how, it uses Groovy in a way that can be exploited by regular users to perform actions they otherwise wouldn&#8217;t be allowed to do.</p>
</div>
</div>
<div class="sect2">
<h3 id="about-the-advisory"><a class="anchor" href="#about-the-advisory"></a>About the advisory</h3>
<div class="paragraph">
<p>Broadly speaking, there are three levels of severity for scripting related vulnerabilities in Jenkins:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The lowest severity ones are those that confuse <em>Overall/Administer</em> and <em>Overall/Run Scripts</em> permissions.
These are irrelevant for most Jenkins instances.
More on that later.</p>
</li>
<li>
<p>The next level up are vulnerabilities that effectively grant the ability to run arbitrary scripts to users who are able to configure jobs.
While these users aren&#8217;t administrators, they have a nontrivial level of permissions, so are <em>somewhat</em> trusted.
This is often a difficult configuration to adequately secure, but it&#8217;s a supported configuration, and any plugin that undermines the security of this configuration will be treated as having a vulnerability.</p>
</li>
<li>
<p>The most severe ones are those that require little or no access to Jenkins to successfully exploit.
This typically does require the <em>Overall/Read</em> permission to access certain endpoints, but Pipeline as Code may allow people with SCM commit access to exploit scripting related weaknesses as well.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Arbitrary code execution is a serious enough issue that publishing a security advisory for just a few plugins would actually be detrimental to overall security:
Malicious users would be able to review the fixes we do publish, and try to find other plugins affected by a similar vulnerability.</p>
</div>
<div class="paragraph">
<p><a href="/security/advisory/2017-04-10/">The advisory issued today</a> lists all plugins we could find that implement any arbitrary code execution vulnerability (i.e. all three levels described above).
As this affects over 30 plugins, many of them not actively maintained, the problem exceeds the capacity of the Jenkins security team to address them all.</p>
</div>
<div class="paragraph">
<p>For that reason, <a href="/security">the Jenkins security team</a> decided that we would fix as many of the plugins as we can handle, and leaving the others to their maintainers.</p>
</div>
</div>
<div class="sect2">
<h3 id="how-to-proceed"><a class="anchor" href="#how-to-proceed"></a>How to proceed</h3>
<div class="paragraph">
<p>We strongly advise administrators to review the list of affected plugins in the advisory, and look for any plugins that are installed on their instances.
It is very likely there&#8217;s at least one plugin installed that is affected by this.
If you&#8217;re on Jenkins 2.40 or newer, or Jenkins LTS 2.32.2 or newer, a warning will appear that informs you about vulnerable plugins you currently have installed.</p>
</div>
<div class="paragraph">
<p>Once you&#8217;ve determined which plugins you use are included in the advisory, you need to determine whether it is something that affects your particular setup.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the vulnerability confuses <em>Overall/Administer</em> and <em>Overall/Run Scripts</em>, but all administrators of your Jenkins instance are able to run scripts anyway, this vulnerability is not a problem for you.
This is the case in the vast majority of Jenkins instances.
Only custom setups, typically to allow for hosted Jenkins services, don&#8217;t grant <em>Overall/Run Scripts</em> permission to administrators.</p>
</li>
<li>
<p>If the vulnerability allows users with the permission to e.g. configure jobs to execute arbitrary code, it is only a problem if there are users that have the lower permission (e.g. <em>Item/Configure</em>) but not the higher (<em>Overall/Run Scripts</em>).
Simple authorization strategies like <em>Logged in users can do anything</em> are therefore not affected by this issue.</p>
</li>
<li>
<p>Even vulnerabilities that require no notable permissions in Jenkins may have prerequisites to be exploitable.
For example, <em>Overall/Read</em> access may be required, but only granted to users who are also administrators, or in Pipeline as Code setups, everyone with SCM commit access may also be a Jenkins administrator.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The above should guide your decision how urgently you should upgrade affected plugins with a fix, or disable affected plugins without a fix.
Remember that you may decide in the future to reconfigure Jenkins in a way that makes previously irrelevant permission distinctions a huge problem, so it is not a good idea to continue using vulnerable plugin versions indefinitely.</p>
</div>
<div class="paragraph">
<p>After deciding to upgrade a plugin, review the advisory and the plugin documentation for information about the migration.
The scripts provided in <a href="https://github.com/jenkinsci-cert/security-advisory-2017-04-10">this GitHub repository</a> may help you in determining whether you&#8217;re using affected features.
If you&#8217;re not using any of the affected features, it&#8217;s likely that there won&#8217;t be any problems and you can just upgrade.
If you are using affected features, you should carefully read the documentation on how the upgrade works: Affected plugin features may effectively be disabled until an administrator approves the scripts in use, potentially resulting in build failures.</p>
</div>
</div>
<div class="sect2">
<h3 id="distributing-vulnerable-plugins"><a class="anchor" href="#distributing-vulnerable-plugins"></a>Distributing vulnerable plugins</h3>
<div class="paragraph">
<p>Finally, there&#8217;s the issue of distribution:
The Jenkins project historically has performed little to no oversight over the plugins that are being published.
This is a direct consequence of the <a href="/project/governance">governance document</a>, which gives plugin maintainers a lot of control over their plugins.</p>
</div>
<div class="paragraph">
<p>That said, in exceptional circumstances, the Jenkins project can, and should, protect its users:
If a plugin maintainer were to upload a clearly malicious plugin, we wouldn&#8217;t stand by the side and continue distributing it.
In the case of plugins with known (unintended) vulnerabilities, this obviously becomes more difficult.
This has been <a href="https://groups.google.com/d/msg/jenkinsci-dev/NaAqqChOVmY/BvA_TuzjAQAJ">discussed in the abstract a while back</a> on the <a href="/mailing-lists">jenkinsci-dev mailing list</a>, and the majority of participants in that discussion agreed that we should suspend distribution of vulnerable plugins if the security team doesn&#8217;t have the capacity to address the problem, and the vulnerability would remain unfixed otherwise.</p>
</div>
<div class="paragraph">
<p>We decided to temporarily suspend distribution of plugins via the Jenkins project update sites if they allow users with lower privileges (no <em>Overall/Administer</em>) to execute arbitrary code.
Users who really need to download these plugins can do so via our <a href="https://repo.jenkins-ci.org/">Artifactory Maven repository</a>.
Once an affected plugin receives a fix, we&#8217;d of course resume distribution via the update sites.</p>
</div>
<div class="paragraph">
<p>Plugins that mistake <em>Overall/Administer</em> and <em>Overall/Run Scripts</em> continue being distributed, albeit with <a href="/blog/2017/01/10/security-warnings/">a warning shown to Jenkins administrators</a>, as the setup required for this to make a difference is pretty rare.</p>
</div>
<div class="paragraph">
<p>Unfortunately, we were unable to adequately inform all plugin maintainers before publication of the advisory, so there are several plugins with fewer than 500 installations that are actively maintained but whose maintainers we didn&#8217;t contact prior to this advisory.
For that, I am really sorry, and can only ask for understanding from the maintainers of affected plugins.
The number of affected plugins and the coordination and review required simply exceeded our capabilities.</p>
</div>
<hr>
<div class="paragraph">
<p>Subscribe to the <a href="/mailing-lists">jenkinsci-advisories mailing list</a> to receive important notifications related to Jenkins security.</p>
</div>
</div>
</div>
<ul class="app-tags">
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/plugins/">
plugins
</a>
</li>
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/security/">
security
</a>
</li>
</ul>
<h2>
About the author
</h2>
<!-- starting partial author.html.haml -->
<div class="app-author" id="about-the-author">
<!-- starting partial avatar.html.haml -->
<div class="app-avatar" style="min-width: 64px; width: 25vw; max-width: 128px"></div>

<!-- ending partial avatar.html.haml -->
<div class="app-author__content">
<p class="app-author__name">
<a href="/blog/authors/daniel-beck/">
Daniel Beck
</a>
</p>
<div class="paragraph">
<p>Daniel is a Jenkins core maintainer and member of the <a href="/security/#team">Jenkins security team</a>.
He was the inaugural Jenkins security officer from 2015 to 2021.
He sometimes contributes to developer documentation and project infrastructure in his spare time.</p>
</div>
<!-- starting partial social-media-buttons.html.haml -->
<ul class="app-social-media-buttons">
<li>
<a href="https://github.com/daniel-beck" rel="noreferrer noopener" target="_blank">
GitHub
</a>
</li>
</ul>

<!-- ending partial social-media-buttons.html.haml -->
</div>
</div>

<!-- ending partial author.html.haml -->
<!-- starting partial discuss.html.haml -->

<!-- ending partial discuss.html.haml -->
</article>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//blog/2017/04/2017-04-10-security-advisory.adoc"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
