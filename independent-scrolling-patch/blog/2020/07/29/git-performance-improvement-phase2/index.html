<!DOCTYPE html>
<html lang="en">
<head>
<title>
Git Plugin Performance Improvement Phase-2 Progress
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins â€“ an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/blog/2020/07/29/git-performance-improvement-phase2/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Git Plugin Performance Improvement Phase-2 Progress" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Git Plugin Performance Improvement Phase-2 Progress" name="twitter:title">
<meta content="Jenkins â€“ an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/post-images/2020/07-git-plugin-performance-improvement/gsoc-git-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Git Plugin Performance Improvement Phase-2 Progress" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/blog/2020/07/29/git-performance-improvement-phase2/" property="og:url">
<meta content="Jenkins â€“ an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Git Plugin Performance Improvement Phase-2 Progress" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/post-images/2020/07-git-plugin-performance-improvement/gsoc-git-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.app-post-page h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<article class="container app-post-page">
<div class="app-!-display-flex">
<a class="app-back-link" href="/jenkins.io/independent-scrolling-patch/node/">
Back to blog
</a>
</div>
<h1>
Git Plugin Performance Improvement Phase-2 Progress
</h1>
<div class="post-attrs">
<a class="app-author-link" href="/blog/authors/rishabhbudhouliya/"><div class="app-avatar"><img alt="Rishabh Budhouliya" class="app-avatar__image" src="/images/avatars/rishabhbudhouliya.jpg"></div> Rishabh Budhouliya</a>
July 29, 2020
<a class="twitter-share-button" data-lang="en" href="https://twitter.com/intent/tweet?text=Git+Plugin+Performance+Improvement+Phase-2+Progress&amp;url=https%3A%2F%2Fwww.jenkins.io%2Fjenkins.io%2Findependent-scrolling-patch%2Fblog%2F2020%2F07%2F29%2Fgit-performance-improvement-phase2%2F" rel="noreferrer nofollow" target="_blank">
Tweet
</a>
</div>
<div class="blog-content">
<div class="paragraph">
<p>The second phase of the <a href="/blog/2020/07/09/git-performance-improvement-phase1/">Git Plugin Performance Improvement project</a> has been great in terms of the progress we have achieved in implementing performance improvement insights
derived from the phase one <a href="https://openjdk.java.net/projects/code-tools/jmh/">JMH</a> micro-benchmark experiments.</p>
</div>
<div class="paragraph">
<p>What we&#8217;ve learned so far in this project is that a git fetch is highly correlated to the size of the remote repository. In order to make fetch improvements in this plugin, our task was to find the difference in performance for the two available git implementations in the <a href="https://github.com/jenkinsci/git-plugin">Git Plugin</a>, <code>git</code> and <code>JGit</code>.</p>
</div>
<div class="paragraph">
<p>Our major finding was that <code>git</code> performs much better than <code>JGit</code> when it comes to a large sized repository (&gt;100 MiB). Interestingly, <code>JGit</code> performs better than <code>git</code> when size of the repository is less than 100 MiB.</p>
</div>
<div class="paragraph">
<p>In this phase, we were successful in coding this derived knowledge from the benchmarks into a new functionality called the
GitToolChooser.</p>
</div>
<div class="sect1">
<h2 id="gittoolchooser"><a class="anchor" href="#gittoolchooser"></a>GitToolChooser</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This class aims to add the functionality of recommending a git implementation on the basis of the size of a repository which has a strong correlation to the performance of git fetch (from performance Benchmarks).</p>
</div>
<div class="paragraph">
<p>It utilizes two heuristics to calculate the size:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using cached .git dir from multibranch projects to estimate the size of a repository</p>
</li>
<li>
<p>Providing an extension point which, upon implementation, can use REST APIs exposed by git service providers like Github, GitLab, etc to fetch the size of the remote repository.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Will it optimize your Jenkins instance?
That requires one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>you have a multibranch project in your Jenkins instance, the plugin can use that to recommend the optimal git implementation</p>
</li>
<li>
<p>you have a branch Source Plugin installed in the Jenkins instance, the particular branch source plugin will recommend a git implementation using REST APIs provided by <a href="https://plugins.jenkins.io/github-branch-source/">GitHub</a> or <a href="https://plugins.jenkins.io/gitlab-branch-source/">GitLab</a> respectively.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The architecture and code for this class is at: <a href="https://github.com/jenkinsci/git-plugin/pull/931">PR-931</a></p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: This functionality is an upcoming feature in the subsequent Git Plugin release.</p>
</div>
<div class="sect2">
<h3 id="jmh-benchmarks-in-multiple-environments"><a class="anchor" href="#jmh-benchmarks-in-multiple-environments"></a>JMH benchmarks in multiple environments</h3>
<div class="paragraph">
<p>The benchmarks were being executed on Linux and macOS machines frequently but there was a need to check if the results gained from those benchmarks would hold true across more platforms to ensure that the solution (GitToolChooser) is generally platform-agnostic.</p>
</div>
<div class="paragraph">
<p>To test this hypothesis, we performed an experiment:</p>
</div>
<div class="paragraph">
<p>Running git fetch operation for a 400 MiB sized repository on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Windows</code></p>
</li>
<li>
<p><code>FreeBSD 12</code></p>
</li>
<li>
<p><code>ppc64le</code></p>
</li>
<li>
<p><code>s390x</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The result of running this experiment is given below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="/images/post-images/2020/07-git-plugin-performance-improvement/git-multiple-platforms.png" alt="Performance on multiple platforms"></span></p>
</div>
<div class="paragraph">
<p>Observations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ppc64le</code> and <code>s390x</code> are able to run the operation in almost half the time it takes for the <code>Windows</code> or <code>FreeBSD 12</code> machine. This behavior may be attributed to the increased computational power of those machines.</p>
</li>
<li>
<p>The difference in performance between <code>git</code> and <code>JGit</code> remains constant across all platforms which is a positive sign for the GitToolChooser as its recommendation would be consistent across multiple devices and operating systems.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="release-plan"><a class="anchor" href="#release-plan"></a>Release Plan ðŸš€</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://issues.jenkins.io/browse/JENKINS-49757">JENKINS-49757</a> - Avoid double fetch from Git checkout step
This issue was fixed in phase one, avoids the second fetch in redundant cases.
It will be shipped with some benchmarks on the change in performance due to the removal of the second fetch.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/jenkinsci/git-client-plugin/pull/574">PR-574</a></p>
</li>
<li>
<p><a href="https://github.com/jenkinsci/git-plugin/pull/904">PR-904</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>GitToolChooser</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/jenkinsci/git-plugin/pull/931">PR-931</a>
This pull request is under review, will be shipped in one of the subsequent Git Plugin releases.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Current Challenges with GitToolChooser</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implement the extension point to support GitHub Branch Source Plugin, Gitlab Branch Source Plugin and Gitea Plugin.</p>
</li>
<li>
<p>The current version of JGit doesn&#8217;t support LFS checkout and sparse checkout, need to make sure that the recommendation doesn&#8217;t break existing use cases.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="future-work"><a class="anchor" href="#future-work"></a>Future Work</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In phase three, we wish to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Release a new version of the Git and Git Client Plugin with the features developed during the project</p>
</li>
<li>
<p>Continue to explore more areas for performance improvement</p>
</li>
<li>
<p>Add a new git operation: git clone (Stretch Goal)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reaching-out"><a class="anchor" href="#reaching-out"></a>Reaching Out</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Feel free to reach out to us for any questions or feedback on the project&#8217;s <a href="https://gitter.im/jenkinsci/git-plugin">Gitter Channel</a> or the <a href="mailto:jenkinsci-dev@googlegroups.com">Jenkins
Developer Mailing list</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="/projects/gsoc/2020/projects/git-plugin-performance/">Project Page</a></p>
</li>
<li>
<p><a href="/blog/2020/07/09/git-performance-improvement-phase1/">Phase 1 Blog Post</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<ul class="app-tags">
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/plugins/">
plugins
</a>
</li>
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/git/">
git
</a>
</li>
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/platform-sig/">
platform-sig
</a>
</li>
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/developer/">
developer
</a>
</li>
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/performance/">
performance
</a>
</li>
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/gsoc/">
gsoc
</a>
</li>
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/gsoc2020/">
gsoc2020
</a>
</li>
</ul>
<h2>
About the author
</h2>
<!-- starting partial author.html.haml -->
<div class="app-author" id="about-the-author">
<!-- starting partial avatar.html.haml -->
<div class="app-avatar" style="min-width: 64px; width: 25vw; max-width: 128px">
<img alt="Rishabh Budhouliya" class="app-avatar__image" src="/jenkins.io/independent-scrolling-patch/images/avatars/rishabhbudhouliya.jpg">
</div>

<!-- ending partial avatar.html.haml -->
<div class="app-author__content">
<p class="app-author__name">
<a href="/blog/authors/rishabhbudhouliya/">
Rishabh Budhouliya
</a>
</p>
<div class="paragraph">
<p>GSoC 2020 student under the Jenkins project (Git Plugin Performance Improvements).
Aspiring to be better at Software Development and participate more in the open source
community.</p>
</div>
<!-- starting partial social-media-buttons.html.haml -->
<ul class="app-social-media-buttons">
<li>
<a href="https://github.com/rishabhBudhouliya" rel="noreferrer noopener" target="_blank">
GitHub
</a>
</li>
</ul>

<!-- ending partial social-media-buttons.html.haml -->
</div>
</div>

<!-- ending partial author.html.haml -->
<!-- starting partial discuss.html.haml -->

<!-- ending partial discuss.html.haml -->
</article>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//blog/2020/07/2020-07-29-git-performance-improvement-phase2.adoc"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
