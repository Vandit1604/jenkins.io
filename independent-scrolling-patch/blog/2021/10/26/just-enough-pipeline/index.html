<!DOCTYPE html>
<html lang="en">
<head>
<title>
Use Just Enough Pipeline
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Use just enough Pipeline to automate build, test, deploy, and administration tasks. Guidance on common Pipeline mistakes that affect controller performance and reliability.
" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/blog/2021/10/26/just-enough-pipeline/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Use Just Enough Pipeline" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Use Just Enough Pipeline" name="twitter:title">
<meta content="Use just enough Pipeline to automate build, test, deploy, and administration tasks. Guidance on common Pipeline mistakes that affect controller performance and reliability.
" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/post-images/2021/2021-10-26-just-enough-pipeline.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Use Just Enough Pipeline" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/blog/2021/10/26/just-enough-pipeline/" property="og:url">
<meta content="Use just enough Pipeline to automate build, test, deploy, and administration tasks. Guidance on common Pipeline mistakes that affect controller performance and reliability.
" name="og:description">
<meta content="Use Just Enough Pipeline" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/post-images/2021/2021-10-26-just-enough-pipeline.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.app-post-page h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<article class="container app-post-page">
<div class="app-!-display-flex">
<a class="app-back-link" href="/jenkins.io/independent-scrolling-patch/node/">
Back to blog
</a>
</div>
<h1>
Use Just Enough Pipeline
</h1>
<div class="post-attrs">
<a class="app-author-link" href="/blog/authors/markewaite/"><div class="app-avatar"><img alt="Mark Waite" class="app-avatar__image" src="/images/avatars/markewaite.jpg"></div> Mark Waite</a><a class="app-author-link" href="/blog/authors/darinpope/"><div class="app-avatar"><img alt="Darin Pope" class="app-avatar__image" src="/images/avatars/darinpope.jpg"></div> Darin Pope</a>
October 26, 2021
<a class="twitter-share-button" data-lang="en" href="https://twitter.com/intent/tweet?text=Use+Just+Enough+Pipeline&amp;url=https%3A%2F%2Fwww.jenkins.io%2Fjenkins.io%2Findependent-scrolling-patch%2Fblog%2F2021%2F10%2F26%2Fjust-enough-pipeline%2F" rel="noreferrer nofollow" target="_blank">
Tweet
</a>
</div>
<div class="blog-content">
<div class="paragraph">
<p><span class="image right center"><img src="/images/post-images/2021/2021-10-26-just-enough-pipeline.png" alt="2021 10 26 just enough pipeline" height="350"></span></p>
</div>
<div class="paragraph">
<p>Jenkins Pipeline (or simply Pipeline with a capital P) is a suite of plugins that supports implementing and integrating continuous delivery pipelines into Jenkins.
This allows you to automate the process of getting software from version control through to your users and customers.</p>
</div>
<div class="paragraph">
<p>Pipeline code works beautifully for its intended role of automating build, test, deploy, and administration tasks.
But, as it is pressed into more complex roles and unexpected uses, some users have run into snags.
Using best practices – and avoiding common mistakes – can help you design a pipeline that is more robust, scalable, and high-performing.</p>
</div>
<div class="paragraph">
<p>We see a lot of users making basic mistakes that can sabotage their pipeline.
(Yes, you can sabotage yourself when you’re creating a pipeline.)
In fact, it’s easy to spot someone who is going down this dangerous path – and it’s usually because they don&#8217;t understand some key technical concepts about Pipeline.
This invariably leads to scalability mistakes that you’ll pay dearly for down the line.</p>
</div>
<div class="sect1">
<h2 id="dont-make-this-mistake"><a class="anchor" href="#dont-make-this-mistake"></a>Don’t make this mistake!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Perhaps the biggest misstep people make is deciding that they need to write their entire pipeline in a programming language.
After all, Pipeline is a domain specific language (DSL).
However, that does not mean that it is a general-purpose programming language.</p>
</div>
<div class="paragraph">
<p>If you treat the DSL as a general-purpose programming language, you are making a serious architectural blunder by doing the wrong work in the wrong place.
Remember that the core of Pipeline code runs on the controller.
So, you should be mindful that everything you express in the Pipeline domain specific language (DSL) will compete with every other Jenkins job running on the controller.</p>
</div>
<div class="paragraph">
<p>For example, it’s easy to include a lot of conditionals, flow control logic, and requests using scripted syntax in the pipeline job.
Experience tells us this is not a good idea and can result in serious damage to pipeline performance.
We’ve actually seen organizations with poorly written Pipeline jobs bring a controller to its knees, while only running a few concurrent builds.</p>
</div>
<div class="paragraph">
<p>Wait a minute, you might ask, “Isn&#8217;t handling code what the controller is there for?”
Yes, the controller certainly is there to execute pipelines.
But, it&#8217;s much better to assign individual steps of the pipeline to command line calls that execute on an agent.
So, instead of running a lot of conditionals inside the pipeline DSL, it’s better to put those conditionals inside a shell script or batch file and call that script from the pipeline.</p>
</div>
<div class="paragraph">
<p>However, this raises another question: “What if I don&#8217;t have any agents connected to my controller?”
If this is the case, then you&#8217;ve just made another bad mistake in scaling Jenkins pipelines.
Why? Because the first rule of building an effective pipeline is to make sure you use agents.
If you&#8217;re using a Jenkins controller and haven’t defined any agents, then your first step should be to define at least one agent and use that agent instead of executing on the controller.</p>
</div>
<div class="paragraph">
<p>For the sake of maintaining scalability in your pipeline, the general rule is to avoid processing any workload on your controller.
If you&#8217;re running Jenkins jobs on the controller, you are sacrificing controller performance.
So, try to avoid using Jenkins controller capacity for things that should be passed off to an agent.
Then, as you grow and develop, all of your work should be running agents.
This is why we always recommend setting the number of executors on the master to zero.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-just-enough-pipeline-to-keep-your-pipeline-scalable"><a class="anchor" href="#use-just-enough-pipeline-to-keep-your-pipeline-scalable"></a>Use Just Enough Pipeline to Keep Your Pipeline Scalable</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All of this serves to highlight our overarching theme of “using just enough pipeline.”
Simply put, you want to use enough code to connect the pipeline steps and integrate tools – but no more than that.
Limit the amount of complex logic embedded in the Pipeline itself (similarly to a shell script), and avoid treating it as a general-purpose programming language.
This makes the pipeline easier to maintain, protects against bugs, and reduces the load on controllers.</p>
</div>
<div class="paragraph">
<p>Another best practice for keeping your pipeline lean, fast, and scalable is to use declarative syntax instead of scripted syntax for your Pipeline.
Declarative naturally leads you away from the kinds of mistakes we’ve just described.
It is a simpler expression of code and an easier way to define your job.
It&#8217;s computed at the startup of the pipeline instead of executing continually during the pipeline.</p>
</div>
<div class="paragraph">
<p>Therefore, when creating a pipeline, start with declarative, and keep it simple for as long as possible.
Anytime a script block shows up inside of a declarative pipeline, you should extract that block and put it in a shared library step.
That keeps the declarative pipeline clean.
By combining declarative with a shared library, that will take care of the vast majority of use cases you’ll encounter.</p>
</div>
<div class="paragraph">
<p>That said, it’s not accurate to say that declarative plus a shared library will solve every problem.
There are cases where scripted is the right solution.
However, declarative is a great starting point until you discover that you absolutely must use scripted.</p>
</div>
<div class="paragraph">
<p>Just remember, at the end of the day, you’ll do well to follow the adage: “Use just enough pipeline and no more.”</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="thanks-to-our-sponsor"><a class="anchor" href="#thanks-to-our-sponsor"></a>Thanks to our Sponsor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mark and Darin both work for <a href="https://www.cloudbees.com">CloudBees</a>.
CloudBees helps Fortune 1000 enterprises manage and scale Jenkins.
Thanks to CloudBees for sponsoring the creation of this blog post.</p>
</div>
<div class="paragraph">
<p>Mark and Darin joined Hope Lynch and Joost van der Griendt to share additional topics in a CloudBees on-demand recording, <a href="https://www.cloudbees.com/events/software-delivery-professional-series/optimizing-jenkins-enterprise">"Optimizing Jenkins for the Enterprise"</a>.
Register for the on-demand recording to receive more information on configuration as code, plugin management, and Pipelines.</p>
</div>
</div>
</div>
</div>
<ul class="app-tags">
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/pipeline/">
pipeline
</a>
</li>
</ul>
<h2>
About the authors
</h2>
<!-- starting partial author.html.haml -->
<div class="app-author" id="about-the-author">
<!-- starting partial avatar.html.haml -->
<div class="app-avatar" style="min-width: 64px; width: 25vw; max-width: 128px">
<img alt="Mark Waite" class="app-avatar__image" src="/jenkins.io/independent-scrolling-patch/images/avatars/markewaite.jpg">
</div>

<!-- ending partial avatar.html.haml -->
<div class="app-author__content">
<p class="app-author__name">
<a href="/blog/authors/markewaite/">
Mark Waite
</a>
</p>
<div class="paragraph">
<p>Mark is the <a href="/project/team-leads/#documentation">Jenkins Documentation Officer</a>, a long-time Jenkins user and contributor, and maintains the <a href="https://plugins.jenkins.io/git">git plugin</a> and the <a href="https://plugins.jenkins.io/git-client">git client plugin</a>.
He is active in <a href="/sigs/">Jenkins special interest groups</a> including the <a href="/sigs/docs/">Docs SIG</a>, <a href="/sigs/platform">Platform SIG</a>, and <a href="/sigs/advocacy-and-outreach">Advocacy SIG</a>.</p>
</div>
<!-- starting partial social-media-buttons.html.haml -->
<ul class="app-social-media-buttons">
<li>
<a href="https://github.com/markewaite" rel="noreferrer noopener" target="_blank">
GitHub
</a>
</li>
<li>
<a href="https://twitter.com/MarkEWaite" rel="noreferrer noopener" target="_blank">
Twitter
</a>
</li>
<li>
<a href="https://www.linkedin.com/in/markwaite" rel="noreferrer noopener" target="_blank">
LinkedIn
</a>
</li>
</ul>

<!-- ending partial social-media-buttons.html.haml -->
</div>
</div>

<!-- ending partial author.html.haml -->
<!-- starting partial author.html.haml -->
<div class="app-author" id="about-the-author">
<!-- starting partial avatar.html.haml -->
<div class="app-avatar" style="min-width: 64px; width: 25vw; max-width: 128px">
<img alt="Darin Pope" class="app-avatar__image" src="/jenkins.io/independent-scrolling-patch/images/avatars/darinpope.jpg">
</div>

<!-- ending partial avatar.html.haml -->
<div class="app-author__content">
<p class="app-author__name">
<a href="/blog/authors/darinpope/">
Darin Pope
</a>
</p>
<div class="paragraph">
<p>Darin is a developer advocate for <a href="https://www.cloudbees.com">CloudBees</a>.
He is the co-host of the weekly <a href="https://www.devopsparadox.com/">DevOps Paradox</a> podcast.
He also hosts regular livestream sessions on continuous integration and continuous delivery.
Recordings of his live stream sessions are available on the <a href="https://www.youtube.com/c/CloudBeesTV/search?query=Darin%20Pope">CloudBees TV YouTube channel</a>.</p>
</div>
<!-- starting partial social-media-buttons.html.haml -->
<ul class="app-social-media-buttons">
<li>
<a href="https://github.com/darinpope" rel="noreferrer noopener" target="_blank">
GitHub
</a>
</li>
<li>
<a href="https://twitter.com/DarinPope" rel="noreferrer noopener" target="_blank">
Twitter
</a>
</li>
<li>
<a href="https://www.linkedin.com/in/darinpope" rel="noreferrer noopener" target="_blank">
LinkedIn
</a>
</li>
</ul>

<!-- ending partial social-media-buttons.html.haml -->
</div>
</div>

<!-- ending partial author.html.haml -->
<!-- starting partial discuss.html.haml -->
<b class="title">
Discuss
</b>
<div id="discourse-comments">
<script>
    window.DiscourseEmbed = {"discourseUrl":"https://community.jenkins.io/"}; window.DiscourseEmbed.discourseEmbedUrl = document.head.querySelector('link[rel="canonical"]').href;
    (function() {
        var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
        d.src = window.DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
    })();
</script>
</div>

<!-- ending partial discuss.html.haml -->
</article>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//blog/2021/10/2021-10-26-just-enough-pipeline.adoc"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
