<!DOCTYPE html>
<html lang="en">
<head>
<title>
GSoC Project Intro: Code Coverage API Plugin
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/blog/2018/06/13/code-coverage-api-plugin/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="GSoC Project Intro: Code Coverage API Plugin" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="GSoC Project Intro: Code Coverage API Plugin" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="GSoC Project Intro: Code Coverage API Plugin" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/blog/2018/06/13/code-coverage-api-plugin/" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="GSoC Project Intro: Code Coverage API Plugin" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.app-post-page h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<article class="container app-post-page">
<div class="app-!-display-flex">
<a class="app-back-link" href="/jenkins.io/independent-scrolling-patch/node/">
Back to blog
</a>
</div>
<h1>
GSoC Project Intro: Code Coverage API Plugin
</h1>
<div class="post-attrs">
<a class="app-author-link" href="/blog/authors/shenyu_zheng/"><div class="app-avatar"></div> Shenyu Zheng</a>
June 13, 2018
<a class="twitter-share-button" data-lang="en" href="https://twitter.com/intent/tweet?text=GSoC+Project+Intro%3A+Code+Coverage+API+Plugin&amp;url=https%3A%2F%2Fwww.jenkins.io%2Fjenkins.io%2Findependent-scrolling-patch%2Fblog%2F2018%2F06%2F13%2Fcode-coverage-api-plugin%2F" rel="noreferrer nofollow" target="_blank">
Tweet
</a>
</div>
<div class="blog-content">
<div class="sect2">
<h3 id="about-me"><a class="anchor" href="#about-me"></a>About me</h3>
<div class="paragraph">
<p>My name is Shenyu Zheng, and I am an undergraduate student in Computer Science and Technology at Henan University from China.</p>
</div>
<div class="paragraph">
<p>I am very excited that I can participate in GSoC to work on Code Coverage API plugin with the Jenkins community and to contribute to the open source world. It is my greatest pleasure to write a plugin that many developers will use.</p>
</div>
<div class="paragraph">
<p>My mentors are <a href="https://github.com/christ66">Steven Christou</a>, <a href="https://github.com/Supun94">Supun Wanniarachchi</a>, <a href="https://github.com/jeffpearce">Jeff Pearce</a> and <a href="https://github.com/oleg-nenashev">Oleg Nenashev</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="abstract"><a class="anchor" href="#abstract"></a>Abstract</h3>
<div class="paragraph">
<p>There are a lot of plugins which currently implement code coverage, however, they all use similar config, charts, and content. So it will be much better if we can have an API plugin which does the most repeated work for those plugins and offers a unified APIs which can be consumed by other plugins and external tools.</p>
</div>
<div class="paragraph">
<p>This API plugin will mainly do these things:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Find coverage reports according to the user’s config.</p>
</li>
<li>
<p>Use adapters to convert reports into the our standard format.</p>
</li>
<li>
<p>Parse standard format reports, and aggregate them.</p>
</li>
<li>
<p>Show parsed result in a chart.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>So, we can implement code coverage publishing by simply writing an adapter, and such adapter only needs to do one thing&#8201;&#8212;&#8201;convert a coverage report into the standard format. The implementation is based on extension points, so new adapters can be created in separate plugins. In order to simplify conversion for XML reports, there is also an abstraction layer which allows creating XSLT-based converters.</p>
</div>
</div>
<div class="sect2">
<h3 id="current-progress-alpha-version"><a class="anchor" href="#current-progress-alpha-version"></a>Current Progress - Alpha Version</h3>
<div class="paragraph">
<p>I have developed an alpha version for this plugin. It currently integrates two different coverage tools - Cobertura and Jacoco. Also, it implements many basic functionalities like threshold, auto-detect, trend chart and so on.</p>
</div>
<div class="sect3">
<h4 id="configuration-page"><a class="anchor" href="#configuration-page"></a>Configuration Page</h4>
<div class="paragraph">
<p><strong>config plugin</strong>
<span class="image center"><img src="/images/post-images/2018-06-13-code-coverage-api-plugin/configuration-page.png" alt="configuration page" title="Code Coverage API Plugin Configuration"></span></p>
</div>
<div class="paragraph">
<p>We can input the path pattern for auto detect, so that plugin will automatically find reports and group them using a corresponding converter. That makes config simpler and the user doesn’t need to fully specify the report name. Also, if we want, we can manually specify each coverage report.</p>
</div>
<div class="paragraph">
<p>We also have global and per-report threshold configurations, which makes the plugin more flexible than existing plugins (e.g. global threshold for a multi-language project that has several reports).</p>
</div>
</div>
<div class="sect3">
<h4 id="pipeline-support"><a class="anchor" href="#pipeline-support"></a>Pipeline Support</h4>
<div class="paragraph">
<p>In addition to configuring the Code Coverage API plugin from the UI page, we also have pipeline support.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="groovy"><span class="n">node</span> <span class="o">{</span>
   <span class="n">publishCoverage</span><span class="o">(</span><span class="nl">autoDetectPath:</span> <span class="s1">'**/*.xml'</span><span class="o">,</span> <span class="nl">adapters:</span> <span class="o">[</span><span class="n">jacoco</span><span class="o">(</span><span class="nl">path:</span> <span class="s1">'jacoco.xml'</span><span class="o">)],</span> <span class="nl">globalThresholds:</span> <span class="o">[[</span><span class="nl">thresholdTarget:</span> <span class="s1">'GROUPS'</span><span class="o">,</span> <span class="nl">unhealthyThreshold:</span> <span class="mf">20.0</span><span class="o">,</span> <span class="nl">unstableThreshold:</span> <span class="mf">0.0</span><span class="o">]])</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="report-defects"><a class="anchor" href="#report-defects"></a>Report Defects</h4>
<div class="paragraph">
<p>As we can see in Configuration page, we can set healthy threshold and stable threshold for each metric. The Code Coverage API plugin will report healthy score according to the healthy threshold we set.</p>
</div>
<div class="paragraph">
<p><strong>threshold config</strong>
<span class="image center"><img src="/images/post-images/2018-06-13-code-coverage-api-plugin/threshold-config.png" alt="threshold config" title="Threshold Config"></span></p>
</div>
<div class="paragraph">
<p><strong>result</strong>
<span class="image center"><img src="/images/post-images/2018-06-13-code-coverage-api-plugin/health-report.png" alt="health report" title="Result"></span></p>
</div>
<div class="paragraph">
<p>Also, we have a group of options which can fail the build if coverage falls below a particular threshold.</p>
</div>
</div>
<div class="sect3">
<h4 id="coverage-result-page"><a class="anchor" href="#coverage-result-page"></a>Coverage Result Page</h4>
<div class="paragraph">
<p>The coverage result page now has a modernized UI which shows coverage results more clearly.
The result page includes three parts - Trend chart, Summary chart, Child Summary chart.</p>
</div>
<div class="sect4">
<h5 id="trend-chart"><a class="anchor" href="#trend-chart"></a>Trend Chart</h5>
<div class="paragraph">
<p>In the Trend chart, we can see the coverage trend of the selected coverage metrics.
<span class="image center"><img src="/images/post-images/2018-06-13-code-coverage-api-plugin/trend-chart.gif" alt="trend chart" title="Trend Chart"></span></p>
</div>
</div>
<div class="sect4">
<h5 id="summary-chart"><a class="anchor" href="#summary-chart"></a>Summary Chart</h5>
<div class="paragraph">
<p>In the summary chart we can see the coverage summary of current coverage metric.
<span class="image center"><img src="/images/post-images/2018-06-13-code-coverage-api-plugin/summary-chart.gif" alt="summary chart" title="Summary Chart"></span></p>
</div>
</div>
<div class="sect4">
<h5 id="child-summary-chart"><a class="anchor" href="#child-summary-chart"></a>Child Summary Chart</h5>
<div class="paragraph">
<p>In the Child summary chart, we can see the coverage summary of each child, also, we can use the range handler to filter item we want to see to reduce the chart size.
<span class="image center"><img src="/images/post-images/2018-06-13-code-coverage-api-plugin/child-summary-chart.gif" alt="child summary chart" title="Child Summary Chart"></span></p>
</div>
<div class="paragraph">
<p>By using those more modernized chart components, we can easily focus on the information we want to know.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extensibility"><a class="anchor" href="#extensibility"></a>Extensibility</h4>
<div class="paragraph">
<p>We provide several extension points to make our plugin more extensible and flexible. Also, we have a series of abstract layers to help us implementing these extension points much easier.</p>
</div>
<div class="sect4">
<h5 id="coveragereportadapter"><a class="anchor" href="#coveragereportadapter"></a>CoverageReportAdapter</h5>
<div class="paragraph">
<p>We can implement a coverage tool by implementing CoverageReportAdapter extension point. For example, by using the provided abstract layer, we can implement Jacoco simple like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="java"><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">JacocoReportAdapter</span> <span class="kd">extends</span> <span class="nc">JavaXMLCoverageReportAdapter</span> <span class="o">{</span>

    <span class="nd">@DataBoundConstructor</span>
    <span class="kd">public</span> <span class="nf">JacocoReportAdapter</span><span class="o">(</span><span class="nc">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getXSL</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"jacoco-to-standard.xsl"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getXSD</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Symbol</span><span class="o">(</span><span class="s">"jacoco"</span><span class="o">)</span>
    <span class="nd">@Extension</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">JacocoReportAdapterDescriptor</span> <span class="kd">extends</span> <span class="nc">CoverageReportAdapterDescriptor</span><span class="o">&lt;</span><span class="nc">CoverageReportAdapter</span><span class="o">&gt;</span> <span class="o">{</span>

        <span class="kd">public</span> <span class="nf">JacocoReportAdapterDescriptor</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="nc">JacocoReportAdapter</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"jacoco"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>All we need is to extend an abstract layer for XML-based Java report and provide an XSL file to convert the report to our Java standard format. There are also other extension points which are under development.</p>
</div>
</div>
<div class="sect4">
<h5 id="other-extension-points"><a class="anchor" href="#other-extension-points"></a>Other Extension points</h5>
<div class="paragraph">
<p>We also plan to provide extension points for coverage threshold and report detector. Once it completed, we can have more control over our coverage report process.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="next-phase-plan"><a class="anchor" href="#next-phase-plan"></a>Next Phase Plan</h3>
<div class="paragraph">
<p>The Alpha version now has many parts which still need to be implemented before the final release. So in next phase, I will mainly do those things.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>APIs which can be used by others</p>
<div class="ulist">
<ul>
<li>
<p>Integrate Cobertura Plugin with Code Coverage API <a href="https://issues.jenkins.io/browse/JENKINS-51424">(JENKINS-51424)</a>.</p>
</li>
<li>
<p>Provide API for getting coverage information. E.g. summary information about coverage (percentages, trends) <a href="https://issues.jenkins.io/browse/JENKINS-51422">(JENKINS-51422)</a>, <a href="https://issues.jenkins.io/browse/JENKINS-51423">(JENKINS-51423)</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Implementing abstract layer for other report formats like JSON. <a href="https://issues.jenkins.io/browse/JENKINS-51732">(JENKINS-51732)</a>.</p>
</li>
<li>
<p>Supporting converters for non-Java languages. <a href="https://issues.jenkins.io/browse/JENKINS-51924">(JENKINS-51924)</a>.</p>
</li>
<li>
<p>Supporting combining reports within a build(e.g. after parallel() execution in Pipeline) <a href="https://issues.jenkins.io/browse/JENKINS-51926">(JENKINS-51926)</a>.</p>
</li>
<li>
<p>Adding source code navigation in Coverage Result Page <a href="https://issues.jenkins.io/browse/JENKINS-51988">(JENKINS-51988)</a>.</p>
</li>
<li>
<p>Refactoring the configuration page to make it more user-friendly <a href="https://issues.jenkins.io/browse/JENKINS-51927">(JENKINS-51927)</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="how-to-try-it-out"><a class="anchor" href="#how-to-try-it-out"></a>How to Try It Out</h3>
<div class="paragraph">
<p>Also, I have released the Alpha version in the <a href="https://jenkins.io/doc/developer/publishing/releasing-experimental-updates/#configuring-jenkins-to-use-experimental-update-center">Experimental Update Center</a>. If you can give me some of your valuable advice about it, I will very appreciate.</p>
</div>
</div>
<div class="sect2">
<h3 id="links"><a class="anchor" href="#links"></a>Links</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://gitter.im/jenkinsci/code-coverage-api-plugin"><span class="image"><img src="https://badges.gitter.im/jenkinsci/code-coverage-api-plugin.svg" alt="title: &quot;Gitter&quot;"></span></a></p>
</li>
<li>
<p><a href="https://issues.jenkins.io/issues/?jql=project+%3D+JENKINS+AND+component+%3D+code-coverage-api-plugin">JIRA Component</a></p>
</li>
<li>
<p><a href="https://jenkins.io/projects/gsoc/2018/code-coverage-api-plugin/">Project Page</a></p>
</li>
<li>
<p><a href="https://github.com/jenkinsci/code-coverage-api-plugin">Project Repository</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=qWHM8S0fzUw">Phase 1 Presentation Video</a></p>
</li>
<li>
<p><a href="https://docs.google.com/presentation/d/141gvnLeNem-2SdiIEM4ZN-nzDmhVJUrUYv-r6a482R8/edit?usp=sharing">Phase 1 Presentation Slides</a></p>
</li>
</ul>
</div>
</div>
</div>
<ul class="app-tags">
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/plugins/">
plugins
</a>
</li>
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/gsoc/">
gsoc
</a>
</li>
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/gsoc2018/">
gsoc2018
</a>
</li>
</ul>
<h2>
About the author
</h2>
<!-- starting partial author.html.haml -->
<div class="app-author" id="about-the-author">
<!-- starting partial avatar.html.haml -->
<div class="app-avatar" style="min-width: 64px; width: 25vw; max-width: 128px"></div>

<!-- ending partial avatar.html.haml -->
<div class="app-author__content">
<p class="app-author__name">
<a href="/blog/authors/shenyu_zheng/">
Shenyu Zheng
</a>
</p>
<div class="paragraph">
<p>Shenyu comes from China. He is a third year student now, and his major is
Computer Science and technology. He has participated in GSoC 2018 for
<a href="/projects/gsoc/2018/code-coverage-api-plugin/">Code Coverage API Plugin</a></p>
</div>
<!-- starting partial social-media-buttons.html.haml -->
<ul class="app-social-media-buttons">
<li>
<a href="https://github.com/cizezsy" rel="noreferrer noopener" target="_blank">
GitHub
</a>
</li>
</ul>

<!-- ending partial social-media-buttons.html.haml -->
</div>
</div>

<!-- ending partial author.html.haml -->
<!-- starting partial discuss.html.haml -->

<!-- ending partial discuss.html.haml -->
</article>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//blog/2018/06/2018-06-13-code-coverage-api-plugin.adoc"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
