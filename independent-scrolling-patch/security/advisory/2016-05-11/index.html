<!DOCTYPE html>
<html lang="en">
<head>
<title>
Jenkins Security Advisory 2016-05-11
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/security/advisory/2016-05-11/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Jenkins Security Advisory 2016-05-11" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Jenkins Security Advisory 2016-05-11" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Jenkins Security Advisory 2016-05-11" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/security/advisory/2016-05-11/" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Jenkins Security Advisory 2016-05-11" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<style>
  .toc {
      float: right;
  }
</style>
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row.body h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<div class="container">
<div class="row body">
<div class="col-md-12">
<h1>
Jenkins Security Advisory 2016-05-11
</h1>
<div class="paragraph">
<p><strong>Revised 2016-05-12</strong>: Added note on plugins impacted by SECURITY-170, mentioned system property disabling part of the SECURITY-243 fix.</p>
</div>
<hr>
<div class="paragraph">
<p>This advisory announces multiple vulnerabilities in Jenkins.</p>
</div>
<div class="sect1">
<h2 id="description"><a class="anchor" href="#description"></a>Description</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="arbitrary-build-parameters-are-passed-to-build-scripts-as-environment-variables"><a class="anchor" href="#arbitrary-build-parameters-are-passed-to-build-scripts-as-environment-variables"></a>Arbitrary build parameters are passed to build scripts as environment variables</h3>
<div class="paragraph">
<p><strong>SECURITY-170 / CVE-2016-3721</strong></p>
</div>
<div class="paragraph">
<p>Build parameters in Jenkins typically are passed to build scripts as environment variables. Some plugins allow passing arbitrary (undeclared) parameters. Depending on access permissions and installed plugins, malicious users were able to trigger builds, passing arbitrary environment variables (e.g. PATH) to modify the behavior of those builds. Rather than expect all plugin authors to be aware of this potential problem, Jenkins now filters the build parameters based on what is defined on the job.</p>
</div>
<div class="paragraph">
<p>As this change is known to affect a number of plugins, it&#8217;s possible to restore the previous behavior by setting the system property <code>hudson.model.ParametersAction.keepUndefinedParameters</code> to <code>true</code>. <strong>This is potentially very unsafe</strong> and intended as a short-term workaround only.</p>
</div>
<div class="paragraph">
<p>To allow specific, known safe parameter names to be passed to builds, set the system property <code>hudson.model.ParametersAction.safeParameters</code> to a comma-separated list of safe parameter names. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">java -Dhudson.model.ParametersAction.safeParameters=FOO,BAR_BAZ,qux -jar jenkins.war</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For an overview of impacted plugins and the current status of their fixes, see: <a href="https://wiki.jenkins.io/display/JENKINS/Plugins+affected+by+fix+for+SECURITY-170">Plugins affected by fix for SECURITY-170</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="malicious-users-with-multiple-user-accounts-can-prevent-other-users-from-logging-in"><a class="anchor" href="#malicious-users-with-multiple-user-accounts-can-prevent-other-users-from-logging-in"></a>Malicious users with multiple user accounts can prevent other users from logging in</h3>
<div class="paragraph">
<p><strong>SECURITY-243 / CVE-2016-3722</strong></p>
</div>
<div class="paragraph">
<p>By changing the freely editable "full name", malicious users with multiple user accounts could prevent other users from logging in, as "full name" was resolved before actual user name to determine which account is currently trying to log in.</p>
</div>
<div class="paragraph">
<p>Part of this fix can be disabled by setting the system property <code>hudson.model.User.SECURITY_243_FULL_DEFENSE</code> to <code>false</code>. This is not generally encouraged, but may be necessary in rare circumstances.</p>
</div>
</div>
<div class="sect2">
<h3 id="information-on-installed-plugins-exposed-via-api"><a class="anchor" href="#information-on-installed-plugins-exposed-via-api"></a>Information on installed plugins exposed via API</h3>
<div class="paragraph">
<p><strong>SECURITY-250 / CVE-2016-3723</strong></p>
</div>
<div class="paragraph">
<p>The XML/JSON API endpoints providing information about installed plugins were missing permissions checks, allowing any user with read access to Jenkins to determine which plugins and versions were installed.</p>
</div>
</div>
<div class="sect2">
<h3 id="encrypted-secrets-e-g-passwords-were-leaked-to-users-with-permission-to-read-configuration"><a class="anchor" href="#encrypted-secrets-e-g-passwords-were-leaked-to-users-with-permission-to-read-configuration"></a>Encrypted secrets (e.g. passwords) were leaked to users with permission to read configuration</h3>
<div class="paragraph">
<p><strong>SECURITY-266 / CVE-2016-3724</strong></p>
</div>
<div class="paragraph">
<p>Users with extended read access could access encrypted secrets stored directly in the configuration of those items.</p>
</div>
<div class="paragraph">
<p>As a side-effect of this change, copying a job that contains secrets in its configuration now requires the Configure permission on that job.</p>
</div>
</div>
<div class="sect2">
<h3 id="regular-users-can-trigger-download-of-update-site-metadata"><a class="anchor" href="#regular-users-can-trigger-download-of-update-site-metadata"></a>Regular users can trigger download of update site metadata</h3>
<div class="paragraph">
<p><strong>SECURITY-273 / CVE-2016-3725</strong></p>
</div>
<div class="paragraph">
<p>A missing permissions check allowed any user with access to Jenkins to trigger an update of update site metadata. This could be combined with DNS cache poisoning to disrupt Jenkins service.</p>
</div>
</div>
<div class="sect2">
<h3 id="open-redirect-to-scheme-relative-urls"><a class="anchor" href="#open-redirect-to-scheme-relative-urls"></a>Open redirect to scheme-relative URLs</h3>
<div class="paragraph">
<p><strong>SECURITY-276 / CVE-2016-3726</strong></p>
</div>
<div class="paragraph">
<p>Some Jenkins URLs did not properly validate the redirect URLs, which allowed malicious users to create URLs that redirect users to arbitrary scheme-relative URLs.</p>
</div>
</div>
<div class="sect2">
<h3 id="granting-the-permission-to-read-node-configurations-allows-access-to-overall-system-configuration"><a class="anchor" href="#granting-the-permission-to-read-node-configurations-allows-access-to-overall-system-configuration"></a>Granting the permission to read node configurations allows access to overall system configuration</h3>
<div class="paragraph">
<p><strong>SECURITY-281 / CVE-2016-3727</strong></p>
</div>
<div class="paragraph">
<p>The API URL <code>/computer/(master)/api/xml</code> allowed users with the 'extended read' permission for the built-in node to see some global Jenkins configuration, including the configuration of the security realm.</p>
</div>
<div class="paragraph">
<p>This URL now unconditionally sends HTTP 400 Bad Request when accessed. There is no workaround.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="severity"><a class="anchor" href="#severity"></a>Severity</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>SECURITY-170 is considered <strong><a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N">medium</a></strong>.</p>
</li>
<li>
<p>SECURITY-243 is considered <strong><a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L">low</a></strong>.</p>
</li>
<li>
<p>SECURITY-250 is considered <strong><a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N">medium</a></strong>.</p>
</li>
<li>
<p>SECURITY-266 is considered <strong><a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N">medium</a></strong>.</p>
</li>
<li>
<p>SECURITY-273 is considered <strong><a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L">low</a></strong>.</p>
</li>
<li>
<p>SECURITY-276 is considered <strong><a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:N">medium</a></strong>.</p>
</li>
<li>
<p>SECURITY-281 is considered <strong><a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N">medium</a></strong>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="affected-versions"><a class="anchor" href="#affected-versions"></a>Affected versions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>All Jenkins main line releases up to and including 2.2</p>
</li>
<li>
<p>All Jenkins LTS releases up to and including 1.651.1</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fix"><a class="anchor" href="#fix"></a>Fix</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Jenkins main line users should update to 2.3</p>
</li>
<li>
<p>Jenkins LTS users should update to 1.651.2</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These versions include fixes to all the vulnerabilities described above. All prior versions are affected by these vulnerabilities.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="credit"><a class="anchor" href="#credit"></a>Credit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Jenkins project would like to thank the following people for discovering and <a href="/security/#reporting-vulnerabilities">reporting</a> these vulnerabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Adam Cazzolla and Ben Bleiberg, Sonatype Inc.</strong> for SECURITY-276</p>
</li>
<li>
<p><strong>Charles Nelson</strong> for SECURITY-250</p>
</li>
<li>
<p><strong>James Nord, CloudBees, Inc.</strong> for SECURITY-273</p>
</li>
<li>
<p><strong>Jesse Glick, CloudBees, Inc.</strong> for SECURITY-281</p>
</li>
<li>
<p><strong>Stephen Connolly, CloudBees, Inc.</strong> for SECURITY-170</p>
</li>
<li>
<p><strong>Steve Marlowe &lt;<a href="mailto:smarlowe@cisco.com">smarlowe@cisco.com</a>&gt; of Cisco ASIG</strong> for SECURITY-243 and SECURITY-266</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="other-resources"><a class="anchor" href="#other-resources"></a>Other Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="/blog/2016/05/11/security-update/">Announcement blog post</a></p>
</li>
<li>
<p><a href="https://www.cloudbees.com/jenkins-security-advisory-2016-05-11">Corresponding security advisory for CloudBees Jenkins Enterprise and CloudBees Jenkins Operations Center</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//security/advisory/2016-05-11.adoc"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
