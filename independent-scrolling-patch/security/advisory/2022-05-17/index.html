<!DOCTYPE html>
<html lang="en">
<head>
<title>
Jenkins Security Advisory 2022-05-17
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/security/advisory/2022-05-17/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Jenkins Security Advisory 2022-05-17" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Jenkins Security Advisory 2022-05-17" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Jenkins Security Advisory 2022-05-17" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/security/advisory/2022-05-17/" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Jenkins Security Advisory 2022-05-17" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row .col-lg-9 h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<div class="container">
<div class="row body">
<div class="col-lg-3">
<div class="sidebar-nav tour">
<p>
<a href="/jenkins.io/independent-scrolling-patch/security/" class="">Jenkins Security Home</a>
</p>
<strong>
For Administrators
</strong>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/security/for-administrators/" class="">Overview</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/security/advisories/" class="">Security Advisories</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/security/scheduling/" class="">Advisory Schedule</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/security/plugins/" class="">Vulnerabilities in Plugins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/security/fixing/" class="">How We Fix Security Issues</a>
</li>
</ul>
<strong>
For Reporters
</strong>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/security/reporting/" class="">Reporting Vulnerabilities</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/security/cna/" class="">Jenkins CNA</a>
</li>
</ul>
<strong>
For Maintainers
</strong>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/security/for-maintainers/" class="">Overview</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/security/plugins/" class="">Vulnerabilities in Plugins</a>
</li>
</ul>
<strong>
Jenkins Security Team
</strong>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/security/team/" class="">About</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/security/improvements/" class="">Contributions</a>
</li>
</ul>
</div>
</div>
<div class="col-lg-9">
<h1>
Jenkins Security Advisory 2022-05-17
</h1>
<p>
This advisory announces vulnerabilities in the following Jenkins deliverables:
</p>
<p>
<ul>
<li>
<a href="https://plugins.jenkins.io/app-detector">
Application Detector
Plugin
</a>
</li>
<li>
Autocomplete Parameter
Plugin
</li>
<li>
<a href="https://plugins.jenkins.io/blueocean">
Blue Ocean
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/git">
Git
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/gitlab-plugin">
GitLab
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/global-variable-string-parameter">
Global Variable String Parameter
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/JDK_Parameter_Plugin">
JDK Parameter
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/mercurial">
Mercurial
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/multiselect-parameter">
Multiselect parameter
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/blueocean-pipeline-scm-api">
Pipeline SCM API for Blue Ocean
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/workflow-cps">
Pipeline: Groovy
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/promoted-builds-simple">
Promoted Builds (Simple)
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/random-string-parameter">
Random String Parameter
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/repo">
REPO
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/rundeck">
Rundeck
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/script-security">
Script Security
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/selection-tasks-plugin">
Selection tasks
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/ssh">
SSH
Plugin
</a>
</li>
<li>
Storable Configs
Plugin
</li>
<li>
<a href="https://plugins.jenkins.io/vboxwrapper">
vboxwrapper
Plugin
</a>
</li>
<li>
<a href="https://plugins.jenkins.io/windows-slaves">
WMI Windows Agents
Plugin
</a>
</li>
</ul>
</p>
<h2>
Descriptions
</h2>
<h3 id="SECURITY-359">
Sandbox bypass vulnerability through implicitly allowlisted platform Groovy files in Pipeline: Groovy Plugin
</h3>
<strong>
SECURITY-359
/
CVE-2022-30945
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H">
High
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/workflow-cps">
<code>workflow-cps</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Pipeline: Groovy Plugin allows pipelines to load Groovy source files.
This is intended to be used to allow Global Shared Libraries to execute without sandbox protection.</p>
</div>
<div class="paragraph">
<p>In Pipeline: Groovy Plugin 2689.v434009a_31b_f1 and earlier, any Groovy source files bundled with Jenkins core and plugins could be loaded this way and their methods executed.
If a suitable Groovy source file is available on the classpath of Jenkins, sandbox protections can be bypassed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Jenkins security team has been unable to identify any Groovy source files in Jenkins core or plugins that would allow attackers to execute dangerous code.
While the severity of this issue is declared as High due to the potential impact, successful exploitation is considered very unlikely.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Pipeline: Groovy Plugin 2692.v76b_089ccd026 restricts which Groovy source files can be loaded in Pipelines.</p>
</div>
<div class="paragraph">
<p>Groovy source files in public plugins intended to be executed in sandboxed pipelines have been identified and added to an allowlist.
The new extension point <code>org.jenkinsci.plugins.workflow.cps.GroovySourceFileAllowlist</code> allows plugins to add specific Groovy source files to that allowlist if necessary, but creation of plugin-specific Pipeline DSLs is strongly discouraged.</p>
</div>
<h3 id="SECURITY-2116">
CSRF vulnerability in Script Security Plugin
</h3>
<strong>
SECURITY-2116
/
CVE-2022-30946
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N">
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/script-security">
<code>script-security</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Script Security Plugin 1158.v7c1b_73a_69a_08 and earlier does not require POST requests for a form validation endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.</p>
</div>
<div class="paragraph">
<p>This vulnerability allows attackers to have Jenkins send an HTTP request to an attacker-specified webserver.</p>
</div>
<div class="paragraph">
<p>This form validation method no longer sends HTTP requests in Script Security Plugin 1172.v35f6a_0b_8207e.</p>
</div>
<h3 id="SECURITY-2478">
Multiple SCM plugins can check out from the controller file system
</h3>
<strong>
SECURITY-2478
/
CVE-2022-30947 (Git), CVE-2022-30948 (Mercurial), CVE-2022-30949 (REPO)
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N">
Low
</a>
<br>
<strong>
Affected plugins:
<nobr>
<a href="https://plugins.jenkins.io/git">
<code>git</code>
</a>
,
</nobr>
<nobr>
<a href="https://plugins.jenkins.io/mercurial">
<code>mercurial</code>
</a>
,
</nobr>
<nobr>
<a href="https://plugins.jenkins.io/repo">
<code>repo</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>SCMs support a number of different URL schemes, including local file system paths (e.g. using <code>file:</code> URLs).</p>
</div>
<div class="paragraph">
<p>Historically in Jenkins, only agents checked out from SCM, and if multiple projects share the same agent, there is no expected isolation between builds besides using different workspaces unless overridden.
Some Pipeline-related features check out SCMs from the Jenkins controller as well.</p>
</div>
<div class="paragraph">
<p>This allows attackers able to configure pipelines to check out some SCM repositories stored on the Jenkins controller&#8217;s file system using local paths as SCM URLs, obtaining limited information about other projects' SCM contents.
The following Jenkins plugins are known to be affected:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://plugins.jenkins.io/git/">Git</a> 4.11.1 and earlier</p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/mercurial/">Mercurial</a> 2.16 and earlier</p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/repo/">REPO</a> 1.14.0 and earlier</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Affected plugins have been updated to reject local file paths being checked out on the controller:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://plugins.jenkins.io/git/">Git</a> 4.11.2</p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/mercurial/">Mercurial</a> 2.16.1</p>
</li>
<li>
<p><a href="https://plugins.jenkins.io/repo/">REPO</a> 1.15.0</p>
</li>
</ul>
</div>
<h3 id="SECURITY-2604">
Multiple vulnerabilities in Windows Remote Command library in WMI Windows Agents Plugin
</h3>
<strong>
SECURITY-2604
/
CVE-2022-30950 (buffer overflow), CVE-2022-30951 (access control)
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N">
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/windows-slaves">
<code>windows-slaves</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>WMI Windows Agents Plugin 1.8 and earlier includes the Windows Remote Command library.
It provides a general-purpose remote command execution capability that Jenkins uses to check if Java is available, and if not, to install it.</p>
</div>
<div class="paragraph">
<p>This library has a buffer overflow vulnerability that may allow users able to connect to a named pipe to execute commands on the Windows agent machine.</p>
</div>
<div class="paragraph">
<p>Additionally, while the processes are started as the user who connects to the named pipe, no access control takes place, potentially allowing users to start processes even if they&#8217;re not allowed to log in.</p>
</div>
<div class="paragraph">
<p>WMI Windows Agents Plugin 1.8.1 no longer includes the Windows Remote Command library.
A Java runtime is expected to be available on agent machines and WMI Windows Agents Plugin 1.8.1 does not install a JDK automatically otherwise.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
WMI Windows Agents Plugin is the only Jenkins project deliverable the Jenkins project security team is aware of that includes the Windows Remote Command library.
</td>
</tr>
</table>
</div>
<h3 id="SECURITY-714">
User-scoped credentials exposed to other users by Pipeline SCM API for Blue Ocean Plugin
</h3>
<strong>
SECURITY-714
/
CVE-2022-30952
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N">
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/blueocean-pipeline-scm-api">
<code>blueocean-pipeline-scm-api</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>When pipelines are created using the pipeline creation wizard in Blue Ocean, the credentials used are stored in the per-user credentials store of the user creating the pipeline.
To allow pipelines to use this credential to scan repositories and checkout from SCM, the Blue Ocean Credentials Provider allows pipelines to access a specific credential from the per-user credentials store in Pipeline SCM API for Blue Ocean Plugin 1.25.3 and earlier.</p>
</div>
<div class="paragraph">
<p>As a result, attackers with Job/Configure permission can rewrite job configurations in a way that lets them access and capture any attacker-specified credential from any user&#8217;s private credentials store.</p>
</div>
<div class="paragraph">
<p>Pipeline SCM API for Blue Ocean Plugin 1.25.4 deprecates the Blue Ocean Credentials Provider and disables it by default.
As a result, all jobs initially set up using the Blue Ocean pipeline creation wizard and configured to use the credential specified at that time will no longer be able to access the credential, resulting in failures to scan repositories, checkout from SCM, etc. unless the repository is public and can be accessed without credentials.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This also applies to newly created pipelines after Pipeline SCM API for Blue Ocean Plugin has been updated to 1.25.4.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Administrators should reconfigure affected pipelines to use a credential from the Jenkins credential store or a folder credential store.
See <a href="https://cloudbees.com/r/blue-ocean-credentials-removal">this help page on cloudbees.com</a> to learn more.</p>
</div>
<div class="paragraph">
<p>To re-enable the Blue Ocean Credentials Provider, set the Java system property <code>io.jenkins.blueocean.rest.impl.pipeline.credential.BlueOceanCredentialsProvider.enabled</code> to <code>true</code>.
Doing so is discouraged, as that will restore the unsafe behavior.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While Credentials Plugin provides the <em>Configure Credential Providers</em> UI to enable or disable certain credentials providers, enabling the Blue Ocean Credentials Provider there is not enough in Pipeline SCM API for Blue Ocean Plugin 1.25.4.
Both the UI and system property need to enable the Blue Ocean Credentials Provider.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Administrators not immediately able to update Blue Ocean are advised to disable the Blue Ocean Credentials Provider through the UI at <em>Manage Jenkins » Configure Credential Providers</em> and to reconfigure affected pipelines to use a credential from the Jenkins credential store or a folder credential store.</p>
</div>
<h3 id="SECURITY-2502">
CSRF vulnerability and missing permission checks in Blue Ocean Plugin
</h3>
<strong>
SECURITY-2502
/
CVE-2022-30953 (CSRF), CVE-2022-30954 (permission check)
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N">
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/blueocean">
<code>blueocean</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Blue Ocean Plugin 1.25.3 and earlier does not perform permission checks in several HTTP endpoints.</p>
</div>
<div class="paragraph">
<p>This allows attackers with Overall/Read permission to send requests to an attacker-specified URL.</p>
</div>
<div class="paragraph">
<p>Additionally, these endpoints do not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.</p>
</div>
<div class="paragraph">
<p>Blue Ocean Plugin 1.25.4 requires POST requests and the appropriate permissions for the affected HTTP endpoints.</p>
</div>
<h3 id="SECURITY-2753">
Missing permission check in GitLab Plugin allows enumerating credentials IDs
</h3>
<strong>
SECURITY-2753
/
CVE-2022-30955
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N">
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/gitlab-plugin">
<code>gitlab-plugin</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>GitLab Plugin 1.5.31 and earlier does not perform a permission check in an HTTP endpoint.</p>
</div>
<div class="paragraph">
<p>This allows attackers with Overall/Read permission to enumerate credentials IDs of credentials stored in Jenkins.
Those can be used as part of an attack to capture the credentials using another vulnerability.</p>
</div>
<div class="paragraph">
<p>An enumeration of credentials IDs in GitLab Plugin 1.5.32 requires the appropriate permissions.</p>
</div>
<h3 id="SECURITY-2600">
Stored XSS vulnerability in Rundeck Plugin
</h3>
<strong>
SECURITY-2600
/
CVE-2022-30956
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H">
High
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/rundeck">
<code>rundeck</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Rundeck Plugin 3.6.10 and earlier does not restrict URL schemes in Rundeck webhook submissions.</p>
</div>
<div class="paragraph">
<p>This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to submit crafted Rundeck webhook payloads.</p>
</div>
<div class="paragraph">
<p>Rundeck Plugin 3.6.11 sanitizes URLs submitted in Rundeck webhook payloads.</p>
</div>
<h3 id="SECURITY-2315">
Missing permission check in SSH Plugin allows enumerating credentials IDs
</h3>
<strong>
SECURITY-2315
/
CVE-2022-30957
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N">
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/ssh">
<code>ssh</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>SSH Plugin 2.6.1 and earlier does not perform a permission check in an HTTP endpoint.</p>
</div>
<div class="paragraph">
<p>This allows attackers with Overall/Read permission to enumerate credentials IDs of credentials stored in Jenkins.
Those can be used as part of an attack to capture the credentials using another vulnerability.</p>
</div>
<div class="paragraph">
<p>As of publication of this advisory, there is no fix. <a href="/security/plugins/#unresolved">Learn why we announce this.</a></p>
</div>
<h3 id="SECURITY-2093">
CSRF vulnerability and missing permission checks in SSH Plugin allow capturing credentials
</h3>
<strong>
SECURITY-2093
/
CVE-2022-30958 (CSRF), CVE-2022-30959 (permission check)
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N">
High
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/ssh">
<code>ssh</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>SSH Plugin 2.6.1 and earlier does not perform a permission check in an HTTP endpoint.</p>
</div>
<div class="paragraph">
<p>This allows attackers with Overall/Read permission to connect to an attacker-specified SSH server using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.</p>
</div>
<div class="paragraph">
<p>Additionally, this endpoint does not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.</p>
</div>
<div class="paragraph">
<p>As of publication of this advisory, there is no fix. <a href="/security/plugins/#unresolved">Learn why we announce this.</a></p>
</div>
<h3 id="SECURITY-2717">
Stored XSS vulnerabilities in multiple plugins providing additional parameter types
</h3>
<strong>
SECURITY-2717
/
CVE-2022-30960 (Application Detector), CVE-2022-30961 (Autocomplete Parameter), CVE-2022-30962 (Global Variable String Parameter), CVE-2022-30963 (JDK Parameter), CVE-2022-30964 (Multiselect parameter), CVE-2022-30965 (Promoted Builds (Simple)), CVE-2022-30966 (Random String Parameter), CVE-2022-30967 (Selection tasks), CVE-2022-30968 (vboxwrapper)
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H">
High
</a>
<br>
<strong>
Affected plugins:
<nobr>
<a href="https://plugins.jenkins.io/multiselect-parameter">
<code>multiselect-parameter</code>
</a>
,
</nobr>
<nobr>
<a href="https://plugins.jenkins.io/app-detector">
<code>app-detector</code>
</a>
,
</nobr>
<nobr>
<a href="https://plugins.jenkins.io/autocomplete-parameter">
<code>autocomplete-parameter</code>
</a>
,
</nobr>
<nobr>
<a href="https://plugins.jenkins.io/JDK_Parameter_Plugin">
<code>JDK_Parameter_Plugin</code>
</a>
,
</nobr>
<nobr>
<a href="https://plugins.jenkins.io/global-variable-string-parameter">
<code>global-variable-string-parameter</code>
</a>
,
</nobr>
<nobr>
<a href="https://plugins.jenkins.io/promoted-builds-simple">
<code>promoted-builds-simple</code>
</a>
,
</nobr>
<nobr>
<a href="https://plugins.jenkins.io/random-string-parameter">
<code>random-string-parameter</code>
</a>
,
</nobr>
<nobr>
<a href="https://plugins.jenkins.io/selection-tasks-plugin">
<code>selection-tasks-plugin</code>
</a>
,
</nobr>
<nobr>
<a href="https://plugins.jenkins.io/vboxwrapper">
<code>vboxwrapper</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Multiple plugins do not escape the name and description of the parameter types they provide:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Application Detector Plugin 1.0.8 and earlier (SECURITY-2732 / CVE-2022-30960)</p>
</li>
<li>
<p>Autocomplete Parameter Plugin 1.1 and earlier (SECURITY-2729 / CVE-2022-30961)</p>
</li>
<li>
<p>Global Variable String Parameter Plugin 1.2 and earlier (SECURITY-2715 / CVE-2022-30962)</p>
</li>
<li>
<p>JDK Parameter Plugin 1.0 and earlier (SECURITY-2713 / CVE-2022-30963)</p>
</li>
<li>
<p>Multiselect parameter Plugin 1.3 and earlier (SECURITY-2726 / CVE-2022-30964)</p>
</li>
<li>
<p>Promoted Builds (Simple) Plugin 1.9 and earlier (SECURITY-2720 / CVE-2022-30965)</p>
</li>
<li>
<p>Random String Parameter Plugin 1.0 and earlier (SECURITY-2722 / CVE-2022-30966)</p>
</li>
<li>
<p>Selection tasks Plugin 1.0 and earlier (SECURITY-2728 / CVE-2022-30967)</p>
</li>
<li>
<p>vboxwrapper Plugin 1.3 and earlier (SECURITY-2734 / CVE-2022-30968)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This results in stored cross-site scripting (XSS) vulnerabilities exploitable by attackers with Item/Configure permission.</p>
</div>
<div class="paragraph">
<p>Exploitation of these vulnerabilities requires that parameters are listed on another page, like the "Build With Parameters" and "Parameters" pages provided by Jenkins (core), and that those pages are not hardened to prevent exploitation.
Jenkins (core) has prevented exploitation of vulnerabilities of this kind on the "Build With Parameters" and "Parameters" pages since 2.44 and LTS 2.32.2 as part of the <a href="https://www.jenkins.io/security/advisory/2017-02-01/#persisted-cross-site-scripting-vulnerability-in-parameter-names-and-descriptions">SECURITY-353 / CVE-2017-2601</a> fix.
Additionally, several plugins have previously been updated to list parameters in a way that prevents exploitation by default, see <a href="/security/advisory/2022-04-12/#SECURITY-2617">SECURITY-2617 in the 2022-04-12 security advisory for a list</a>.</p>
</div>
<div class="paragraph">
<p>The following plugins have been updated to escape the name and description of the parameter types they provide in the versions specified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Application Detector Plugin 1.0.9</p>
</li>
<li>
<p>Multiselect parameter Plugin 1.4</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As of publication of this advisory, there is no fix available for the following plugins:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Autocomplete Parameter Plugin 1.1 and earlier (SECURITY-2729 / CVE-2022-30961)</p>
</li>
<li>
<p>Global Variable String Parameter Plugin 1.2 and earlier (SECURITY-2715 / CVE-2022-30962)</p>
</li>
<li>
<p>JDK Parameter Plugin 1.0 and earlier (SECURITY-2713 / CVE-2022-30963)</p>
</li>
<li>
<p>Promoted Builds (Simple) Plugin 1.9 and earlier (SECURITY-2720 / CVE-2022-30965)</p>
</li>
<li>
<p>Random String Parameter Plugin 1.0 and earlier (SECURITY-2722 / CVE-2022-30966)</p>
</li>
<li>
<p>Selection tasks Plugin 1.0 and earlier (SECURITY-2728 / CVE-2022-30967)</p>
</li>
<li>
<p>vboxwrapper Plugin 1.3 and earlier (SECURITY-2734 / CVE-2022-30968)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="/security/plugins/#unresolved">Learn why we announce this.</a></p>
</div>
<h3 id="SECURITY-2322">
CSRF vulnerability in Autocomplete Parameter Plugin results in RCE
</h3>
<strong>
SECURITY-2322
/
CVE-2022-30969
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H">
High
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/autocomplete-parameter">
<code>autocomplete-parameter</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Autocomplete Parameter Plugin 1.1 and earlier does not require POST requests for a form validation endpoint executing a provided Groovy script, resulting in a cross-site request forgery (CSRF) vulnerability.</p>
</div>
<div class="paragraph">
<p>This vulnerability allows attackers to execute arbitrary code without sandbox protection if the victim is an administrator.</p>
</div>
<div class="paragraph">
<p>As of publication of this advisory, there is no fix. <a href="/security/plugins/#unresolved">Learn why we announce this.</a></p>
</div>
<h3 id="SECURITY-2267">
Stored XSS vulnerability in Autocomplete Parameter Plugin
</h3>
<strong>
SECURITY-2267
/
CVE-2022-30970
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H">
High
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/autocomplete-parameter">
<code>autocomplete-parameter</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Autocomplete Parameter Plugin 1.1 and earlier references Dropdown Autocomplete parameter and Auto Complete String parameter names in an unsafe manner from Javascript embedded in view definitions.</p>
</div>
<div class="paragraph">
<p>This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers with Item/Configure permission.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While this looks similar to SECURITY-2729, this is an independent problem and exploitable even on views rendering parameters that otherwise attempt to prevent XSS vulnerabilities in parameter names.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As of publication of this advisory, there is no fix. <a href="/security/plugins/#unresolved">Learn why we announce this.</a></p>
</div>
<h3 id="SECURITY-1969">
XXE vulnerability in Storable Configs Plugin
</h3>
<strong>
SECURITY-1969
/
CVE-2022-30971 (XXE), CVE-2022-30972 (CSRF)
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N">
High
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href="https://plugins.jenkins.io/storable-configs-plugin">
<code>storable-configs-plugin</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Storable Configs Plugin 1.0 and earlier does not configure its XML parser to prevent XML external entity (XXE) attacks.</p>
</div>
<div class="paragraph">
<p>This allows attackers with Item/Configure permission to have Jenkins parse a crafted file that uses external entities for extraction of secrets from the Jenkins controller or server-side request forgery.</p>
</div>
<div class="paragraph">
<p>Additionally, the HTTP endpoint calling the XML parser does not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.</p>
</div>
<div class="paragraph">
<p>As of publication of this advisory, there is no fix. <a href="/security/plugins/#unresolved">Learn why we announce this.</a></p>
</div>
<h2>
Severity
</h2>
<ul>
<li>
SECURITY-359:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H">
High
</a>
</li>
<li>
SECURITY-714:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N">
Medium
</a>
</li>
<li>
SECURITY-1969:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N">
High
</a>
</li>
<li>
SECURITY-2093:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N">
High
</a>
</li>
<li>
SECURITY-2116:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N">
Medium
</a>
</li>
<li>
SECURITY-2267:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H">
High
</a>
</li>
<li>
SECURITY-2315:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N">
Medium
</a>
</li>
<li>
SECURITY-2322:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H">
High
</a>
</li>
<li>
SECURITY-2478:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N">
Low
</a>
</li>
<li>
SECURITY-2502:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N">
Medium
</a>
</li>
<li>
SECURITY-2600:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H">
High
</a>
</li>
<li>
SECURITY-2604:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N">
Medium
</a>
</li>
<li>
SECURITY-2717:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H">
High
</a>
</li>
<li>
SECURITY-2753:
<a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N">
Medium
</a>
</li>
</ul>
<h2>
Affected Versions
</h2>
<ul>
<li>
<strong>
Application Detector
Plugin
</strong>
up to and including
1.0.8
</li>
<li>
<strong>
Autocomplete Parameter
Plugin
</strong>
up to and including
1.1
</li>
<li>
<strong>
Blue Ocean
Plugin
</strong>
up to and including
1.25.3
</li>
<li>
<strong>
Git
Plugin
</strong>
up to and including
4.11.1
</li>
<li>
<strong>
GitLab
Plugin
</strong>
up to and including
1.5.31
</li>
<li>
<strong>
Global Variable String Parameter
Plugin
</strong>
up to and including
1.2
</li>
<li>
<strong>
JDK Parameter
Plugin
</strong>
up to and including
1.0
</li>
<li>
<strong>
Mercurial
Plugin
</strong>
up to and including
2.16
</li>
<li>
<strong>
Multiselect parameter
Plugin
</strong>
up to and including
1.3
</li>
<li>
<strong>
Pipeline SCM API for Blue Ocean
Plugin
</strong>
up to and including
1.25.3
</li>
<li>
<strong>
Pipeline: Groovy
Plugin
</strong>
up to and including
2689.v434009a_31b_f1
</li>
<li>
<strong>
Promoted Builds (Simple)
Plugin
</strong>
up to and including
1.9
</li>
<li>
<strong>
Random String Parameter
Plugin
</strong>
up to and including
1.0
</li>
<li>
<strong>
REPO
Plugin
</strong>
up to and including
1.14.0
</li>
<li>
<strong>
Rundeck
Plugin
</strong>
up to and including
3.6.10
</li>
<li>
<strong>
Script Security
Plugin
</strong>
up to and including
1158.v7c1b_73a_69a_08
</li>
<li>
<strong>
Selection tasks
Plugin
</strong>
up to and including
1.0
</li>
<li>
<strong>
SSH
Plugin
</strong>
up to and including
2.6.1
</li>
<li>
<strong>
Storable Configs
Plugin
</strong>
up to and including
1.0
</li>
<li>
<strong>
vboxwrapper
Plugin
</strong>
up to and including
1.3
</li>
<li>
<strong>
WMI Windows Agents
Plugin
</strong>
up to and including
1.8
</li>
</ul>
<h2>
Fix
</h2>
<ul>
<li>
<strong>
Application Detector
Plugin
</strong>
should be updated to version
1.0.9
</li>
<li>
<strong>
Blue Ocean
Plugin
</strong>
should be updated to version
1.25.4
</li>
<li>
<strong>
Git
Plugin
</strong>
should be updated to version
4.11.2
</li>
<li>
<strong>
GitLab
Plugin
</strong>
should be updated to version
1.5.32
</li>
<li>
<strong>
Mercurial
Plugin
</strong>
should be updated to version
2.16.1
</li>
<li>
<strong>
Multiselect parameter
Plugin
</strong>
should be updated to version
1.4
</li>
<li>
<strong>
Pipeline SCM API for Blue Ocean
Plugin
</strong>
should be updated to version
1.25.4
</li>
<li>
<strong>
Pipeline: Groovy
Plugin
</strong>
should be updated to version
2692.v76b_089ccd026
</li>
<li>
<strong>
REPO
Plugin
</strong>
should be updated to version
1.14.1
</li>
<li>
<strong>
Rundeck
Plugin
</strong>
should be updated to version
3.6.11
</li>
<li>
<strong>
Script Security
Plugin
</strong>
should be updated to version
1172.v35f6a_0b_8207e
</li>
<li>
<strong>
WMI Windows Agents
Plugin
</strong>
should be updated to version
1.8.1
</li>
</ul>
<p>
These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.
</p>
<p>
As of publication of this advisory, no fixes are available for the following plugins:
</p>
<ul>
<li>
Autocomplete Parameter
Plugin
</li>
<li>
Global Variable String Parameter
Plugin
</li>
<li>
JDK Parameter
Plugin
</li>
<li>
Promoted Builds (Simple)
Plugin
</li>
<li>
Random String Parameter
Plugin
</li>
<li>
Selection tasks
Plugin
</li>
<li>
SSH
Plugin
</li>
<li>
Storable Configs
Plugin
</li>
<li>
vboxwrapper
Plugin
</li>
</ul>
<p>
<a href="/jenkins.io/independent-scrolling-patch/security/plugins/#unresolved">
Learn why we announce these issues.
</a>
</p>
<h2>
Credit
</h2>
<p>
The Jenkins project would like to thank the reporters for discovering and
<a href="/jenkins.io/independent-scrolling-patch/security/#reporting-vulnerabilities">
reporting
</a>
these vulnerabilities:
<ul>
<li>
<strong>
Daniel Beck, CloudBees, Inc.
</strong>
for
SECURITY-1969, SECURITY-2478
</li>
<li>
<strong>
Jesse Glick, CloudBees, Inc.
</strong>
for
SECURITY-359
</li>
<li>
<strong>
Kalle Niemitalo, Procomp Solutions Oy
</strong>
for
SECURITY-2604
</li>
<li>
<strong>
Kevin Guerroudj
</strong>
for
SECURITY-2267
</li>
<li>
<strong>
Kevin Guerroudj, CloudBees, Inc.
</strong>
for
SECURITY-2600, SECURITY-2753
</li>
<li>
<strong>
Kevin Guerroudj, CloudBees, Inc., Wadeck Follonier, CloudBees, Inc., and Daniel Beck, CloudBees, Inc.
</strong>
for
SECURITY-2717
</li>
<li>
<strong>
Kevin Guerroudj, Justin Philip, Marc Heyries, Wadeck Follonier, CloudBees, Inc.
</strong>
for
SECURITY-2322
</li>
<li>
<strong>
Long Nguyen, Viettel Cyber Security
</strong>
for
SECURITY-2093
</li>
<li>
<strong>
Tanner Emek from Tinder Security Labs
</strong>
for
SECURITY-2502
</li>
<li>
<strong>
Wadeck Follonier, CloudBees, Inc.
</strong>
for
SECURITY-2315
</li>
</ul>
</p>

</div>
</div>
</div>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//security/advisory/2022-05-17.adoc"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
