<!DOCTYPE html>
<html lang="en">
<head>
<title>
Git credentials binding for sh, bat, and powershell
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/projects/gsoc/2021/projects/git-credentials-binding/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Git credentials binding for sh, bat, and powershell" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Git credentials binding for sh, bat, and powershell" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Git credentials binding for sh, bat, and powershell" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/projects/gsoc/2021/projects/git-credentials-binding/" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Git credentials binding for sh, bat, and powershell" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row .col-lg-9 h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<div class="container">
<div class="row body">
<div class="col-lg-9">
<h1>
Git credentials binding for sh, bat, and powershell
</h1>
<p>
<b>
Goal:
</b>
Allow greater git flexibility from Jenkins Pipelines
</p>
<p>
<b>
Status:
</b>
Completed
</p>
<h3 class="title">
Team
</h3>
<ul>
<li>
Student:
<a class="app-author-link" href="/blog/authors/arpoch/"><div class="app-avatar"></div> Harshit Chopra</a>
</li>
<li>
Mentor(s):
<a class="app-author-link" href="/blog/authors/markewaite/"><div class="app-avatar"><img alt="Mark Waite" class="app-avatar__image" src="/images/avatars/markewaite.jpg"></div> Mark Waite</a>
, 
<a class="app-author-link" href="/blog/authors/rishabhbudhouliya/"><div class="app-avatar"><img alt="Rishabh Budhouliya" class="app-avatar__image" src="/images/avatars/rishabhbudhouliya.jpg"></div> Rishabh Budhouliya</a>
, 
<a class="app-author-link" href="/blog/authors/justinharringa/"><div class="app-avatar"><img alt="Justin Harringa" class="app-avatar__image" src="/images/avatars/justinharringa.jpeg"></div> Justin Harringa</a>
</li>
</ul>
<h2 class="title">
Details
</h2>
<div class="sect2">
<h3 id="abstract"><a class="anchor" href="#abstract"></a>Abstract</h3>
<div class="paragraph">
<p>Allow Jenkins Pipeline users to run authenticated git commands in sh, bat, and powershell.</p>
</div>
<div class="paragraph">
<p>This project idea proposes to implement two new credential bindings that contribute files and environment variables to sh, bat, and powershell steps so that they can use command line git to perform authenticated operations.
The Jira issue requesting support for authenticated git operations (JENKINS-28335) is one of the top five most highly voted Jenkins enhancement requests.</p>
</div>
<div class="paragraph">
<p>The two credential bindings will be <code>gitSshPrivateKey</code> and <code>gitUsernamePassword</code>.
They will be implemented in the git plugin with automated tests to confirm the bindings are behaving as expected on the wide range of command line git versions and operating systems supported by the git plugin.</p>
</div>
</div>
<div class="sect2">
<h3 id="rationale"><a class="anchor" href="#rationale"></a>Rationale</h3>
<div class="paragraph">
<p>The Jenkins git plugin uses Jenkins credentials to fetch a repository and checkout a branch for freestyle, pipeline, and multibranch pipeline jobs.
It is also able to use Jenkins credentials to push tags and commits back to the repository from a freestyle job.
It supports a wide range of command line git versions, from git 1.8.3 (CentOS 7) through the current release of command line git (2.30.0, Debian testing, Windows, &#8230;&#8203;).
It supports ssh private keys with and without passphrases for ssh protocol authentication and supports usernames and passwords or API tokens for https protocol authentication.</p>
</div>
<div class="paragraph">
<p>The git plugin is not able to push tags or commits from a pipeline job or a multibranch pipeline job.
It is not able to perform other git operations that require authentication like remote branch creation or deletion.
The git plugin also does not provide authenticated access to all the command line options offered with the most recent versions of command line git.
For example, there is no support in the git plugin for the <code>--single-branch</code> option or for the <code>--recurse-submodules</code> option.</p>
</div>
<div class="paragraph">
<p>With the git credentials binding, Pipeline users will be able to push merge results, commits, and tags from a Pipeline job.
They will be able to create and delete remote branches.
They will be able to use the git command line options of their choice, including <code>--single-branch</code> and <code>--recurse-submodules</code>.
Users will be able to run authenticated git commands in their Jenkins Pipelines without modifying the git plugin.</p>
</div>
</div>
<div class="sect2">
<h3 id="implementation"><a class="anchor" href="#implementation"></a>Implementation</h3>
<div class="paragraph">
<p>Both <code>gitUsernamePassword</code> and <code>gitSshPrivateKey</code> bindings depend on the <a href="https://plugins.jenkins.io/credentials/">Credential Plugin</a>
to retrieve user&#8217;s credential using the Credentials API.</p>
</div>
<div class="paragraph">
<p>The <a href="https://plugins.jenkins.io/credentials-binding/">Credentials Binding Plugin</a> is used
to bind Git specific environment variables with script(sh,bat,powershell) / terminal commands depending upon the current CLI-git version installed on
system which is being used to perform git operation that requires authentication.</p>
</div>
<div class="paragraph">
<p>The bindings only provide authentication support for the command line git implementation.
Other Git implementations inside the git client plugin such as <code>JGit</code> and <code>JGit with Apache HTTP Client</code> are not supported.
Users are provided with a dropbox which lists all the Git-Tool implementation of
CLI-Git configured in Jenkins <code>Global System Configuration</code>.</p>
</div>
<div class="paragraph">
<p>Both the bindings works on behalf of the user to provide git authentication support, without complicated steps to pass the credentials to command line git.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">NOTE</dt>
<dd>
<p>If no CLI-Git implemented Git-Tool is available in <code>Global System Configuration</code> then by default JGit
implemented Git-Tool will be used.</p>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="git-username-and-password-binding"><a class="anchor" href="#git-username-and-password-binding"></a>Git Username and Password Binding</h4>
<div class="paragraph">
<p>The <code>gitUsernamePassword</code> implementation uses the Jenkins username and password
values retrieved through Credential API, to access a remote repository  over <strong>HTTP</strong> protocol.
The binding uses the <code>GIT_ASKPASS</code> environment variable to provide credentials requested by a git operation in a pipeline job/freestyle project.
Executable script(sh,bat,powershell) is attached/bound to the <code>GIT_ASKPASS</code> variable, which is invoked when asked for the user’s credentials by HTTP server.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pipeline Job</dt>
<dd>
<p>Using Git Username and Password Binding in a Pipeline Job</p>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/gsoc/2021/git-credentials/usernamepassword-binding-pipeline-job.png" alt="Git Username and Password in Pipeline Job">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">FreeStyle Project</dt>
<dd>
<p>Using Git Username and Password Binding in a FreeStyle-Project</p>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/gsoc/2021/git-credentials/usernamepassword-binding-freestyle-project.png" alt="Git Username and Password in FreeStyle Project">
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Two variable bindings <code>GIT_USERNAME</code> and <code>GIT_PASSWORD</code> provide the username and password respectively.
These variable bindings are also accessible when using <code>JGit/JGit with Apache HTTP Client</code> Git-Tool
implementations in both freestyle project and pipeline job.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="git-ssh-private-key-binding"><a class="anchor" href="#git-ssh-private-key-binding"></a>Git SSH Private Key Binding</h4>
<div class="paragraph">
<p>The <code>gitSshPrivateKey</code> implementation provides git authentication support over <strong>SSH</strong> protocol
using private key and passphrase credentials of a user. The binding uses two git specific environment
variables depending upon the minimum CLI-git version</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>GIT_SSH_COMMAND</code> - If version is greater than or equal to 2.3, then the GIT_SSH_COMMAND environment variable provides the ssh command including
necessary options which are: path to the private key and host key checking, to authenticate and connect to the git server without using an executable script.</p>
</li>
<li>
<p><code>SSH_ASKPASS</code> - If version is less than 2.3, an executable script is attached to the variable which provides the
ssh command including necessary options which are: path to the private key and host key checking, to authenticate and connect to the git server</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Support for private key formats</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The following key formats are supported through Jenkins plugins</p>
<div class="ulist">
<ul>
<li>
<p><code>BouncyCastle API Plugin</code> - Supports decryption of PKCS#8 PEM encoded and PEM private keys.</p>
</li>
<li>
<p><code>SSHD Plugin</code> - Provides a transitive dependency i.e. Apache SSHD-Core v2.7.0, which supports decryption of
OpenSSH/RFC4716 formatted private keys.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Support for encryption algorithms</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The following encryption algorithms are supported in various formats discussed above</p>
<div class="ulist">
<ul>
<li>
<p>RSA</p>
</li>
<li>
<p>DSA</p>
</li>
<li>
<p>ECDSA</p>
</li>
<li>
<p>ED25519</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="decryption-of-private-keys"><a class="anchor" href="#decryption-of-private-keys"></a>Decryption of private keys</h5>
<div class="paragraph">
<p>The passphrase protected private key needs to be decrypted before it can be used to perform the
git authentication operation over <strong>SSH</strong> protocol, if not decrypted then a prompt is displayed to
the user asking for the passphrase of the private key being used in the current job/project, which is not an expected behaviour since
the passphrase is already provided by the user through Jenkins <a href="https://plugins.jenkins.io/credentials/">Credential Plugin</a>.</p>
</div>
<div class="paragraph">
<p>To tackle this issue, the BouncyCastle API plugin and SSHD plugin are used to provide decryption support
for the various private formats mentioned above.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pipeline Job</dt>
<dd>
<p>Using Git SSH Private Key in a Pipeline Job</p>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/gsoc/2021/git-credentials/ssh-private-key-pipeline-job.png" alt="Git SSH Private Key in Pipeline Job">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">FreeStyle Project</dt>
<dd>
<p>Using Git SSH Private Key Binding in a FreeStyle-Project</p>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/gsoc/2021/git-credentials/ssh-private-key-freestyle-job.png" alt="Git SSH Private Key in FreeStyle Project">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">NOTE</dt>
<dd>
<p>Unlike GitUsernamePassword binding, no variable bindings are supported by gitSshPrivateKey binding.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="office-hours"><a class="anchor" href="#office-hours"></a>Office hours</h3>
<div class="paragraph">
<p>The Office hours are scheduled twice a week each Wednesday and Friday at 2:00 UTC, with regular <a href="https://docs.google.com/document/d/1gZneYIDWrT5S-1ACG641wfvxs7vnDC0RCYqy-EuuhwY/edit?usp=sharing">meeting notes</a> available for anyone to read.</p>
</div>
</div>
<div class="sect2">
<h3 id="links"><a class="anchor" href="#links"></a>Links</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://groups.google.com/g/jenkinsci-gsoc-all-public/c/VdUhhM1Noxc/m/Zk4yajsFAwAJ">Jenkins GSoC mailing list discussion of git credentials pipeline task</a></p>
</li>
<li>
<p><a href="https://issues.jenkins.io/browse/JENKINS-28335">JENKINS-28335</a> - Pipeline step to run Git commands with credentials &amp; tool</p>
</li>
<li>
<p><a href="https://issues.jenkins.io/browse/JENKINS-47733">JENKINS-47733</a> - Add a <code>withGit</code> pipeline step that provides git credentials</p>
</li>
<li>
<p><a href="https://issues.jenkins.io/browse/JENKINS-36496">JENKINS-36496</a> - Support git publisher with Pipeline</p>
</li>
</ul>
</div>
</div>
<h3 class="title">
Links
</h3>
<ul>
<!-- starting partial connect-links.html.haml -->
<li>
<a href="https://groups.google.com/g/jenkins-platform-sig" rel="noreferrer noopener" target="_blank">
Mailing List
</a>
</li>
<li>
<a href="https://gitter.im/jenkinsci/git-plugin" rel="noreferrer noopener" target="_blank">
<img src="https://badges.gitter.im/jenkinsci/git-plugin.svg" title="Gitter">
</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/projects/gsoc/2021/projects/git-credentials-binding/#office-hours" rel="noreferrer noopener" target="_blank">
Meetings
</a>
</li>

<!-- ending partial connect-links.html.haml -->
<li>
<a href="/projects/gsoc/2021/project-ideas/git-credentials-binding-for-pipeline" rel="noreferrer noopener" target="_blank">
Original GSoC project idea
</a>
</li>
<li>
<a href="/projects/gsoc" target="_blank">
Jenkins GSoC page
</a>
</li>
</ul>

<!-- starting partial discuss.html.haml -->

<!-- ending partial discuss.html.haml -->
</div>
<div class="col-lg-3">
<div class="sidebar-nav">
<h4>
On this page
</h4>
<ul class="sectlevel2">
<li><a href="#abstract">Abstract</a></li>
<li><a href="#rationale">Rationale</a></li>
<li><a href="#implementation">Implementation</a></li>
<li><a href="#office-hours">Office hours</a></li>
<li><a href="#links">Links</a></li>
</ul>
<!-- starting partial connect-h4-div.html.haml -->
<div>
<h4>
Connect
</h4>
</div>
<ul>
<!-- starting partial connect-links.html.haml -->
<li>
<a href="https://groups.google.com/g/jenkins-platform-sig" rel="noreferrer noopener" target="_blank">
Mailing List
</a>
</li>
<li>
<a href="https://gitter.im/jenkinsci/git-plugin" rel="noreferrer noopener" target="_blank">
<img src="https://badges.gitter.im/jenkinsci/git-plugin.svg" title="Gitter">
</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/projects/gsoc/2021/projects/git-credentials-binding/#office-hours" rel="noreferrer noopener" target="_blank">
Meetings
</a>
</li>

<!-- ending partial connect-links.html.haml -->
</ul>

<!-- ending partial connect-h4-div.html.haml -->
<div>
<div class="block block-block even blog-posts" id="block-block-15">
<h4 class="title">
Recent Blog Posts
</h4>
<ul>
<li>
<a href="/blog/2021/09/24/gsoc-report/">
Congratulations to all Jenkins and CDF Google Summer of Code 2021 participants!
</a>
</li>
<li>
<a href="/blog/2021/08/28/conventional-commits-plugin-project-report/">
Work report for the Conventional Commits Plugin for Jenkins
</a>
</li>
<li>
<a href="/blog/2021/08/19/git-credentials-binding-work-report/">
Git Credentials Binding for sh, bat, powershell
</a>
</li>
<li>
<a href="/blog/2021/08/02/cloudevents-plugin-phase-I/">
CloudEvents Plugin for Jenkins: Interoperability between Jenkins and other CI/CD Tools
</a>
</li>
<li>
<a href="/blog/2021/07/31/remoting-monitoring-phase-1/">
Remoting Monitoring with OpenTelemetry - Coding Phase 1
</a>
</li>
<li>
<a href="/blog/2021/07/30/introducing-conventional-commits-plugin-for-jenkins/">
Introducing the Conventional Commits Plugin for Jenkins
</a>
</li>
<li>
<a href="/blog/2021/07/27/git-credentials-binding-phase-1/">
Git username / password credentials binding
</a>
</li>
<li>
<a href="/blog/2021/07/16/gsoc-midterm-presentation/">
GSoC CDF Meetup: Google Summer of Code Midterm Demos
</a>
</li>
<li>
<a href="/blog/2021/03/17/gsoc2021-announcement/">
Jenkins accepted in Google Summer Of Code 2021!
</a>
</li>
<li>
<a href="/blog/2020/12/16/call-for-mentors/">
Google Summer of Code 2021 call for Project Ideas and Mentors
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//projects/gsoc/2021/projects/git-credentials-binding.adoc"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
