<!DOCTYPE html>
<html lang="en">
<head>
<title>
Upgrading to Jenkins LTS 2.346.x
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/doc/upgrade-guide/2.346/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Upgrading to Jenkins LTS 2.346.x" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Upgrading to Jenkins LTS 2.346.x" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Upgrading to Jenkins LTS 2.346.x" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/doc/upgrade-guide/2.346/" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Upgrading to Jenkins LTS 2.346.x" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row .col-lg-9 h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<div class="container">
<div class="row body flex-lg-nowrap">
<div class="col-lg-3" id="sidebar-menu">
<div class="sidebar-nav tour" id="sidebar-content">
<p>
<a href="/jenkins.io/independent-scrolling-patch/doc/" class="">> User Documentation Home</a>
</p>
<h5>
User Handbook
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/getting-started/" class="">User Handbook Overview</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/installing/" class="">Installing Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/using/" class="">Using Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/pipeline/" class="">Pipeline</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/blueocean/" class="">Blue Ocean</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/" class="">Managing Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/security/" class="">Securing Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/system-administration/" class="">System Administration</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/scaling/" class="">Scaling Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/troubleshooting/" class="">Troubleshooting Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/glossary/" class="">Glossary</a>
</li>
</ul>
<h5>
Tutorials
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/pipeline/tour/getting-started/" class="">Guided Tour</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/tutorials#pipeline" class="">Jenkins Pipeline</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/tutorials#tools" class="">Using Build Tools</a>
</li>
</ul>
<h5>
Resources
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/pipeline/syntax/" class="">Pipeline Syntax reference</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/pipeline/steps/" class="">Pipeline Steps reference</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/upgrade-guide/" class="active">LTS Upgrade guides</a>
</li>
</ul>
</div>
</div>
<div class="col-lg-9">
<h1>
Upgrading to Jenkins LTS 2.346.x
</h1>
<p>
Each section covers the upgrade from the previous LTS release,
the section on 2.346.1 covers the upgrade from  2.332.4.
</p>
<h3 id="upgrading-to-jenkins-lts-2-346-3">
Upgrading to Jenkins 2.346.3
</h3>
<div class="sect3">
<h4 id="openjdk-11-0-1617-0-4-and-the-c2-jit-compiler"><a class="anchor" href="#openjdk-11-0-1617-0-4-and-the-c2-jit-compiler"></a>OpenJDK 11.0.16/17.0.4 and the C2 JIT compiler</h4>
<div class="paragraph">
<p>OpenJDK 11.0.16 and 17.0.4 are susceptible to <a href="https://bugs.openjdk.org/browse/JDK-8292260">JDK-8292260</a>, a regression in the C2 JIT compiler which <a href="https://mail.openjdk.org/pipermail/jdk-updates-dev/2022-August/016460.html">may cause the JVM to crash unpredictably</a>.
The OpenJDK project has released fixes in 11.0.16.1 and 17.0.4.1.
As of August 26, 2022, the official Jenkins Docker images have been updated with OpenJDK 11.0.16.1 and 17.0.4.1 in version 2.346.3-2.</p>
</div>
</div>
<div class="sect3">
<h4 id="openjdk-11-0-1617-0-4-and-the-metaspace"><a class="anchor" href="#openjdk-11-0-1617-0-4-and-the-metaspace"></a>OpenJDK 11.0.16/17.0.4 and the metaspace</h4>
<div class="paragraph">
<p>The version of OpenJDK in the official Docker image has been upgraded from 11.0.15 to 11.0.16 and from 17.0.3 to 17.0.4.
This exposes a metaspace memory leak in Pipeline: Groovy 2692.v76b_089ccd026 and earlier and in Script Security 1172.v35f6a_0b_8207e and earlier.
After upgrading Jenkins to 2.346.3, upgrade Pipeline: Groovy to 2705.v0449852ee36f or later and upgrade Script Security to 1175.v4b_d517d6db_f0 or later.
It is generally recommended to upgrade all plugins after upgrading Jenkins core.</p>
</div>
<div class="paragraph">
<p>For more information about recent JVM metaspace changes,
see <a href="https://www.youtube.com/watch?v=XqaQ-z70sQs">Taming Metaspace: a look at the machinery, and a proposal for a better one | FOSDEM 2020</a> and the following blog posts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://stuefe.de/posts/metaspace/what-is-metaspace/">What is Metaspace?</a></p>
</li>
<li>
<p><a href="https://stuefe.de/posts/metaspace/metaspace-architecture/">Metaspace Architecture</a></p>
</li>
<li>
<p><a href="https://stuefe.de/posts/metaspace/what-is-compressed-class-space/">What is Compressed Class Space?</a></p>
</li>
<li>
<p><a href="https://stuefe.de/posts/metaspace/sizing-metaspace/">Sizing Metaspace</a></p>
</li>
<li>
<p><a href="https://stuefe.de/posts/metaspace/analyze-metaspace-with-jcmd/">Analyze Metaspace with <code>jcmd VM.metaspace</code></a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="openjdk-11-0-16-and-container-awareness-for-cgroups-v2"><a class="anchor" href="#openjdk-11-0-16-and-container-awareness-for-cgroups-v2"></a>OpenJDK 11.0.16 and container awareness for cgroups v2</h4>
<div class="paragraph">
<p>OpenJDK 11.0.16 contains a fix for <a href="https://bugs.openjdk.org/browse/JDK-8230305">JDK-8230305</a>;
i.e., container awareness for <a href="https://www.kernel.org/doc/html/latest/admin-guide/cgroup-v2.html">cgroups v2</a>.</p>
</div>
<div class="paragraph">
<p>Previously, there would be no container detection when running OpenJDK 11.0.15 on cgroups v2,
and the limits from the container host would be used.
As of OpenJDK 11.0.16, OpenJDK detects container limits via cgroups v2.
These limits affect, for example,
the garbage collection (GC) algorithm selected by the JVM,
the default size of the heap,
the sizes of thread pools,
and how default parallelism is determined for <code>ForkJoinPool</code>.</p>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://developers.redhat.com/articles/2022/04/19/java-17-whats-new-openjdks-container-awareness#tuning_defaults_for_containers">Java 17: What’s new in OpenJDK&#8217;s container awareness</a>
and <a href="https://www.youtube.com/watch?v=ZmTUBKvSWzs">OpenJDK 17 | Container Detection Demo</a>.</p>
</div>
</div>
<h3 id="upgrading-to-jenkins-lts-2-346-2">
Upgrading to Jenkins 2.346.2
</h3>
<div class="sect3">
<h4 id="docker-script-install-plugins-sh-removed"><a class="anchor" href="#docker-script-install-plugins-sh-removed"></a>Docker script <code>install-plugins.sh</code> removed</h4>
<div class="paragraph">
<p>The <code>install-plugins.sh</code> script in the Docker image of the controller has been deprecated for over 18 months.
It has been replaced in the Docker image with a script that directs the user to use the plugin installation manager tool.
The plugin installation manager tool is available in the image as <code>jenkins-plugin-cli</code>.</p>
</div>
<div class="paragraph">
<p>The plugin installation manager tool provides more information about the plugins they are downloading, such as available updates and security warnings.
The plugin installation manager tool handles Jenkins version requirements and dependency management better than the <code>install-plugins.sh</code> script did.</p>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/jenkinsci/plugin-installation-manager-tool/#readme">plugin installation manager documentation</a> for more details.</p>
</div>
</div>
<h3 id="upgrading-to-jenkins-lts-2-346-1">
Upgrading to Jenkins 2.346.1
</h3>
<div class="sect3">
<h4 id="png-and-gif-icons-replaced-with-svg-icons"><a class="anchor" href="#png-and-gif-icons-replaced-with-svg-icons"></a>PNG and GIF icons replaced with SVG icons</h4>
<div class="paragraph">
<p>Scalable vector graphics images are used in Jenkins instead of the GIF and PNG images that were used previously.
SVG images provide a better user experience and improve the Jenkins user experience.</p>
</div>
<div class="paragraph">
<p>The GIF and PNG images have been removed from Jenkins core.</p>
</div>
<div class="paragraph">
<p>Ensure all your plugins are the most recent release before updating core, otherwise images may be missing.
Check for new plugin versions immediately after the core update and install available updates.</p>
</div>
</div>
<div class="sect3">
<h4 id="java-native-runtime-library-removed"><a class="anchor" href="#java-native-runtime-library-removed"></a>Java Native Runtime library removed</h4>
<div class="paragraph">
<p>The Java Native Runtime (JNR) library has been removed from Jenkins core.
Users of <a href="https://plugins.jenkins.io/pam-auth/">PAM Authentication</a> must upgrade to at least version 1.7.
Users of <a href="https://plugins.jenkins.io/file-leak-detector/">CloudBees File Leak Detector</a> must upgrade to at least version 1.7.</p>
</div>
<div class="paragraph">
<p>Users of <a href="https://plugins.jenkins.io/maven-repo-cleaner/">Maven Repository Scheduled Cleanup</a> do not have a compatible upgrade.
They should remove the plugin.</p>
</div>
</div>
<div class="sect3">
<h4 id="self-signed-certificate-not-provided-automatically"><a class="anchor" href="#self-signed-certificate-not-provided-automatically"></a>Self-signed certificate not provided automatically</h4>
<div class="paragraph">
<p>In previous versions of Jenkins, a self-signed certificate was used if no HTTPS keystore was specified when processing HTTPS inside the Jenkins java process.
This feature has been removed.</p>
</div>
<div class="paragraph">
<p>If HTTPS or HTTP/2 is being processed directly by the Jenkins java process, an HTTPS keystore must be configured by adding the <code>--httpsKeyStore=path/to/keystore</code> and <code>--httpsKeyStorePassword=keystorePassword</code> arguments.
This change does not affect HTTPS processing that is performed in <a href="/doc/book/system-administration/reverse-proxy-configuration-with-jenkins/">reverse proxies</a> like Nginx and Apache HTTP Server.</p>
</div>
<div class="paragraph">
<p>See <a href="/doc/book/installing/initial-settings/#https-with-an-existing-certificate">HTTPS with an existing certificate</a> and <a href="/doc/book/installing/initial-settings/#https-certificates-with-windows">HTTPS certificates with Windows</a> for more information on creating a key store.</p>
</div>
</div>
<div class="sect3">
<h4 id="reject-connections-from-unsupported-agent-versions"><a class="anchor" href="#reject-connections-from-unsupported-agent-versions"></a>Reject connections from unsupported agent versions</h4>
<div class="paragraph">
<p>Jenkins now rejects connections from agents with unsupported Remoting versions.
When an agent with a Remoting version older than 3.14 connects to the Jenkins controller, the agent connection is rejected.
The agent status page will show the message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>This agent is offline because Jenkins failed to launch the agent process on it.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Agents with unsupported Remoting versions can be allowed to connect to the controller by setting the <code>hudson.slaves.SlaveComputer.allowUnsupportedRemotingVersions</code> system property to true.</p>
</div>
<div class="paragraph">
<p>Administrators that want more information about agent versions can install the <a href="https://plugins.jenkins.io/versioncolumn/">Version Node Monitors</a> plugin.
It displays the remoting version of the connected agent in the "Nodes" page and can be configured to require matching Remoting versions, matching Java versions, and more.</p>
</div>
</div>
<div class="sect3">
<h4 id="gnu-c-library-removed-from-alpine-docker-images"><a class="anchor" href="#gnu-c-library-removed-from-alpine-docker-images"></a>GNU C Library removed from Alpine Docker images</h4>
<div class="paragraph">
<p>Alpine Linux is not a GNU/Linux distribution; unlike GNU/Linux distributions, Alpine uses <a href="https://musl.libc.org/">musl</a> and <a href="https://busybox.net/">BusyBox</a> instead of the more commonly used <a href="https://www.gnu.org/software/libc/">GNU C Library</a> and <a href="https://www.gnu.org/software/coreutils/">GNU Core Utilities</a>.
Previous versions of Java required the GNU C Library; therefore, the Jenkins project previously delivered Alpine images with the GNU C Library.
Recent versions of Eclipse Temurin for Alpine do not require the GNU C Library; therefore, the Jenkins project has removed the now-unused GNU C Library from its Alpine images.</p>
</div>
<div class="paragraph">
<p>Users who run jobs on the controller, which is <a href="/doc/book/security/controller-isolation/">not recommended</a>, may experience issues if they were running binaries linked against the GNU C Library.
In particular, the use of a Global Tool Configuration (e.g., Node.js or Java) downloading binaries linked against the GNU C Library will result in errors like the following on the controller:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>env: 'node': No such file or directory</code></pre>
</div>
</div>
<div class="paragraph">
<p>The recommended solutions are, in order of preference:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Do not run jobs on the controller&#8217;s built-in node (recommended); instead, run them on an agent.</p>
</li>
<li>
<p>If you must run jobs on the controller and want to use generic third-party binaries that require the GNU C Library, use the Debian or Debian Slim Docker images rather than the Alpine image.</p>
</li>
<li>
<p>If you must run jobs on the controller and want to keep using the Alpine Docker image, build a custom Docker image that extends from the official Alpine Docker image, then either (a) install the packages you want from Alpine&#8217;s repositories with <code>apk(1)</code> or (b) install the GNU C Library and use Global Tool Configuration to download and run binaries linked against the GNU C Library.</p>
</li>
</ul>
</div>
</div>

</div>
</div>
</div>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//doc/upgrade-guide.html.haml"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
