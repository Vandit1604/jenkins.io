<!DOCTYPE html>
<html lang="en">
<head>
<title>
Effectively using Kubernetes plugin with Jenkins
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/blog/2018/08/30/speaker-blog-kubernetes-plugin/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Effectively using Kubernetes plugin with Jenkins" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Effectively using Kubernetes plugin with Jenkins" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Effectively using Kubernetes plugin with Jenkins" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/blog/2018/08/30/speaker-blog-kubernetes-plugin/" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Effectively using Kubernetes plugin with Jenkins" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.app-post-page h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<article class="container app-post-page">
<div class="app-!-display-flex">
<a class="app-back-link" href="/jenkins.io/independent-scrolling-patch/node/">
Back to blog
</a>
</div>
<h1>
Effectively using Kubernetes plugin with Jenkins
</h1>
<div class="post-attrs">
<a class="app-author-link" href="/blog/authors/tanskann/"><div class="app-avatar"></div> Niklas Tanskanen</a>
August 30, 2018
<a class="twitter-share-button" data-lang="en" href="https://twitter.com/intent/tweet?text=Effectively+using+Kubernetes+plugin+with+Jenkins&amp;url=https%3A%2F%2Fwww.jenkins.io%2Fjenkins.io%2Findependent-scrolling-patch%2Fblog%2F2018%2F08%2F30%2Fspeaker-blog-kubernetes-plugin%2F" rel="noreferrer nofollow" target="_blank">
Tweet
</a>
</div>
<div class="blog-content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is a guest blog by Niklas Tanskanen, consultant at
<a href="https://eficode.com">Eficode</a>.
</td>
</tr>
</table>
</div>
<div class="imageblock right">
<div class="content">
<img src="/images/jenkins-x/logo.svg" alt="Jenkins X" width="200">
</div>
</div>
<div class="paragraph">
<p><a href="https://kubernetes.io">Kubernetes</a>, the container orchestration platform is rapidly becoming popular. There are more and more workloads that you can run on top of Kubernetes. It&#8217;s becoming an enabling layer of your Hyper-convergenced infrastructure.</p>
</div>
<div class="paragraph">
<p>If you set up Kubernetes as a Cloud provider in Jenkins, you&#8217;ll get a very powerful couple for running your workloads.
To do that, you can simply install
<a href="https://plugins.jenkins.io/kubernetes">Kubernetes plugin</a>.
Kubernetes is able to run your Jenkins workloads as long as they are run in container.
And containers are an awesome way if your workload is a build, because you can pack all your application and OS dependencies in a container and then run it anywhere!</p>
</div>
<div class="paragraph">
<p>Let&#8217;s imagine that you have been running a Kubernetes cluster setup in your organisation for a while now.
First it was all about proof of concept but now its becoming more popular within your developers and you have to think about scaling and orchestration.
Resource quotas are a part of that and every responsible operator should set those up both in both development and production clusters.
Otherwise people will be lazy and just reserve all the resources of your cluster without actually using those resources for anything.
By introducing quotas into your cluster, you can control how many resources should each namespace have.</p>
</div>
<div class="paragraph">
<p>Quotas are a mature feature of Kubernetes already.
You have the possibility to create very fine grained quotas for different hardware resources, whenever it&#8217;s fast disk, GPUs or CPU time.
You can also specify multiple scopes of quota per one namespace.
For example, you can have a quota for workloads that are to be run to the infinity like web servers or databases.
Or have quota for workloads that are short lived like builds or test automation runs.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Scopes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Scope</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Terminating</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Match pods where <code>.spec.activeDeadlineSeconds &gt;= 0</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NotTerminating</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Match pods where <code>.spec.activeDeadlineSeconds is nil</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BestEffort</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Match pods that have best effort quality of service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NotBestEffort</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Match pods that do not have best effort quality of service.</p></td>
</tr>
</tbody>
</table>
<div class="sect1">
<h2 id="different-scopes-of-kubernetes-quota"><a class="anchor" href="#different-scopes-of-kubernetes-quota"></a>Different scopes of Kubernetes quota</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since Jenkins is all about running short workloads, you should aim for the <code>Terminating</code> scope of quota.
But how do you specify workloads in Jenkins so that correct scope is used?</p>
</div>
<div class="paragraph">
<p>If you were to do this in Kubernetes, you have to specify <code>.spec.activeDeadlineSeconds</code>.
The same field can also be specified by the Kubernetes plugin when you are specifying a Pod Template.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/post-images/2018-08-30/time-deadline.png" alt="time deadline" width="800">
</div>
<div class="title">Figure 1. Specifying <code>.spec.activeDeadlineSeconds</code> in the Kubernetes plugin</div>
</div>
<div class="paragraph">
<p>Same configuration is available in the <code>Jenkinsfile</code> as well if you don&#8217;t like static configurations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="groovy"><span class="n">podTemplate</span><span class="o">(</span><span class="nl">label:</span> <span class="s1">'maven'</span><span class="o">,</span> <span class="nl">activeDeadlineSeconds:</span> <span class="mi">180</span><span class="o">,</span> <span class="nl">containers:</span> <span class="o">[</span>
    <span class="n">containerTemplate</span><span class="o">(</span><span class="nl">name:</span> <span class="s1">'maven'</span><span class="o">,</span> <span class="nl">image:</span> <span class="s1">'maven:3.5.4-jdk-10-slim'</span><span class="o">)</span>
  <span class="o">])</span> <span class="o">{</span>
  <span class="c1">// maven magic</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="imageblock right">
<div class="content">
<a class="image" href="https://www.cloudbees.com/devops-world"><img src="/images/conferences/devops-world-2018.jpg" alt="DevOps World | Jenkins World 2018"></a>
</div>
</div>
<div class="paragraph">
<p>This was just a small sample of features of the Kubernetes plugin in Jenkins. For more, be sure to check out our
<a href="https://sched.co/FD6E">talk</a> where we share more of how you can utilise Kubernetes with Jenkins!</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Come see Niklas Tanskanen and many other Jenkins experts and contributors at
<a href="https://www.cloudbees.com/devops-world">Jenkins World</a> on September 16-19th,
register with the code <code>JWFOSS</code> for a 30% discount off your pass.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<ul class="app-tags">
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/kubernetes/">
kubernetes
</a>
</li>
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/jenkinsworld/">
jenkinsworld
</a>
</li>
<li>
<a class="app-tags__tag" href="/jenkins.io/independent-scrolling-patch/node/tags/jenkinsworld2018/">
jenkinsworld2018
</a>
</li>
</ul>
<h2>
About the author
</h2>
<!-- starting partial author.html.haml -->
<div class="app-author" id="about-the-author">
<!-- starting partial avatar.html.haml -->
<div class="app-avatar" style="min-width: 64px; width: 25vw; max-width: 128px"></div>

<!-- ending partial avatar.html.haml -->
<div class="app-author__content">
<p class="app-author__name">
<a href="/blog/authors/tanskann/">
Niklas Tanskanen
</a>
</p>
This author has no biography defined.
See social media links referenced below.
<!-- starting partial social-media-buttons.html.haml -->
<ul class="app-social-media-buttons">
<li>
<a href="https://github.com/tanskann" rel="noreferrer noopener" target="_blank">
GitHub
</a>
</li>
</ul>

<!-- ending partial social-media-buttons.html.haml -->
</div>
</div>

<!-- ending partial author.html.haml -->
<!-- starting partial discuss.html.haml -->

<!-- ending partial discuss.html.haml -->
</article>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//blog/2018/08/2018-08-30-speaker-blog-kubernetes-plugin.adoc"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
