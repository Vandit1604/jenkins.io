<!DOCTYPE html>
<html lang="en">
<head>
<title>
Upgrading to Jenkins LTS 2.204.x
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/doc/upgrade-guide/2.204/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Upgrading to Jenkins LTS 2.204.x" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Upgrading to Jenkins LTS 2.204.x" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Upgrading to Jenkins LTS 2.204.x" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/doc/upgrade-guide/2.204/" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Upgrading to Jenkins LTS 2.204.x" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row .col-lg-9 h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<div class="container">
<div class="row body flex-lg-nowrap">
<div class="col-lg-3" id="sidebar-menu">
<div class="sidebar-nav tour" id="sidebar-content">
<p>
<a href="/jenkins.io/independent-scrolling-patch/doc/" class="">> User Documentation Home</a>
</p>
<h5>
User Handbook
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/getting-started/" class="">User Handbook Overview</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/installing/" class="">Installing Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/using/" class="">Using Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/pipeline/" class="">Pipeline</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/blueocean/" class="">Blue Ocean</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/" class="">Managing Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/security/" class="">Securing Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/system-administration/" class="">System Administration</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/scaling/" class="">Scaling Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/troubleshooting/" class="">Troubleshooting Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/glossary/" class="">Glossary</a>
</li>
</ul>
<h5>
Tutorials
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/pipeline/tour/getting-started/" class="">Guided Tour</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/tutorials#pipeline" class="">Jenkins Pipeline</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/tutorials#tools" class="">Using Build Tools</a>
</li>
</ul>
<h5>
Resources
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/pipeline/syntax/" class="">Pipeline Syntax reference</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/pipeline/steps/" class="">Pipeline Steps reference</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/upgrade-guide/" class="active">LTS Upgrade guides</a>
</li>
</ul>
</div>
</div>
<div class="col-lg-9">
<h1>
Upgrading to Jenkins LTS 2.204.x
</h1>
<p>
Each section covers the upgrade from the previous LTS release,
the section on 2.204.1 covers the upgrade from  2.190.3.
</p>
<h3 id="upgrading-to-jenkins-lts-2-204-6">
Upgrading to Jenkins 2.204.6
</h3>
<div class="sect3">
<h4 id="changes-to-csrf-protection"><a class="anchor" href="#changes-to-csrf-protection"></a>Changes to CSRF protection</h4>
<div class="paragraph">
<p><a href="/security/advisory/2020-03-25/#SECURITY-1774">SECURITY-1774</a></p>
</div>
<div class="paragraph">
<p>Changes in Jenkins 2.228, 2.204.6, and 2.222.1 affect CSRF protection in multiple ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Responses to <code>POST</code> requests that do not set a CSRF crumb/token may in very rare cases change in unexpected ways due to the fix for SECURITY-1774.
In case of problems with such requests, administrators can disable this security fix by setting the system property <code>hudson.security.csrf.CrumbFilter.UNPROCESSED_PATHINFO</code> to <code>true</code>.</p>
</li>
<li>
<p>As an additional safeguard, semicolon (<code>;</code>) characters in the path part of a URL are now banned by default.
Administrators can disable this protection by setting the system property <code>jenkins.security.SuspiciousRequestFilter.allowSemicolonsInPath</code> to <code>true</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These features overlap, so both may need to be disabled in case of problems. Doing so is strongly discouraged, as that re-opens the SECURITY-1774 general CSRF vulnerability.</p>
</div>
<div class="paragraph">
<p>We expect neither of these changes to result in problems. If they do, please <a href="https://wiki.jenkins.io/display/JENKINS/How+to+report+an+issue">file a bug</a> and use the labels <code>security-1774</code> and <code>regression</code>.</p>
</div>
</div>
<h3 id="upgrading-to-jenkins-lts-2-204-5">
Upgrading to Jenkins 2.204.5
</h3>
<div class="sect3">
<h4 id="custom-system-logging-formats-ignored"><a class="anchor" href="#custom-system-logging-formats-ignored"></a>Custom System Logging Formats Ignored</h4>
<div class="paragraph">
<p>Custom system logging formats are ignored in Jenkins 2.204.5 as a result of <a href="https://issues.jenkins.io/browse/JENKINS-57888">JENKINS-57888</a>.
Fixes for the high default maximum form size limit and reverse proxy redirection are included in Jenkins 2.204.5, and they required downgrade of the Jetty dependency.</p>
</div>
<div class="paragraph">
<p>There is no workaround available for this issue in the 2.204.5 release.
We plan to fix it in the next LTS release (2.222.1).</p>
</div>
</div>
<h3 id="upgrading-to-jenkins-lts-2-204-4">
Upgrading to Jenkins 2.204.4
</h3>
<div class="paragraph">
<p>No notable changes requiring upgrade notes.</p>
</div>
<h3 id="upgrading-to-jenkins-lts-2-204-3">
Upgrading to Jenkins 2.204.3
</h3>
<div class="paragraph">
<p>No notable changes requiring upgrade notes.</p>
</div>
<h3 id="upgrading-to-jenkins-lts-2-204-2">
Upgrading to Jenkins 2.204.2
</h3>
<div class="sect3">
<h4 id="removal-of-inbound-tcp-agent-protocol3"><a class="anchor" href="#removal-of-inbound-tcp-agent-protocol3"></a>Removal of Inbound TCP Agent Protocol/3</h4>
<div class="paragraph">
<p><a href="http://jenkins.io/security/advisory/2020-01-29/#SECURITY-1682">SECURITY-1682</a></p>
</div>
<div class="paragraph">
<p>It is no longer possible to enable Inbound TCP Agent Protocol/3 through the UI.
Instances upgrading from previous releases of Jenkins, which had this protocol enabled, will have it disabled.</p>
</div>
<div class="paragraph">
<p>The system property <code>jenkins.slaves.JnlpSlaveAgentProtocol3.ALLOW_UNSAFE</code> can be set to <code>true</code> to allow enabling this protocol again if necessary.
We strongly discourage doing this.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This only applies to Jenkins 2.204.2 and subsequent releases in that LTS line; the protocol has been removed entirely from Jenkins 2.214 and newer.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="disabled-network-auto-discovery-services"><a class="anchor" href="#disabled-network-auto-discovery-services"></a>Disabled network auto-discovery services</h4>
<div class="paragraph">
<p><a href="http://jenkins.io/security/advisory/2020-01-29/#SECURITY-1641">SECURITY-1641</a></p>
</div>
<div class="paragraph">
<p>Jenkins no longer enables DNS multicast and UDP multicast/broadcast by default.</p>
</div>
<div class="paragraph">
<p>To re-enable these services, set the system property <code>hudson.DNSMultiCast.disabled</code> to <code>false</code> (for DNS multicast) or the system property <code>hudson.udp</code> to <code>33848</code>, or another port (for UDP broadcast/multicast).
These are the same system properties that controlled whether these features were enabled in the past, so any instances explicitly enabling these features by setting these system properties will continue to have them enabled.</p>
</div>
</div>
<div class="sect3">
<h4 id="stapler-security-hardening"><a class="anchor" href="#stapler-security-hardening"></a>Stapler security hardening</h4>
<div class="paragraph">
<p>Access to URLs processed by the <code>Computer</code> and <code>Plugin</code> types (or subtypes) now requires users to have Overall/Read permission.</p>
</div>
<div class="paragraph">
<p>These new restrictions can be disabled by setting the system properties <code>hudson.Plugin.skipPermissionCheck</code> or <code>hudson.model.Computer.skipPermissionCheck</code> to <code>true</code> if this change causes problems.</p>
</div>
</div>
<h3 id="upgrading-to-jenkins-lts-2-204-1">
Upgrading to Jenkins 2.204.1
</h3>
<div class="sect3">
<h4 id="global-configuration-save-and-configuration-as-code-plugin"><a class="anchor" href="#global-configuration-save-and-configuration-as-code-plugin"></a>Global configuration save and configuration as code plugin</h4>
<div class="paragraph">
<p>Jenkins 2.199 introduced a
<a href="https://github.com/jenkinsci/jenkins/pull/4171">check to prevent saving global configuration before loading the configuration has occurred</a>.
Configuration As Code needs to apply global configuration before Jenkins loads jobs (so they can load and correctly reference any global state) and as such until JENKINS-51856 is implemented there exists a race condition where by Jenkins may fail to start when used with this plugin.</p>
</div>
<div class="paragraph">
<p>If you encounter the race condition Jenkins will fail to start with an exception message similar to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="bash">SEVERE	jenkins.InitReactorRunner<span class="nv">$1</span><span class="c">#onTaskFailed: Failed ConfigurationAsCode.init</span>
java.lang.IllegalStateException: An attempt to save the global configuration
  was made before it was loaded</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you encounter this, you can tell the plugin to delay configuration for an amount of time to give Jenkins time to load the global configuration before the configuration is applied by the plugin.</p>
</div>
<div class="paragraph">
<p>To enable this set the <code>io.jenkins.plugins.casc.ConfigurationAsCode.initialDelay</code> system property to a number of milliseconds to delay the initialisation.
The required value will be dependant on aspects of your system (cpu/disk) and configuration, and how it can be found is mostly a trial and error.
A suggestion would be to start with 5000 (5 Seconds) and then increment by 2000 (2 seconds) until you no longer exhibit the issue and finally add 1000 (1 second) for some extra safety.
For example, to delay the configuration by 9 seconds you would use something like the following command <code>java -Dio.jenkins.plugins.casc.ConfigurationAsCode.initialDelay=9000 -jar jenkins.war</code>.
Exactly how and where you specify this option depends on the installation method used to install Jenkins.</p>
</div>
</div>
<div class="sect3">
<h4 id="remove-browser-based-metadata-download-settings"><a class="anchor" href="#remove-browser-based-metadata-download-settings"></a>Remove browser-based metadata download settings</h4>
<div class="paragraph">
<p>The ability to download update center metadata using the user&#8217;s browser was removed from Jenkins.
Jenkins will no longer inform administrators about available updates without an internet connection.
We recommend the use of a local mirror of our update sites or a self-hosted update center like <a href="https://github.com/jenkinsci/juseppe">Juseppe</a> in such situations.</p>
</div>
<div class="paragraph">
<p>An administrative monitor has warned users that browser-based metadata download is deprecated.
This release removes the capability and the administrative monitor.</p>
</div>
<div class="paragraph">
<p>Users maintaining Jenkins with the <a href="https://plugins.jenkins.io/configuration-as-code">configuration as code plugin</a> will need to remove the <code>downloadSettings</code> entry from the configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">security</span><span class="pi">:</span>
  <span class="na">downloadSettings</span><span class="pi">:</span>
    <span class="na">useBrowser</span><span class="pi">:</span> <span class="no">false</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If that section is not removed, Jenkins will fail to start.
When it fails to start, the message in the logfile will look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="bash">SEVERE jenkins.InitReactorRunner<span class="nv">$1</span><span class="c">#onTaskFailed: Failed ConfigurationAsCode.init</span>
io.jenkins.plugins.casc.ConfiguratorException: Invalid configuration elements
  <span class="k">for </span><span class="nb">type </span>class jenkins.model.GlobalConfigurationCategory<span class="nv">$Security</span> : downloadSettings.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Jenkins web page may also display a message like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="bash">java.lang.IllegalStateException: Expected 1 instance of jenkins.security.ResourceDomainConfiguration
  but got 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Remove the <code>downloadSettings</code> and <code>useBrowser</code> lines from the configuration as code file to resolve those errors.</p>
</div>
</div>
<div class="sect3">
<h4 id="resource-domain-support"><a class="anchor" href="#resource-domain-support"></a>Resource domain support</h4>
<div class="paragraph">
<p><a href="https://issues.jenkins.io/browse/JENKINS-41891">JENKINS-41891</a></p>
</div>
<div class="paragraph">
<p>Static resources (HTML pages, workspace files, images, etc.) served from Jenkins are protected by default using a <a href="https://en.wikipedia.org/wiki/Content_Security_Policy">content security policy</a>.
Many Jenkins plugins need to serve static resources but have not been updated to support content security policy.
Previously, administrators were required to define custom content security policies in order to display those pages correctly.</p>
</div>
<div class="paragraph">
<p>Administrators may now choose to define a <strong>Resource Root URL</strong> that Jenkins will use to serve static pages without adding content security policy headers.</p>
</div>
</div>
<div class="sect3">
<h4 id="stop-bundling-maven-plugin-and-subversion-plugin-with-jenkins"><a class="anchor" href="#stop-bundling-maven-plugin-and-subversion-plugin-with-jenkins"></a>Stop bundling Maven plugin and Subversion plugin with Jenkins</h4>
<div class="paragraph">
<p>Certain key Jenkins capabilities were initially created inside the Jenkins core.
As Jenkins has developed further, capabilities moved from inside Jenkins core to dedicated Jenkins plugins, like the maven and subversion plugins.
When those plugins were created, the plugins were "bundled" inside the jenkins.war file to retain compatibility for plugins that depended on their functionality to be inside Jenkins core.
The Jenkins project is no longer publishing any plugins that require the "bundled" versions of the maven and subversion plugins.
The Maven and Subversion plugins are no longer bundled with Jenkins.</p>
</div>
<div class="paragraph">
<p>In very rare cases, this could result in problems when attempting to install plugins compatible with Jenkins before 1.310.
In those cases, the best path forward is usually to modify the plugin that has the problem so that it requires a newer version of Jenkins core.</p>
</div>
</div>

</div>
</div>
</div>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//doc/upgrade-guide.html.haml"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
