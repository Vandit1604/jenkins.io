<!DOCTYPE html>
<html lang="en">
<head>
<title>
Architecting for Scale
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/doc/book/scaling/architecting-for-scale/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Architecting for Scale" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Architecting for Scale" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Architecting for Scale" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/doc/book/scaling/architecting-for-scale/" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Architecting for Scale" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row .col-lg-9 h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<div class="container">
<div class="row body flex-lg-nowrap">
<div class="col-lg-3" id="sidebar-menu">
<div class="sidebar-nav tour" id="sidebar-content">
<p>
<a href="/jenkins.io/independent-scrolling-patch/doc/" class="">> User Documentation Home</a>
</p>
<h5>
User Handbook
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/getting-started/" class="">User Handbook Overview</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/installing/" class="">Installing Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/using/" class="">Using Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/pipeline/" class="">Pipeline</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/blueocean/" class="">Blue Ocean</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/" class="">Managing Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/security/" class="">Securing Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/system-administration/" class="">System Administration</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/scaling/" class="active">Scaling Jenkins</a>
<small>
<ul style="padding-left: 1rem;">
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/scaling/architecting-for-scale/" class="active">Architecting for Scale</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/scaling/hardware-recommendations/" class="">Hardware Recommendations</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/scaling/architecting-for-manageability/" class="">Architecting for Manageability</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/scaling/scaling-jenkins-on-kubernetes/" class="">Scaling Jenkins on Kubernetes</a>
</li>
</ul>
</small>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/troubleshooting/" class="">Troubleshooting Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/glossary/" class="">Glossary</a>
</li>
</ul>
<h5>
Tutorials
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/pipeline/tour/getting-started/" class="">Guided Tour</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/tutorials#pipeline" class="">Jenkins Pipeline</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/tutorials#tools" class="">Using Build Tools</a>
</li>
</ul>
<h5>
Resources
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/pipeline/syntax/" class="">Pipeline Syntax reference</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/pipeline/steps/" class="">Pipeline Steps reference</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/upgrade-guide/" class="">LTS Upgrade guides</a>
</li>
</ul>
</div>
</div>
<div class="col-lg-9">
<div>
<div class="row">
<div class="col-md-4">
</div>
<div class="col-md-4">
<a class="up doc-page-link" href="../">
⇑ Scaling Jenkins
</a>
<a class="index doc-page-link" href="../../">
Index
</a>
</div>
<div class="col-md-4">
<a class="next doc-page-link" href="../hardware-recommendations">
Hardware Recommendations ⇒
</a>
</div>
</div>
</div>
<div>
<div class="row body">
<div class="section">
<h1>
Architecting for Scale
</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#distributed-builds-architecture">Distributed Builds Architecture</a>
<ul class="sectlevel2">
<li><a href="#agent-communications">Agent communications</a></li>
</ul>
</li>
<li><a href="#creating-fungible-agents">Creating fungible agents</a>
<ul class="sectlevel2">
<li><a href="#configuring-tools-location-on-agents">Configuring tools location on agents</a></li>
<li><a href="#define-a-policy-to-share-agent-machines">Define a policy to share agent machines</a></li>
<li><a href="#setting-up-cloud-agents">Setting up cloud agents</a></li>
</ul>
</li>
<li><a href="#right-sizing-jenkins-masters">Right-sizing Jenkins controllers</a>
<ul class="sectlevel2">
<li><a href="#master-division-strategies">Controller division strategies</a></li>
<li><a href="#Calculating-how-many-jobs">Calculating how many jobs, controllers, and executors are needed</a></li>
<li><a href="#scalable-storage-for-master">Scalable storage for controllers</a></li>
</ul>
</li>
<li><a href="#setting-up-a-backup-policy">Setting up a backup policy</a>
<ul class="sectlevel2">
<li><a href="#finding-your-jenkins_home">Finding your $JENKINS_HOME</a></li>
<li><a href="#anatomy-of-a-jenkins_home">Anatomy of a $JENKINS_HOME</a></li>
<li><a href="#choosing-a-backup-strategy">Choosing a backup strategy</a></li>
<li><a href="#define-a-jenkins-instance-to-rollback-to">Define a Jenkins instance to rollback to</a></li>
</ul>
</li>
<li><a href="#resilient-jenkins-architecture">Resilient Jenkins Architecture</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As an organization matures from a continuous delivery standpoint, its Jenkins
requirements will similarly grow. This growth is often reflected in the Jenkins
architecture, whether that be "vertical" or "horizontal" growth.</p>
</div>
<div class="paragraph">
<p><strong>Vertical growth</strong> is when the load on a Jenkins controller load is increased by having more
configured jobs or orchestrating more frequent builds. This may also mean that
more teams are depending on that one controller.</p>
</div>
<div class="paragraph">
<p><strong>Horizontal</strong> growth is the creation of additional Jenkins controllers
to accommodate new teams or projects, rather than adding new teams or projects
to an existing controller.</p>
</div>
<div class="paragraph">
<p>There are potential pitfalls associated with each approach to scaling Jenkins,
but with careful planning, many of them can be avoided or managed. Here are
some things to consider when choosing a strategy for scaling your
organization&#8217;s Jenkins instances:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Do you have the resources to run a distributed build system?</strong> If possible,
it is recommended set up dedicated build nodes that run separately from the
Jenkins controller. This frees up resources for the controller to improve its
scheduling performance and prevents builds from being able to modify any
potentially sensitive data in the <em>$JENKINS_HOME</em>. This also allows
for a single controller to scale far more vertically than if that controller were
both the job builder and scheduler.</p>
</li>
<li>
<p><strong>Do you have the resources to maintain multiple controllers?</strong> Jenkins controllers
require regular plugin updates, semi-monthly core upgrades, and regular
backups of configurations and build histories. Security settings and roles
will have to be manually configured for each controller. Downed controllers will
require manual restart of the Jenkins controller and any jobs that were killed by
the outage.</p>
</li>
<li>
<p><strong>How mission critical are each team&#8217;s projects?</strong> Consider segregating the
most vital projects to separate controllers to minimize the impact of a single
downed controller. Also consider converting any mission-critical project
pipelines to Pipeline jobs, which continue executing even when the
agent connection to the controller is lost.</p>
</li>
<li>
<p><strong>How important is a fast start-up time for your Jenkins instance?</strong> The more
jobs a controller has configured, the longer it takes to load Jenkins after an
upgrade or a crash. The use of folders and views to organize jobs can limit
the number of that need to be rendered on start up.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="distributed-builds-architecture"><a class="anchor" href="#distributed-builds-architecture"></a>Distributed Builds Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A Jenkins controller can operate by itself both managing the build environment and
executing the builds with its own executors and resources. If you stick with
this "standalone" configuration you will most likely run out of resources when
the number or the load of your projects increase.</p>
</div>
<div class="paragraph">
<p>To come back up and running with your Jenkins infrastructure you will need to
enhance the controller (increasing memory, number of CPUs, etc). The time it takes
to maintain and upgrade the machine, the controller together with all the build
environment will be down, the jobs will be stopped and the whole Jenkins
infrastructure will be unusable.</p>
</div>
<div class="paragraph">
<p>Scaling Jenkins in such a scenario would be extremely painful and would
introduce many "idle" periods where all the resources assigned to your build
environment are useless.</p>
</div>
<div class="paragraph">
<p>Moreover, executing jobs on the controller introduces a "security"
issue: the "jenkins" user that Jenkins uses to run the jobs would have full
permissions on all Jenkins resources on the controller. This means that, with a
simple script, a malicious user can have direct access to private information
whose integrity and privacy could not be, thus,  guaranteed.
See
<a href="/doc/book/security/controller-isolation/">Distributed Builds</a>
in the
<a href="/doc/book/security/">Securing Jenkins</a>
chapter for more information.</p>
</div>
<div class="paragraph">
<p>For all these reasons Jenkins supports agents, where the
workload of building projects are delegated to multiple agents.</p>
</div>
<div class="paragraph">
<p>An agent is a machine set up to offload projects from the controller. The method
with which builds are scheduled depends on the configuration given to each
project. For example, some projects may be configured to "restrict where this
project is run" which ties the project to a specific agent or set of labeled
agents. Other projects which omit this configuration will select an agent from
the available pool in Jenkins.
Learn more about Agents in <a href="/doc/book/managing/nodes/#creating-agents/">Managing Nodes</a></p>
</div>
<div class="paragraph">
<p>In a distributed builds environment, the Jenkins controller will use its resources
to only handle HTTP requests and manage the build environment. Actual execution
of builds will be delegated to the agents. With this configuration it is
possible to horizontally scale an architecture, which allows a single Jenkins
installation to host a large number of projects and build environments.</p>
</div>
<div class="sect2">
<h3 id="agent-communications"><a class="anchor" href="#agent-communications"></a>Agent communications</h3>
<div class="paragraph">
<p>In order for a machine to be recognized as an agent, it needs to run a specific
agent program to establish bi-directional communication with the controller.</p>
</div>
<div class="paragraph">
<p>There are different ways to establish a connection between controller and agent:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>The SSH connector</strong>: Configuring an agent to use the SSH connector is the
preferred and the most stable way to establish controller-agent communication.
Jenkins has a built-in SSH client implementation. This means that the
Jenkins controller can easily communicate with any machine with an SSH server
installed. The only requirement is that the public key of the controller is
part of the set of the authorized keys on the agent. Once the host and SSH key
is defined for a new agent, Jenkins will establish a connection to
the machine and bootstrap the agent process.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>The inbound connector</strong>: In this case the communication is established
starting the agent through a connection initiated by an agent program. With this connector
the agent is launched in the machine in 2 different ways:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Manually: by navigating to the Jenkins controller URL in a browser on the agent.
Once the Java Web Start icon is clicked, the agent will be launched on the
machine. The downside of this approach is that the agents cannot be centrally
managed by the Jenkins controller and each/stop/start/update of the agent needs to
be executed manually on the agent&#8217;s machine in versions of Jenkins older than
1.611. This approach is convenient when the controller cannot instantiate the
connection with the client, for example: with agents running inside a
firewalled network connecting to a controller located outside the firewall.</p>
</li>
<li>
<p>As a service: First you&#8217;ll need to manually launch the agent using the above
method. After manually launching it, <em>jenkins-slave.exe</em> and
<em>jenkins-slave.xml</em> will be created in the agent&#8217;s work directory. Now go to
the command line to execute the following command:</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>sc.exe create "&lt;serviceKey&gt;" start= auto binPath= "&lt;path to jenkins-slave.exe&gt;" DisplayName= "&lt;service display name&gt;"</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>&lt;serviceKey&gt;</em> is the name of the registry key to define this agent service and
&lt;service display name&gt; is the label that will identify the service in the
Service Manager interface.</p>
</div>
<div class="paragraph">
<p>To ensure that restarts are automated, you will need to download a recent agent jar and copy it to a permanent location on the machine.
The_.jar_ file can be found at:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>http://&lt;your-jenkins-host&gt;/jnlpJars/agent.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>If running a version of Jenkins newer than 1.559, the <em>.jar</em> will be kept
up to date each time it connects to the controller.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>The Inbound-HTTP connector</strong>: This approach is quite similar to the Inbound-TCP
Java Web Start approach, with the difference in this case being that the
agent is executed as headless and the connection can be tunneled via HTTP(s).
The exact command can be found on your Inbound agent&#8217;s configuration page:</p>
</li>
</ul>
</div>
<div id="inbound_agent" class="imageblock">
<div class="content">
<img src="/doc/book/resources/hardware-recommendations/inbound-agent.png" alt="Inbound agent node screen">
</div>
<div class="title">Figure 1. Inbound agent launch command</div>
</div>
<div class="paragraph">
<p>This approach is convenient for an execution as a daemon on Unix.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Custom-script</strong>: It is also possible to create a custom script to initialize
the communication between controller and agent if the other solutions do not
provide enough flexibility for a specific use-case. The only requirement is
that the script runs the java program as a <em>java -jar agent.jar</em> on the
agent.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Windows agent set-up can either follow the standard SSH and JNLP approach  or
use a more Windows-specific configuration approach. Windows agents have the
following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SSH-connector approach with Putty</strong></p>
</li>
<li>
<p><strong>SSH-connector approach with Cygwin and OpenSSH</strong>:
<a href="https://wiki.jenkins.io/display/JENKINS/SSH+slaves+and+Cygwin">This</a> is the
easiest to setup and recommended approach.</p>
</li>
<li>
<p><strong>SSH-connector approach with Microsoft OpenSSH</strong>:
The <a href="https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse">Microsoft OpenSSH server</a> works well for Microsoft operating systems that support the server.
Refer to installation instructions in the <a href="https://github.com/jenkinsci/ssh-slaves-plugin/blob/master/doc/CONFIGURE.md#launch-windows-agents-using-microsoft-openssh">ssh build agents configuration guide</a>.</p>
</li>
<li>
<p><strong>Remote management facilities (WMI + DCOM)</strong>: With this approach, which
utilizes the
<a href="https://plugins.jenkins.io/windows-slaves">WMI Windows Agents Plugin</a>), the Jenkins controller will register the agent on the
windows agent machine creating a Windows service. The Jenkins controller can
control the agents, issuing stops/restarts/updates of the same. However this
is difficult to configure and not recommended.</p>
</li>
<li>
<p><strong>JNLP-connector approach</strong>: With
<a href="https://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+as+a+Windows+service">this approach</a>
 it is possible to manually register the agent as Windows service,
but it will not be possible to centrally manage it from the controller. Each
stop/start/update of the agent needs to be executed manually on the
agent machine, unless running Jenkins 1.611 or newer.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-fungible-agents"><a class="anchor" href="#creating-fungible-agents"></a>Creating fungible agents</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="configuring-tools-location-on-agents"><a class="anchor" href="#configuring-tools-location-on-agents"></a>Configuring tools location on agents</h3>
<div class="paragraph">
<p>The Jenkins Global configuration page lets you specify the tools needed during
the builds (i.e. Ant, Maven, Java, etc).</p>
</div>
<div class="paragraph">
<p>When defining a tool, it is possible to create a pointer to an existing
installation by giving the directory where the program is expected to be on the
agent. Another option is to let Jenkins take care of the installation of a
specific version in the given location. It is also possible to specify more
than one installation for the same tool since different jobs may need different
versions of the same tool.</p>
</div>
<div class="paragraph">
<p>The pre-compiled "Default" option calls whatever is already installed on the
agent and exists in the machine PATH, but this will return a failure if the
tool was not already installed and its location was not added to the PATH
system variable.</p>
</div>
<div class="paragraph">
<p>One best practice to avoid this failure is to configure a job with the
assumption that the target agent does not have the necessary tools installed,
and to include the tools' installation as part of the build process.</p>
</div>
</div>
<div class="sect2">
<h3 id="define-a-policy-to-share-agent-machines"><a class="anchor" href="#define-a-policy-to-share-agent-machines"></a>Define a policy to share agent machines</h3>
<div class="paragraph">
<p>As mentioned previously, agents should be interchangeable and standardized in
order to make them sharable and to optimize resource usage.  Agents should not
be customized for a particular set of jobs, nor for a particular team.</p>
</div>
<div class="paragraph">
<p>Lately Jenkins has become more and more popular not only in CI but also in CD,
which means that it must orchestrate jobs and pipelines which involve different
teams and technical profiles: developers, QA people and Dev-Ops people.</p>
</div>
<div class="paragraph">
<p>In such a scenario, it might make sense to create customized and dedicated
agents: different tools are usually required by different teams (i.e.
Puppet/Chef for the Ops team) and teams' credentials are usually stored on the
agent in order to ensure their protection and privacy.</p>
</div>
<div class="paragraph">
<p>In order to ensure the execution of a job on a single/group of agents only
(i.e. iOS builds on OSX agents only), it is possible to tie the job to the
agent by specifying the agent&#8217;s label in the job configuration page. Note that
the restriction has to be replicated in every single job to be tied and that
the agent won&#8217;t be protected from being used by other teams.</p>
</div>
</div>
<div class="sect2">
<h3 id="setting-up-cloud-agents"><a class="anchor" href="#setting-up-cloud-agents"></a>Setting up cloud agents</h3>
<div class="paragraph">
<p>Cloud build resources can be a solution for a case when it is necessary to
maintain a reasonably small cluster of agents on-premises while still providing
new build resources when needed.</p>
</div>
<div class="paragraph">
<p>In particular it is possible to offload the execution of the jobs to agents in
the cloud thanks to ad-hoc plugins which will handle the creation of the cloud
resources together with their destruction when they are not needed anymore:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://plugins.jenkins.io/ec2">EC2 Plugin</a>
let Jenkins use AWS EC2 instances as cloud build resources when it runs out
of on-premises agents. The EC2 agents will be dynamically created inside an
AWS network and de-provisioned when they are not needed.</p>
</li>
<li>
<p>The <a href="https://plugins.jenkins.io/azure-vm-agents">Azure VM Agents Plugin</a>
dynamically spins up Jenkins agents as Azure VMs per user provided
configuration via templates, including support for virtual network integration
and subnet placement. Idle agents can be configured for automatic shutdown
to reduce costs.</p>
</li>
<li>
<p>The <a href="https://plugins.jenkins.io/jclouds-jenkins">JCloud plugin</a>
creates the possibility of executing the jobs on any cloud provider supported
by JCloud libraries</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="right-sizing-jenkins-masters"><a class="anchor" href="#right-sizing-jenkins-masters"></a>Right-sizing Jenkins controllers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Comprehensive hardware recommendations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hardware: see the <a href="/doc/book/hardware-recommendations/#hardware-recommendations">Hardware Recommendations</a> page</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="master-division-strategies"><a class="anchor" href="#master-division-strategies"></a>Controller division strategies</h3>
<div class="paragraph">
<p>Designing the best Jenkins architecture for your organization is dependent on
how you stratify the development of your projects and can be constrained by
limitations of the existing Jenkins plugins.</p>
</div>
<div class="paragraph">
<p>The 3 most common forms of stratifying development by controllers is:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>By environment (QA, DEV, etc)</strong> - With this strategy, Jenkins controllers are populated by jobs based on what environment they are deploying to.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Pros</strong></p>
<div class="ulist">
<ul>
<li>
<p>Can tailor plugins on controllers to be specific to that environment&#8217;s needs</p>
</li>
<li>
<p>Can easily restrict access to an environment to only users who will be using that environment</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Cons</strong></p>
<div class="ulist">
<ul>
<li>
<p>Reduces ability to create pipelines</p>
</li>
<li>
<p>No way to visualize the complete flow across controllers</p>
</li>
<li>
<p>Outage of a controller will block flow of all products</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>By org chart</strong> - This strategy is when controllers are assigned to divisions within an organization.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Pros</strong></p>
<div class="ulist">
<ul>
<li>
<p>Can tailor plugins on controllers to be specific to that team&#8217;s needs</p>
</li>
<li>
<p>Can easily restrict access to a division&#8217;s projects to only users who are within that division</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Cons</strong></p>
<div class="ulist">
<ul>
<li>
<p>Reduces ability to create cross-division pipelines</p>
</li>
<li>
<p>No way to visualize the complete flow across controllers</p>
</li>
<li>
<p>Outage of a controller will block flow of all products</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Group controllers by product lines</strong> - When a group of products, with on only critical product in each group, gets its own Jenkins controllers.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Pros</strong></p>
<div class="ulist">
<ul>
<li>
<p>Entire flows can be visualized because all steps are on one controller</p>
</li>
<li>
<p>Reduces the impact of one controller&#8217;s downtime on only affects a small subset of products</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Cons</strong></p>
<div class="ulist">
<ul>
<li>
<p>A strategy for restricting permissions must be devised to keep all users from having access to all items on a controller.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>When evaluating these strategies, it is important to weigh them against the
vertical and horizontal scaling pitfalls discussed in the introduction.</p>
</div>
<div class="paragraph">
<p>Another note is that a smaller number of jobs translates to faster recovery
from failures and more importantly a higher mean time between failures.</p>
</div>
</div>
<div class="sect2">
<h3 id="Calculating-how-many-jobs"><a class="anchor" href="#Calculating-how-many-jobs"></a>Calculating how many jobs, controllers, and executors are needed</h3>
<div class="paragraph">
<p>Having the best possible estimate of necessary configurations for a Jenkins
installation allows an organization to get started on the right foot with
Jenkins and reduces the number of configuration iterations needed to achieve an
optimal installation. The challenge for Jenkins architects is that true limit
of vertical scaling on a Jenkins controller is constrained by whatever hardware is
in place for the controller, as well as harder to quantify pieces like the types of
builds and tests that will be run on the build nodes.</p>
</div>
<div class="paragraph">
<p>There is a way to estimate roughly how many controllers, jobs and executors will be
needed based on build needs and number of developers served. These equations
assume that the Jenkins controller will have 5 cores with one core per 100 jobs
(500 total jobs/controller) and that teams will be divided into groups of 40.</p>
</div>
<div class="paragraph">
<p>If you have information on the actual number of available cores on your planned
controller, you can make adjustments to the
"number of controllers" equations accordingly.</p>
</div>
<div class="paragraph">
<p>The equation for <strong>estimating the number of controllers and executors needed</strong> when
the number of configured jobs is known is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>controllers = number of jobs/500
executors = number of jobs * 0.03</code></pre>
</div>
</div>
<div class="paragraph">
<p>The equation for <strong>estimating the maximum number of jobs, controllers, and executors
needed</strong> for an organization based on the number of developers is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>number of jobs = number of developers * 3.333
number of controllers = number of jobs/500
number of executors = number of jobs * 0.03</code></pre>
</div>
</div>
<div class="paragraph">
<p>These numbers will provide a good starting point for a Jenkins installation,
but adjustments to actual installation size may be needed based on the types of
builds and tests that an installation runs.</p>
</div>
</div>
<div class="sect2">
<h3 id="scalable-storage-for-master"><a class="anchor" href="#scalable-storage-for-master"></a>Scalable storage for controllers</h3>
<div class="paragraph">
<p>It is also recommended to choose a controller with consideration for future growth
in the number of plugins or jobs stored in your controller&#8217;s <em>$JENKINS_HOME</em>.
Storage is cheap and Jenkins does not require fast disk access to run well, so
it is more advantageous to invest in a larger machine for your controller over a
faster one.</p>
</div>
<div class="paragraph">
<p>Different operating systems for the Jenkins controller will also allow for
different approaches to expandable storage:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Spanned Volumes on Windows</strong> - On NTFS devices like Windows, you can create a
spanned volume that allows you to add new volumes to an existing one, but
have them behave as a single volume. To do this, you will have to ensure that
Jenkins is installed on a separate partition so that it can be converted to a
spanned volume later.</p>
</li>
<li>
<p><strong>Logical Volume Manager for Linux</strong> - LVM manages disk drives and allows
logical volumes to be resized on the fly. Many distributions of Linux use LVM
when they are installed, but Jenkins should have its our LVM setup.</p>
</li>
<li>
<p><strong>ZFS for Solaris</strong> - ZFS is even more flexible than LVM and spanned volumes
and just requires that the <em>$JENKINS_HOME</em> be on its own filesystem. This
makes it easier to create snapshots, backups, etc.</p>
</li>
<li>
<p><strong>Symbolic Links</strong> - For systems with existing Jenkins installations and who
cannot use any of the above-mentioned methods, symbolic links (symlinks) may
be used instead to store job folders on separate volumes with symlinks to
those directories.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, to easily prevent a <em>$JENKINS_HOME</em> folder from becoming bloated,
make it mandatory for jobs to discard build records after a specific time
period has passed and/or after a specific number of builds have been run. This
policy can be set on a job&#8217;s configuration page.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setting-up-a-backup-policy"><a class="anchor" href="#setting-up-a-backup-policy"></a>Setting up a backup policy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is a best practice to take regular backups of your $JENKINS_HOME. A backup
ensures that your Jenkins instance can be restored despite a misconfiguration,
accidental job deletion, or data corruption.</p>
</div>
<div class="sect2">
<h3 id="finding-your-jenkins_home"><a class="anchor" href="#finding-your-jenkins_home"></a>Finding your $JENKINS_HOME</h3>
<div class="paragraph">
<p><strong>Windows</strong></p>
</div>
<div class="paragraph">
<p>If you install Jenkins with the Windows installer, Jenkins will be installed as
a service and the default <em>$JENKINS_HOME</em> will be "C:\Program Files
(x86)\jenkins".</p>
</div>
<div class="paragraph">
<p>You can edit the location of your <em>$JENKINS_HOME</em> by opening the jenkins.xml
file and editing the <em>$JENKINS_HOME</em> variable, or going to the "Manage Jenkins"
screen, clicking on the "Install as Windows Service" option in the menu, and
then editing the "Installation Directory" field to point to another existing
directory.</p>
</div>
<div class="paragraph">
<p><strong>Mac OSX</strong></p>
</div>
<div class="paragraph">
<p>If you install Jenkins with the OS X installer, you can find and edit the
location of your <em>$JENKINS_HOME</em> by editing the "Macintosh
HD/Library/LaunchDaemons" file&#8217;s <em>$JENKINS_HOME</em> property.</p>
</div>
<div class="paragraph">
<p>By default, the <em>$JENKINS_HOME</em> will be set to "Macintosh
HD/Users/Shared/Jenkins".</p>
</div>
<div class="paragraph">
<p><strong>Linux</strong></p>
</div>
<div class="paragraph">
<p>By default, <code>$JENKINS_HOME</code> is set to <code>/var/lib/jenkins</code>
and <code>$JENKINS_WAR</code> is set to <code>/usr/share/java/jenkins.war</code>.</p>
</div>
<div class="paragraph">
<p>You can edit the location of <code>$JENKINS_HOME</code>
by running <code>systemctl edit jenkins</code> and adding the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>[Service]
Environment="HOME=/var/lib/jenkins"
Environment="JENKINS_HOME=/var/lib/jenkins"
WorkingDirectory=/var/lib/jenkins</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can edit the location of <code>$JENKINS_WAR</code>
by running <code>systemctl edit jenkins</code> and adding the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>[Service]
Environment="JENKINS_WAR=/usr/share/java/jenkins.war"</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>FreeBSD</strong></p>
</div>
<div class="paragraph">
<p>If installing Jenkins using a port, the <em>$JENKINS_HOME</em> will be located in
whichever directory you run the "make" command in. It is recommended to create
a "/usr/ports/devel/jenkins" folder and compile Jenkins in that directory.</p>
</div>
<div class="paragraph">
<p>You will be able to edit the <em>$JENKINS_HOME</em> by editing the
"/usr/local/etc/jenkins".</p>
</div>
<div class="paragraph">
<p><strong>OpenBSD</strong></p>
</div>
<div class="paragraph">
<p>If installing Jenkins using a package,the <em>$JENKINS_HOME</em> is set by default to
"/var/jenkins".</p>
</div>
<div class="paragraph">
<p>If installing Jenkins using a port, the <em>$JENKINS_HOME</em> will be located in
whichever directory you run the "make" command in. It is recommended to create
a "/usr/ports/devel/jenkins" folder and compile Jenkins in that directory.</p>
</div>
<div class="paragraph">
<p>You will be able to edit the <em>$JENKINS_HOME</em> by editing the
"/usr/local/etc/jenkins" file.</p>
</div>
<div class="paragraph">
<p><strong>Solaris/OpenIndiana</strong></p>
</div>
<div class="paragraph">
<p>The Jenkins project voted on September 17, 2014 to discontinue Solaris
packages.</p>
</div>
</div>
<div class="sect2">
<h3 id="anatomy-of-a-jenkins_home"><a class="anchor" href="#anatomy-of-a-jenkins_home"></a>Anatomy of a $JENKINS_HOME</h3>
<div class="paragraph">
<p>The folder structure for a <em>$JENKINS_HOME</em> directory is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>JENKINS_HOME
 +- config.xml     (Jenkins root configuration file)
 +- *.xml          (other site-wide configuration files)
 +- identity.key   (RSA key pair that identifies an instance)
 +- secret.key     (deprecated key used for some plugins' secure operations)
 +- secret.key.not-so-secret  (used for validating _$JENKINS_HOME_ creation date)
 +- userContent    (files served under your https://server/userContent/)
 +- secrets        (root directory for the secret+key for credential decryption)
     +- hudson.util.Secret   (used for encrypting some Jenkins data)
     +- master.key           (used for encrypting the hudson.util.Secret key)
     +- InstanceIdentity.KEY (used to identity this instance)
 +- fingerprints   (stores fingerprint records, if any)
 +- plugins        (root directory for all Jenkins plugins)
     +- [PLUGINNAME]   (sub directory for each plugin)
         +- META-INF       (subdirectory for plugin manifest + pom.xml)
         +- WEB-INF        (subdirectory for plugin jar(s) and licenses.xml)
     +- [PLUGINNAME].jpi   (.jpi or .hpi file for the plugin)
 +- jobs           (root directory for all Jenkins jobs)
     +- [JOBNAME]      (sub directory for each job)
         +- config.xml     (job configuration file)
         +- workspace      (working directory for the version control system)
         +- latest         (symbolic link to the last successful build)
         +- builds         (stores past build records)
             +- [BUILD_ID]     (subdirectory for each build)
                 +- build.xml      (build result summary)
                 +- log            (log file)
                 +- changelog.xml  (change log)
     +- [FOLDERNAME]   (sub directory for each folder)
         +- config.xml     (folder configuration file)
         +- jobs           (sub directory for all nested jobs)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="segrate-data"><a class="anchor" href="#segrate-data"></a>Segregating pure configuration from less durable data</h4>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
No data migration is handled by Jenkins when using those settings.
So you either want to use them from the beginning, or make sure you take into consideration which data you would like to be moved to the right place before using the following switches.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is possible to separate customize some of the layout to better separate pure job configurations from less durable data, like build data or logs.
<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</div>
<div class="sect4">
<h5 id="configure-a-different-jobs-build-data-layout"><a class="anchor" href="#configure-a-different-jobs-build-data-layout"></a>Configure a different <em>jobs build data</em> layout</h5>
<div class="paragraph">
<p>Historically, the configuration of a given job is located under <code>$JENKINS_HOME/jobs/[JOB_NAME]/config.xml</code> and its builds are under <code>$JENKINS_HOME/jobs/[JOB_NAME]/builds</code>.</p>
</div>
<div class="paragraph">
<p>This typically makes it more impractical to set up a different backup policy, or set up a quicker disk for making builds potentially faster.</p>
</div>
<div class="paragraph">
<p>For instance, if you would like to move builds under a different root, you can use the following value: <code>$JENKINS_VAR/${ITEM_FULL_NAME}/builds</code>.</p>
</div>
<div class="paragraph">
<p>Note that starting with Jenkins 2.119, the User Interface for this was replaced by the <code>jenkins.model.Jenkins.buildsDir</code> system property. See the <a href="/doc/book/managing/system-properties/">dedicated <em>Features Controlled with System Properties</em> wiki page</a> for more details.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="choosing-a-backup-strategy"><a class="anchor" href="#choosing-a-backup-strategy"></a>Choosing a backup strategy</h3>
<div class="paragraph">
<p>All of your Jenkins-specific configurations that need to be backed up will live
in the <em>$JENKINS_HOME</em>, but it is a best practice to back up only a subset of
those files and folders.</p>
</div>
<div class="paragraph">
<p>Below are a few guidelines to consider when planning your backup strategy.</p>
</div>
<div class="paragraph">
<div class="title">Exclusions</div>
<p>When it comes to creating a backup, it is recommended to exclude archiving the
following folders to reduce the size of your backup:</p>
</div>
<div class="literalblock">
<div class="content">
<pre class="nowrap">/war      (the exploded Jenkins war directory)
/cache    (downloaded tools)
/tools    (extracted tools)</pre>
</div>
</div>
<div class="paragraph">
<p>These folders will automatically be recreated the next time a build runs or
Jenkins is launched.</p>
</div>
<div class="paragraph">
<div class="title">Jobs and Folders</div>
<p>Your job or folder configurations, build histories, archived artifacts, and
workspace will exist entirely within the <em>jobs</em> folder.</p>
</div>
<div class="paragraph">
<p>The <em>jobs</em> directory, whether nested within a folder or at the root level is as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code> +- jobs           (root directory for all Jenkins jobs)
     +- [JOBNAME]      (sub directory for each job)
         +- config.xml     (job configuration file)
         +- workspace      (working directory for the version control system)
         +- latest         (symbolic link to the last successful build)
         +- builds         (stores past build records)
             +- [BUILD_ID]     (subdirectory for each build)
                 +- build.xml      (build result summary)
                 +- log            (log file)
                 +- changelog.xml  (change log)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you only need to backup your job configurations, you can opt to only backup
the <em>config.xml</em> for each job. Generally build records and workspaces do not
need to be backed up, as workspaces will be re-created when a job is run and
build records are only as important as your organizations deems them.</p>
</div>
<div class="paragraph">
<div class="title">System configurations</div>
<p>Your instance&#8217;s system configurations exist in the root level of the
<em>$JENKINS_HOME</em> folder:</p>
</div>
<div class="literalblock">
<div class="content">
<pre class="nowrap"> +- config.xml     (Jenkins root configuration file)
 +- *.xml          (other site-wide configuration files)</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>config.xml</em> is the root configuration file for your Jenkins. It includes
configurations for the paths of installed tools, workspace directory, and
agent port.</p>
</div>
<div class="paragraph">
<p>Any .xml other than that <em>config.xml</em> in the root Jenkins folder is a global
configuration file for an installed tool or plugin (i.e. Maven, Git, Ant, etc).
This includes the <em>credentials.xml</em> if the Credentials plugin is installed.</p>
</div>
<div class="paragraph">
<p>If you only want to backup your core Jenkins configuration, you only need to
back up the <em>config.xml</em>.</p>
</div>
<div class="paragraph">
<div class="title">Plugins</div>
<p>Your instance&#8217;s plugin files (.hpi and .jpi) and any of their dependent
resources (help files, <em>pom.xml</em> files, etc) will exist in the <em>plugins</em> folder
in $JENKINS_HOME.</p>
</div>
<div class="literalblock">
<div class="content">
<pre class="nowrap"> +- plugins        (root directory for all Jenkins plugins)
     +- [PLUGINNAME]     (sub directory for each plugin)
         +- META-INF       (subdirectory for plugin manifest + pom.xml)
         +- WEB-INF        (subdirectory for plugin jar(s) and licenses.xml)
     +- [PLUGINNAME].jpi (.jpi or .hpi file for the plugin)</pre>
</div>
</div>
<div class="paragraph">
<p>It is recommended to back up the entirety of the plugins folder (.hpi/.jpis + folders).</p>
</div>
<div class="paragraph">
<div class="title">Other data</div>
<p>Other data that you are recommended to back up include the contents of your
<em>secrets</em> folder, your <em>identity.key</em>, your <em>secret.key</em>, and your
<em>secret.key.not-so-secret</em> file.</p>
</div>
<div class="literalblock">
<div class="content">
<pre class="nowrap">+- identity.key   (RSA key pair that identifies an instance)
 +- secret.key     (used for various secure Jenkins operations)
 +- secret.key.not-so-secret  (used for validating _$JENKINS_HOME_ creation date)
 +- userContent    (files served in https://server/userContent/)
 +- secrets        (directory for the secret+key decryption)
     +- hudson.util.Secret   (used for encrypting some Jenkins data)
     +- master.key           (used for encrypting the hudson.util.Secret key)
     +- InstanceIdentity.KEY (used to identity this instance)</pre>
</div>
</div>
<div class="paragraph">
<p>The <em>identity.key</em> is an RSA key pair that identifies and authenticates the
current Jenkins instance.</p>
</div>
<div class="paragraph">
<p>The <em>secret.key</em> is used to encrypt plugin and other Jenkins data, and to
establish a secure connection between a controller and agent.</p>
</div>
<div class="paragraph">
<p>The <em>secret.key.not-so-secret</em> file is used to validate when the
<em>$JENKINS_HOME</em> was created. It is also meant to be a flag that the secret.key
file is a deprecated way of encrypting information.</p>
</div>
<div class="paragraph">
<p>The files in the secrets folder are used by Jenkins to encrypt and decrypt your
instance&#8217;s stored credentials, if any exist. Loss of these files will prevent
recovery of any stored credentials. <em>hudson.util.Secret</em> is used for encrypting
some Jenkins data like the credentials.xml, while the <em>master.key</em> is used for
encrypting the hudson.util.Secret key. Finally, the <em>InstanceIdentity.KEY</em> is
used to identity this instance and for producing digital signatures.</p>
</div>
</div>
<div class="sect2">
<h3 id="define-a-jenkins-instance-to-rollback-to"><a class="anchor" href="#define-a-jenkins-instance-to-rollback-to"></a>Define a Jenkins instance to rollback to</h3>
<div class="paragraph">
<p>In the case of a total machine failure, it is important to ensure that there is
a plan in place to get Jenkins both back online and in its last good state.</p>
</div>
<div class="paragraph">
<p>If a high availability set up has not been enabled and no back up of that
controller&#8217;s filesystem has been taken, then an corruption of a machine running
Jenkins means that all historical build data and artifacts, job and system
configurations, etc. will be lost and the lost configurations will need to be
recreated on a new instance.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Backup policy - In addition to creating backups using the previous section&#8217;s
backup guide, it is important to establish a policy for selecting which backup
should be used when restoring a downed controller.</p>
</li>
<li>
<p>Restoring from a backup - A plan must be put in place on whether the backup
should be restored manually or with scripts when the primary goes down.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="resilient-jenkins-architecture"><a class="anchor" href="#resilient-jenkins-architecture"></a>Resilient Jenkins Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Administrators are constantly adding more and more teams to the software
factory, making administrators in the business of making their instances
resilient to failures and scaling them in order to onboard more teams.</p>
</div>
<div class="paragraph">
<p>Adding build nodes to a Jenkins instance while beefing up the machine that runs
the Jenkins controller is the typical way to scale Jenkins. Said differently,
administrators scale their Jenkins controller vertically. However, there is a limit
to how much an instance can be scaled. These limitations are covered in the
introduction to this chapter.</p>
</div>
<div class="paragraph">
<p>Ideally, controllers will be set up to automatically recover from failures without
human intervention. There are proxy servers monitoring active controllers and
re-routing requests to backup controllers if the active controller goes down. There are
additional factors that should be reviewed on the path to continuous delivery.
These factors include componetizing the application under development,
automating the entire pipeline (within reasonable limits) and freeing up
contentious resources.</p>
</div>
<div class="paragraph">
<div class="title">Step 1: Make each controller highly available</div>
<p>Each Jenkins controller needs to be set up such that it is part of a Jenkins cluster.</p>
</div>
<div class="paragraph">
<p>A proxy (typically HAProxy or F5) then fronts the primary controller. The proxy&#8217;s
job is to continuously monitor the primary controller and route requests to the
backup if the primary goes down. To make the infrastructure more resilient, you
can have multiple backup controllers configured.</p>
</div>
<div class="paragraph">
<div class="title">Step 2: Enable security</div>
<p>Set up an authentication realm that Jenkins will use for its user database.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are trying to set up a proof-of-concept, it is recommended to use
the <a href="https://plugins.jenkins.io/mock-security-realm">Mock Security Realm plugin</a> for authentication.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Step 3: Add build nodes (agents) to controller</div>
<p>Add build servers to your controller to ensure you are conducting actual build
execution off of the controller, which is meant to be an orchestration hub, and
onto a "dumb" machine with sufficient memory and I/O for a given job or test.</p>
</div>
<div class="paragraph">
<div class="title">Step 4: Setup a test instance</div>
<p>A test instance is typically used to test new plugin updates. When a plugin is
ready to be used, it should be installed into the main production update
center.</p>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. These switches are used to configure out of the box <a href="/blog/2018/04/06/jenkins-essentials/">Jenkins Essentials</a> instances.
</div>
</div>
</div>
</div>
</div>
<hr>
<div>
<div class="row">
<div class="col-md-4">
</div>
<div class="col-md-4">
<a class="up doc-page-link" href="../">
⇑ Scaling Jenkins
</a>
<a class="index doc-page-link" href="../../">
Index
</a>
</div>
<div class="col-md-4">
<a class="next doc-page-link" href="../hardware-recommendations">
Hardware Recommendations ⇒
</a>
</div>
</div>
</div>
<hr>
<div class="container"></div>
<!-- starting partial _feedback-footer.html -->
<!-- HTML inclusion for chapter and section layouts (i.e. as footers) as well as
     for use in AsciiDoc file inclusions. -->

<!--
This feedback form was prepared from a Google Form, based on the techniques in
the following documentation sources:
https://codepen.io/learningcode/post/customize-a-google-form-for-your-website,
https://mrhaki.blogspot.com.au/2014/06/awesome-asciidoc-include-raw-html.html,
https://www.freshtechtips.com/2013/05/custom-google-drive-contact-form.html,
https://stackoverflow.com/questions/24436165/set-value-of-hidden-input-inside-form
-->

<!-- Feedback form functionality in JavaScript - refer to comments in this file
     for details on the functionality. -->
<script>
var feedbackForm = {
    formKey : 'e/1FAIpQLSfCEexH09x_-ytEyE7wetizqOvE_-06WkK89dpBLEJcYnOp8w'
};
$(document).ready(function() {
    window.onload = feedbackForm.start(window.location.href);
});
</script>
<script src="/js/feedback-form-functionality.js"></script>

<p><a href="#feedback" data-bs-toggle="collapse">Was this page helpful?</a></p>

<div id="feedback" class="collapse">

<p>Please submit your feedback about this page through this
<a href="/doc/feedback-form/">quick form</a>.</p>

<p>Alternatively, if you don't wish to complete the quick form, you can simply
indicate if you found this page helpful?</p>

<!-- Redirects to custom "thank you" page once form is submitted. -->
<script type="text/javascript">
var submitted=false;
</script>
<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"
onload="if(submitted) {window.location='/doc/thank-you-for-your-feedback/';}">
</iframe>
<form action="https://docs.google.com/forms/d/e/1FAIpQLSfCEexH09x_-ytEyE7wetizqOvE_-06WkK89dpBLEJcYnOp8w/formResponse" method="POST" id="ss-form" target="hidden_iframe" onsubmit="submitted=true;">

<!-- Set the value of the current URL into the form. -->
<input type="hidden" name="entry.1246830226" id="current-url" value=""/>

<!-- The answer bit -->
<p><input type="radio" name="entry.790002525" id="h1" value="Yes" required/>
<label for="h1">Yes</label>&nbsp;&nbsp;&nbsp;&nbsp;
<input type="radio" name="entry.790002525" id="h2" value="No"/>
<label for="h2">No</label></p>

<!-- The CAPTCHA bit -->

<p><label id="ssTestLabel" for="ssTestValue"></label><br/>
<input type="text" name="ssTestValue" value="" id="ssTestValue"/></p>

<!-- Submit button -->

<p><input class="button" type="submit" value="Submit"/></p>

</form>

<p>See existing feedback <a href="https://docs.google.com/spreadsheets/d/1IIdpVs39JDYKg0sLQIv-MNO928qcGApAIfdW5ohfD78" target="_blank" rel="noreferrer noopener">here</a>.</p>

</div>

<!-- ending partial _feedback-footer.html -->

</div>
</div>
</div>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//doc/book/scaling/architecting-for-scale.adoc"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
