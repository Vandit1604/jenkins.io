<!DOCTYPE html>
<html lang="en">
<head>
<title>
Jenkins CLI
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/doc/book/managing/cli/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Jenkins CLI" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Jenkins CLI" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Jenkins CLI" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/doc/book/managing/cli/" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Jenkins CLI" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row .col-lg-9 h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<div class="container">
<div class="row body flex-lg-nowrap">
<div class="col-lg-3" id="sidebar-menu">
<div class="sidebar-nav tour" id="sidebar-content">
<p>
<a href="/jenkins.io/independent-scrolling-patch/doc/" class="">> User Documentation Home</a>
</p>
<h5>
User Handbook
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/getting-started/" class="">User Handbook Overview</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/installing/" class="">Installing Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/using/" class="">Using Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/pipeline/" class="">Pipeline</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/blueocean/" class="">Blue Ocean</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/" class="active">Managing Jenkins</a>
<small>
<ul style="padding-left: 1rem;">
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/system-configuration/" class="">Configuring the System</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/casc/" class="">Configuration as Code</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/tools/" class="">Managing Tools</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/plugins/" class="">Managing Plugins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/about-jenkins/" class="">About Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/system-info/" class="">System Information</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/system-properties/" class="">Jenkins Features Controlled with System Properties</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/change-system-timezone/" class="">Change System Time Zone</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/cli/" class="active">Jenkins CLI</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/script-console/" class="">Script Console</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/groovy-hook-scripts/" class="">Groovy Hook Scripts</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/nodes/" class="">Managing Nodes</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/script-approval/" class="">In-process Script Approval</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/users/" class="">Manage Users</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/ui-themes/" class="">Themes for user interface</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/user-content/" class="">User Content</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/managing/spawning-processes/" class="">Spawning Processes From Build</a>
</li>
</ul>
</small>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/security/" class="">Securing Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/system-administration/" class="">System Administration</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/scaling/" class="">Scaling Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/troubleshooting/" class="">Troubleshooting Jenkins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/glossary/" class="">Glossary</a>
</li>
</ul>
<h5>
Tutorials
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/pipeline/tour/getting-started/" class="">Guided Tour</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/tutorials#pipeline" class="">Jenkins Pipeline</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/tutorials#tools" class="">Using Build Tools</a>
</li>
</ul>
<h5>
Resources
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/book/pipeline/syntax/" class="">Pipeline Syntax reference</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/pipeline/steps/" class="">Pipeline Steps reference</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/upgrade-guide/" class="">LTS Upgrade guides</a>
</li>
</ul>
</div>
</div>
<div class="col-lg-9">
<div>
<div class="row">
<div class="col-md-4">
<a class="prev doc-page-link" href="../change-system-timezone">
⇐ Change System Time Zone
</a>
</div>
<div class="col-md-4">
<a class="up doc-page-link" href="../">
⇑ Managing Jenkins
</a>
<a class="index doc-page-link" href="../../">
Index
</a>
</div>
<div class="col-md-4">
<a class="next doc-page-link" href="../script-console">
Script Console ⇒
</a>
</div>
</div>
</div>
<div>
<div class="row body">
<div class="section">
<h1>
Jenkins CLI
</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#ssh">Using the CLI over SSH</a>
<ul class="sectlevel2">
<li><a href="#authentication">Authentication</a></li>
<li><a href="#common-commands">Common Commands</a></li>
</ul>
</li>
<li><a href="#using-the-cli-client">Using the CLI client</a>
<ul class="sectlevel2">
<li><a href="#comparing-ssh-and-cli-client">Comparing SSH and CLI client</a></li>
<li><a href="#downloading-the-client">Downloading the client</a></li>
<li><a href="#using-the-client">Using the client</a></li>
<li><a href="#client-connection-modes">Client connection modes</a></li>
<li><a href="#common-problems-with-the-cli-client">Common Problems with the CLI client</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Jenkins has a built-in command line interface that allows users and
administrators to access Jenkins from a script or shell environment. This can
be convenient for scripting of routine tasks, bulk updates, troubleshooting,
and more.</p>
</div>
<div class="paragraph">
<p>The command line interface can be accessed over SSH or with the Jenkins CLI
client, a <code>.jar</code> file distributed with Jenkins.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This document assumes Jenkins 2.54 or newer.
Older versions of the CLI client are considered insecure and should not be used.</p>
</div>
<div class="paragraph">
<p>WebSocket support is available when using both server and client 2.217 or newer.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ssh"><a class="anchor" href="#ssh"></a>Using the CLI over SSH</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a new Jenkins installation, the SSH service is disabled by default.
Administrators may choose to set a specific port or ask Jenkins to pick a random port
in the <a href="../security/#ssh-server">Configure Global Security</a> page.
In order to determine the randomly assigned SSH port,
inspect the headers returned on a Jenkins URL, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>% curl -Lv https://JENKINS_URL/login 2&gt;&amp;1 | grep -i 'x-ssh-endpoint'
&lt; X-SSH-Endpoint: localhost:53801
%</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the random SSH port (<code>53801</code> in this example), and <a href="#authentication">Authentication</a>
configured, any modern SSH client may securely execute CLI commands.</p>
</div>
<div class="sect2">
<h3 id="authentication"><a class="anchor" href="#authentication"></a>Authentication</h3>
<div class="paragraph">
<p>Whichever user used for authentication with the Jenkins controller must have the
<code>Overall/Read</code> permission in order to <em>access</em> the CLI. The user may require
additional permissions depending on the commands executed.</p>
</div>
<div class="paragraph">
<p>Authentication in SSH mode relies on
SSH-based public/private key authentication. In order to add an SSH public key
for the appropriate user, navigate to
<code><a href="https://JENKINS_URL/me/configure" class="bare">JENKINS_URL/me/configure</a></code> and paste an SSH public key
into the appropriate text area.</p>
</div>
<div class="imageblock center">
<div class="content">
<img src="../../resources/managing/cli-adding-ssh-public-keys.png" alt="Adding public SSH keys for a user">
</div>
</div>
</div>
<div class="sect2">
<h3 id="common-commands"><a class="anchor" href="#common-commands"></a>Common Commands</h3>
<div class="paragraph">
<p>Jenkins has a number of built-in CLI commands which can be found in every
Jenkins environment, such as <code>build</code> or <code>list-jobs</code>. Plugins may also provide
CLI commands; in order to determine the full list of commands available
in a given Jenkins environment, execute the CLI <code>help</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>% ssh -l kohsuke -p 53801 localhost help</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following list of commands is not comprehensive, but it is a useful
starting point for Jenkins CLI usage.</p>
</div>
<div class="sect3">
<h4 id="build"><a class="anchor" href="#build"></a>build</h4>
<div class="paragraph">
<p>One of the most common and useful CLI commands is <code>build</code>, which allows the
user to trigger any job or Pipeline for which they have permission.</p>
</div>
<div class="paragraph">
<p>The most basic invocation will simply trigger the job or Pipeline and exit, but
with the additional options a user may also pass parameters, poll SCM, or even
follow the console output of the triggered build or Pipeline run.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>% ssh -l kohsuke -p 53801 localhost help build

java -jar jenkins-cli.jar build JOB [-c] [-f] [-p] [-r N] [-s] [-v] [-w]
Starts a build, and optionally waits for a completion.  Aside from general
scripting use, this command can be used to invoke another job from within a
build of one job.  With the -s option, this command changes the exit code based
on the outcome of the build (exit code 0 indicates a success) and interrupting
the command will interrupt the job.  With the -f option, this command changes
the exit code based on the outcome of the build (exit code 0 indicates a
success) however, unlike -s, interrupting the command will not interrupt the
job (exit code 125 indicates the command was interrupted).  With the -c option,
a build will only run if there has been an SCM change.
 JOB : Name of the job to build
 -c  : Check for SCM changes before starting the build, and if there's no
       change, exit without doing a build
 -f  : Follow the build progress. Like -s only interrupts are not passed
       through to the build.
 -p  : Specify the build parameters in the key=value format.
 -s  : Wait until the completion/abortion of the command. Interrupts are passed
       through to the build.
 -v  : Prints out the console output of the build. Use with -s
 -w  : Wait until the start of the command
% ssh -l kohsuke -p 53801 localhost build build-all-software -f -v
Started build-all-software #1
Started from command line by admin
Building in workspace /tmp/jenkins/workspace/build-all-software
[build-all-software] $ /bin/sh -xe /tmp/hudson1100603797526301795.sh
+ echo hello world
hello world
Finished: SUCCESS
Completed build-all-software #1 : SUCCESS
%</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="console"><a class="anchor" href="#console"></a>console</h4>
<div class="paragraph">
<p>Similarly useful is the <code>console</code> command, which retrieves the console output
for the specified build or Pipeline run. When no build number is provided, the
<code>console</code> command will output the last completed build&#8217;s console output.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>% ssh -l kohsuke -p 53801 localhost help console

java -jar jenkins-cli.jar console JOB [BUILD] [-f] [-n N]
Produces the console output of a specific build to stdout, as if you are doing 'cat build.log'
 JOB   : Name of the job
 BUILD : Build number or permalink to point to the build. Defaults to the last
         build
 -f    : If the build is in progress, stay around and append console output as
         it comes, like 'tail -f'
 -n N  : Display the last N lines
% ssh -l kohsuke -p 53801 localhost console build-all-software
Started from command line by kohsuke
Building in workspace /tmp/jenkins/workspace/build-all-software
[build-all-software] $ /bin/sh -xe /tmp/hudson1100603797526301795.sh
+ echo hello world
yes
Finished: SUCCESS
%</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="who-am-i"><a class="anchor" href="#who-am-i"></a>who-am-i</h4>
<div class="paragraph">
<p>The <code>who-am-i</code> command is helpful for listing the current user&#8217;s credentials
and permissions available to the user. This can be useful when debugging the
absence of CLI commands due to the lack of certain permissions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>% ssh -l kohsuke -p 53801 localhost help who-am-i

java -jar jenkins-cli.jar who-am-i
Reports your credential and permissions.
% ssh -l kohsuke -p 53801 localhost who-am-i
Authenticated as: kohsuke
Authorities:
  authenticated
%</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-the-cli-client"><a class="anchor" href="#using-the-cli-client"></a>Using the CLI client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While the SSH-based CLI is fast and covers most needs, there may be situations where the CLI
client distributed with Jenkins is a better fit. For example, the default transport for the CLI client
is HTTP which means no additional ports need to be opened in a firewall for its
use.</p>
</div>
<div class="sect2">
<h3 id="comparing-ssh-and-cli-client"><a class="anchor" href="#comparing-ssh-and-cli-client"></a>Comparing SSH and CLI client</h3>
<div class="paragraph">
<p>Both SSH and jenkins-cli.jar provide access to a set of commands that lets you interact with Jenkins from a command line, but they have a few differences:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Jenkins SSH does not require any custom jar file on the client side, making it easier to access Jenkins from a variety of sources</p>
</li>
<li>
<p>SSH client was build to be a generic tool to serve several purposes.
It doesn&#8217;t offer an easy way to do basic things that are common and specific to Jenkins environments.
Using the <code>jenkins-cli.jar</code> instead of the ssh client may increase productivity and improve the development experience</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="downloading-the-client"><a class="anchor" href="#downloading-the-client"></a>Downloading the client</h3>
<div class="paragraph">
<p>The CLI client can be downloaded directly from a Jenkins controller at the URL
<code>/jnlpJars/jenkins-cli.jar</code>, in effect  <code><a href="https://JENKINS_URL/jnlpJars/jenkins-cli.jar" class="bare">JENKINS_URL/jnlpJars/jenkins-cli.jar</a></code></p>
</div>
<div class="paragraph">
<p>While a CLI <code>.jar</code> can be used against different versions of Jenkins, should
any compatibility issues arise during use, please re-download the latest <code>.jar</code>
file from the Jenkins controller.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-the-client"><a class="anchor" href="#using-the-client"></a>Using the client</h3>
<div class="paragraph">
<p>The general syntax for invoking the client is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>java -jar jenkins-cli.jar [-s JENKINS_URL] [global options...] command [command options...] [arguments...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>JENKINS_URL</code> can be specified via the environment variable <code>$JENKINS_URL</code>.
Summaries of other general options can be displayed by running the client with no arguments at all.</p>
</div>
</div>
<div class="sect2">
<h3 id="client-connection-modes"><a class="anchor" href="#client-connection-modes"></a>Client connection modes</h3>
<div class="paragraph">
<p>There are three basic modes in which the client may be used, selectable by global option:
<code>-http</code>, <code>-webSocket</code>, and <code>-ssh</code>.</p>
</div>
<div class="sect3">
<h4 id="http-connection-mode"><a class="anchor" href="#http-connection-mode"></a>HTTP connection mode</h4>
<div class="paragraph">
<p>This is the default mode, though you may pass the <code>-http</code> option explicitly for clarity.</p>
</div>
<div class="paragraph">
<p>Authentication is preferably with an <code>-auth</code> option, which takes a <code>username:apitoken</code> argument.
Get your API token from <code>/me/configure</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>java -jar jenkins-cli.jar [-s JENKINS_URL] -auth kohsuke:abc1234ffe4a command ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Actual passwords are also accepted, but this is discouraged.)</p>
</div>
<div class="paragraph">
<p>You can also precede the argument with <code>@</code> to load the same content from a file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>java -jar jenkins-cli.jar [-s JENKINS_URL] -auth @/home/kohsuke/.jenkins-cli command ...</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For security reasons the use of a file to load the authentication credentials is the recommended authentication way.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An alternative authentication method is to configure environment variables in a similar way as the <code>$JENKINS_URL</code>
is used.
The <code>username</code> can be specified via the environment variable <code>$JENKINS_USER_ID</code> while the <code>apitoken</code> can
be specified via the variable <code>$JENKINS_API_TOKEN</code>.
Both variables have to be set all at once.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>export JENKINS_USER_ID=kohsuke
export JENKINS_API_TOKEN=abc1234ffe4a
java -jar jenkins-cli.jar [-s JENKINS_URL] command ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>In case these environment variables are configured you could still override the authentication method using different
credentials with the <code>-auth</code> option, which takes preference over them.</p>
</div>
<div class="paragraph">
<p>Generally no special system configuration need be done to enable HTTP-based CLI connections.
If you are running Jenkins behind an HTTP(S) reverse proxy,
ensure it does not buffer request or response bodies.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This mode is known to not work reliably or at all when using certain reverse proxies.
Prefer WebSocket mode.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="websocket-connection-mode"><a class="anchor" href="#websocket-connection-mode"></a>WebSocket connection mode</h4>
<div class="paragraph">
<p>In Jenkins 2.217 and above, the <code>-webSocket</code> mode may be used as an alternative to <code>-http</code>.
The advantage is that a more standard transport is used,
avoiding problems with many reverse proxies or the need for special proxy configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="ssh-connection-mode"><a class="anchor" href="#ssh-connection-mode"></a>SSH connection mode</h4>
<div class="paragraph">
<p>Authentication is via SSH keypair.
You must select the Jenkins user ID as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>java -jar jenkins-cli.jar [-s JENKINS_URL] -ssh -user kohsuke command ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this mode, the client acts essentially like a native <code>ssh</code> command.</p>
</div>
<div class="paragraph">
<p>By default the client will try to connect to an SSH port on the same host as is used in the <code>JENKINS_URL</code>.
If Jenkins is behind an HTTP reverse proxy, this will not generally work,
so run Jenkins with the system property <code>-Dorg.jenkinsci.main.modules.sshd.SSHD.hostName=ACTUALHOST</code>
to define a hostname or IP address for the SSH endpoint.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="common-problems-with-the-cli-client"><a class="anchor" href="#common-problems-with-the-cli-client"></a>Common Problems with the CLI client</h3>
<div class="paragraph">
<p>There are a number of common problems that may be experienced when running the
CLI client.</p>
</div>
<div class="sect3">
<h4 id="server-key-did-not-validate"><a class="anchor" href="#server-key-did-not-validate"></a>Server key did not validate</h4>
<div class="paragraph">
<p>You may get the error below and find a log entry just below that concerning <code>mismatched keys</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>org.apache.sshd.common.SshException: Server key did not validate
    at org.apache.sshd.client.session.AbstractClientSession.checkKeys(AbstractClientSession.java:523)
    at org.apache.sshd.common.session.helpers.AbstractSession.handleKexMessage(AbstractSession.java:616)
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This means your SSH configuration does not recognize the public key presented by the server.
It&#8217;s often the case when you run Jenkins in dev mode and multiple instances
of the application are run under the same SSH port over time.</p>
</div>
<div class="paragraph">
<p>In a development context, access your <code>~/.ssh/known_hosts</code> (or in <code>C:/Users/&lt;your_name&gt;/.ssh/known_hosts</code> for Windows)
and remove the line corresponding to your current SSH port (e.g. <code>[localhost]:3485</code>).
In a production context, check with the Jenkins administrator if the public key of the server changed recently.
If so, ask the administrator to do the the steps described above.</p>
</div>
</div>
<div class="sect3">
<h4 id="usernamenotfoundexception"><a class="anchor" href="#usernamenotfoundexception"></a>UsernameNotFoundException</h4>
<div class="paragraph">
<p>If your client displays a stacktrace that looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code>org.acegisecurity.userdetails.UsernameNotFoundException: &lt;name_you_used&gt;
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This means your SSH keys were recognized and validated against the stored users but the username is not valid for the security realm your application is using at the moment.
This could occur when you were using the Jenkins database initially, configured your users, and then switched to another security realm (like LDAP, etc.) where the defined users do not exist yet.</p>
</div>
<div class="paragraph">
<p>To solve the problem, ensure your users exist in your configured security realm.</p>
</div>
</div>
<div class="sect3">
<h4 id="troubleshooting-logs"><a class="anchor" href="#troubleshooting-logs"></a>Troubleshooting logs</h4>
<div class="paragraph">
<p>To get more information about the authentication process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go into <strong>Manage Jenkins</strong> &gt; <strong>System Log</strong> &gt; <strong>Add new log recorder</strong>.</p>
</li>
<li>
<p>Enter any name you want and click on <strong>Ok</strong>.</p>
</li>
<li>
<p>Click on <strong>Add</strong></p>
</li>
<li>
<p>Type <code>org.jenkinsci.main.modules.sshd.PublicKeyAuthenticatorImpl</code> (or type <code>PublicKeyAuth</code> and then select the full name)</p>
</li>
<li>
<p>Set the level to <strong>ALL</strong>.</p>
</li>
<li>
<p>Repeat the previous three steps for <code>hudson.model.User</code></p>
</li>
<li>
<p>Click on <strong>Save</strong></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When you try to authenticate, you can then refresh the page and see what happen internally.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr>
<div>
<div class="row">
<div class="col-md-4">
<a class="prev doc-page-link" href="../change-system-timezone">
⇐ Change System Time Zone
</a>
</div>
<div class="col-md-4">
<a class="up doc-page-link" href="../">
⇑ Managing Jenkins
</a>
<a class="index doc-page-link" href="../../">
Index
</a>
</div>
<div class="col-md-4">
<a class="next doc-page-link" href="../script-console">
Script Console ⇒
</a>
</div>
</div>
</div>
<hr>
<div class="container"></div>
<!-- starting partial _feedback-footer.html -->
<!-- HTML inclusion for chapter and section layouts (i.e. as footers) as well as
     for use in AsciiDoc file inclusions. -->

<!--
This feedback form was prepared from a Google Form, based on the techniques in
the following documentation sources:
https://codepen.io/learningcode/post/customize-a-google-form-for-your-website,
https://mrhaki.blogspot.com.au/2014/06/awesome-asciidoc-include-raw-html.html,
https://www.freshtechtips.com/2013/05/custom-google-drive-contact-form.html,
https://stackoverflow.com/questions/24436165/set-value-of-hidden-input-inside-form
-->

<!-- Feedback form functionality in JavaScript - refer to comments in this file
     for details on the functionality. -->
<script>
var feedbackForm = {
    formKey : 'e/1FAIpQLSfCEexH09x_-ytEyE7wetizqOvE_-06WkK89dpBLEJcYnOp8w'
};
$(document).ready(function() {
    window.onload = feedbackForm.start(window.location.href);
});
</script>
<script src="/js/feedback-form-functionality.js"></script>

<p><a href="#feedback" data-bs-toggle="collapse">Was this page helpful?</a></p>

<div id="feedback" class="collapse">

<p>Please submit your feedback about this page through this
<a href="/doc/feedback-form/">quick form</a>.</p>

<p>Alternatively, if you don't wish to complete the quick form, you can simply
indicate if you found this page helpful?</p>

<!-- Redirects to custom "thank you" page once form is submitted. -->
<script type="text/javascript">
var submitted=false;
</script>
<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"
onload="if(submitted) {window.location='/doc/thank-you-for-your-feedback/';}">
</iframe>
<form action="https://docs.google.com/forms/d/e/1FAIpQLSfCEexH09x_-ytEyE7wetizqOvE_-06WkK89dpBLEJcYnOp8w/formResponse" method="POST" id="ss-form" target="hidden_iframe" onsubmit="submitted=true;">

<!-- Set the value of the current URL into the form. -->
<input type="hidden" name="entry.1246830226" id="current-url" value=""/>

<!-- The answer bit -->
<p><input type="radio" name="entry.790002525" id="h1" value="Yes" required/>
<label for="h1">Yes</label>&nbsp;&nbsp;&nbsp;&nbsp;
<input type="radio" name="entry.790002525" id="h2" value="No"/>
<label for="h2">No</label></p>

<!-- The CAPTCHA bit -->

<p><label id="ssTestLabel" for="ssTestValue"></label><br/>
<input type="text" name="ssTestValue" value="" id="ssTestValue"/></p>

<!-- Submit button -->

<p><input class="button" type="submit" value="Submit"/></p>

</form>

<p>See existing feedback <a href="https://docs.google.com/spreadsheets/d/1IIdpVs39JDYKg0sLQIv-MNO928qcGApAIfdW5ohfD78" target="_blank" rel="noreferrer noopener">here</a>.</p>

</div>

<!-- ending partial _feedback-footer.html -->

</div>
</div>
</div>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//doc/book/managing/cli.adoc"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
