<!DOCTYPE html>
<html lang="en">
<head>
<title>
Storing Secrets
</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="description">
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="ie=edge" http-equiv="x-ua-compatible">
<link href="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/doc/developer/security/secrets/" rel="canonical">
<!-- Favicons -->
<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/site.webmanifest" rel="manifest">
<link color="#5bbad5" href="/safari-pinned-tab.svg" rel="mask-icon">
<meta content="#2b5797" name="msapplication-TileColor">
<meta content="#ffffff" name="theme-color">
<meta content="Storing Secrets" name="apple-mobile-web-app-title">
<!-- Twitter Card data -->
<meta content="summary_large_image" name="twitter:card">
<meta content="@JenkinsCI" name="twitter:site">
<meta content="Storing Secrets" name="twitter:title">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="twitter:description">
<meta content="@JenkinsCI" name="twitter:creator">
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="twitter:image">
<!-- Open Graph data -->
<meta content="Storing Secrets" property="og:title">
<meta content="article" property="og:type">
<meta content="https://Vandit1604.github.io/jenkins.io/independent-scrolling-patch/doc/developer/security/secrets/" property="og:url">
<meta content="Jenkins – an open source automation server which enables developers around the world to reliably build, test, and deploy their software" name="og:description">
<meta content="Storing Secrets" property="og:site_name">
<meta content="/jenkins.io/independent-scrolling-patch/images/logo-title-opengraph.png" name="og:image">
<link href="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/css/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/jenkins.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/stylesheets/styles.css" media="screen" rel="stylesheet">
<!-- Non-obtrusive CSS styles -->
<link href="/jenkins.io/independent-scrolling-patch/css/footer.css" media="screen" rel="stylesheet">
<link href="/jenkins.io/independent-scrolling-patch/css/font-awesome.min.css" media="screen" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
</head>
<body>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/jquery/jquery.min.js"></script>
<!-- starting partial toptoolbar.html.haml -->
<jio-navbar class="fixed-top" id="ji-toolbar" property="https://www.jenkins.io" showSearchBox=""></jio-navbar>
<!-- Spacing to make the fixed-top sticky navbar not occlude any content below it -->
<div class="pt-4">
&nbsp;
</div>

<!-- ending partial toptoolbar.html.haml -->
<style>
  h4 {
    font-size: 22px;
  }
  div.container .row.body {
    margin-right: 1em;
    margin-left: 1em;
    padding-left: 0;
    padding-right: 0;
  }
  .toc {
      float: right;
  }
  div.sidebar-nav > ul {
    list-style: none;
    padding-inline-start: 2em;
  }
  ion-icon {
    color: #bf6900;
  }
  .jenkins-developer-chapters {
    list-style: none;
    padding-inline-start: 0;
    padding-left: 0;
    padding-right: 0;
  }
  #dev-docs {
    margin-bottom: 1em;
  }
  #reference-topics {
    font-weight: normal;
  }
  #reference-topics:active {
    font-weight: bold;
  }
  #taglibs {
    margin-bottom: 2em;
    font-weight: normal;
  }
  #taglibs:active {
    font-weight: bold;
  }
  #how-to-guides {
    font-weight: normal;
  }
  #how-to-guides:active {
    font-weight: bold;
  }
  #plugin-tutorial {
    font-weight: normal;
  }
  #plugin-tutorial:active {
    font-weight: bold;
  }
  #javadoc {
    font-weight: normal;
  }
  #javadoc:active {
    font-weight: bold;
  }
</style>
<!-- starting partial anchors.html.haml -->
<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row .col-8 h' + i);
    }
  })
</script>

<!-- ending partial anchors.html.haml -->
<div class="container">
<div class="row body flex-nowrap">
<div class="col-4" id="sidebar-menu">
<div class="sidebar-nav tour" id="sidebar-content">
<p>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/" class="">> Developer Documentation Home</a>
</p>
<h4 id="dev-docs">
Developer Documentation
</h4>
<h5 id="plugin-tutorial">
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/tutorial/" class="">Plugin Tutorial</a>
</h5>
<h5 id="how-to-guides">
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/guides/" class="">How-To Guides</a>
</h5>
<h5 id="reference-topics">
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/book/" class="">Reference Topics</a>
</h5>
<ul>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/architecture/" class="">Architecture</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/initialization/" class="">Initialization and Startup</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/extensibility/" class="">Extensibility</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/model/" class="">Model</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/handling-requests/" class="">Handling Requests</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/security/" class="active">Security</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
<small>
<ul style="padding-left: 1rem;">
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/security/secrets/" class="active">Storing Secrets</a>
</li>
</ul>
</small>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/persistence/" class="">Persistent Objects</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/scheduling/" class="">Scheduling</a>
<span title="Early work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/views/" class="">Views</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/forms/" class="">Forms</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/internationalization/" class="">Internationalization and Localization</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/distributed-builds/" class="">Distributed Builds</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/cli/" class="">Jenkins CLI</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/testing/" class="">Testing</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/telemetry/" class="">Telemetry</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/plugin-development/" class="">Plugin Development</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/plugin-governance/" class="">Plugin Governance</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/publishing/" class="">Publishing Plugins</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/blueocean-plugin-development/" class="">Blue Ocean</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/building/" class="">Building and Debugging</a>
<span title="Partial work in progress">
<ion-icon name="warning" style="opacity: 0.5;"></ion-icon>
</span>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/development-environment/" class="">Development Environment</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/crowdin/" class="">Jenkins Crowdin Integration</a>
</li>
<li>
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/tutorial-improve/" class="">Improve a Plugin Tutorial</a>
</li>
</ul>
<h5>
Resources
</h5>
<h6 style="padding-left: 2rem;">
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/extensions/" class="">Extensions Index</a>
</h6>
<h6 id="javadoc" style="padding-left: 2rem;">
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/javadoc/" class="">Javadoc</a>
</h6>
<h6 id="taglibs" style="padding-left: 2rem;">
<a href="/jenkins.io/independent-scrolling-patch/doc/developer/development-environment/taglibs/" class="">Taglibs</a>
</h6>
<h5>
Tools
</h5>
<ul>
<li>
<a href="https://jenkinsci.github.io/maven-hpi-plugin/" rel="noreferrer noopener" target="_blank">
Maven HPI Plugin
</a>
</li>
</ul>
</div>
</div>
<div class="col-8">
<h1>
Storing Secrets
</h1>
<div class="paragraph">
<p>Plugins commonly store user credentials and similar secrets, like API keys, access tokens, or just user names and passwords, to interface with other systems and services.
Plugins that store such secrets need to be careful how they store them.
With simple <code>String</code> fields that get serialized to disk as plain text, a number of problems can occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On many systems, large parts of the Jenkins home directory is accessible to other user accounts, allowing to retrieve credentials stored on disk as plain text.</p>
</li>
<li>
<p>Backups of Jenkins home can be compromised, disclosing secrets, even when excluding the secrets/ directory.</p>
</li>
<li>
<p>String fields are round-tripped in configuration forms as plain text even if the value is hidden in a password field, so can be accessed via the HTML page source code. This even applies to users who only have the <a href="https://plugins.jenkins.io/extended-read-permission">Extended Read</a> permission.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The easiest solution to all of the above is to store the password as a <a href="https://javadoc.jenkins.io/byShortName/Secret" title="Javadoc for Secret">Secret</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The key to decrypt secrets is stored in the <code>secrets/</code> directory which has the highest protection, and is recommended to be excluded from backups.</p>
</li>
<li>
<p><code>Secret</code> fields are round-tripped in their encrypted form, so that their plain-text form cannot be retrieved by users later.
If a user only has the Extended Read permission, the secret is simply removed from output.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A more advanced option is to integrate with <a href="https://plugins.jenkins.io/credentials">Credentials Plugin</a>. See <a href="https://github.com/jenkinsci/credentials-plugin/tree/master/docs">its documentation</a> for more information.</p>
</div>
<div class="sect2">
<h3 id="storing-secrets-on-disk"><a class="anchor" href="#storing-secrets-on-disk"></a>Storing Secrets on Disk</h3>
<div class="paragraph">
<p>The easiest way to store secrets is to store them in a field of the type <a href="https://javadoc.jenkins.io/byShortName/Secret" title="Javadoc for Secret">Secret</a>, and access that field in your other code via a getter that returns the same type.
Jenkins will transparently handle the encryption and decryption for on-disk storage.</p>
</div>
<div class="paragraph">
<p>An example for how to use a <code>Secret</code> shared between all instances of a build step is below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBuilder</span> <span class="kd">extends</span> <span class="nc">Builder</span> <span class="kd">implements</span> <span class="nc">SimpleBuildStep</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">perform</span><span class="o">(</span><span class="nc">Run</span><span class="o">&lt;?,?&gt;</span> <span class="n">run</span><span class="o">,</span> <span class="nc">FilePath</span> <span class="n">workspace</span><span class="o">,</span> <span class="nc">Launcher</span> <span class="n">launcher</span><span class="o">,</span> <span class="nc">TaskListener</span> <span class="n">listener</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">password</span> <span class="o">=</span> <span class="o">((</span><span class="nc">MyBuilder</span><span class="o">.</span><span class="na">DescriptorImpl</span><span class="o">)</span><span class="n">getDescriptor</span><span class="o">()).</span><span class="na">getPassword</span><span class="o">().</span><span class="na">getPlainText</span><span class="o">();</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="c1">// Perform work with the password here, like sending HTTP requests etc.</span>
        <span class="c1">// Secret#toString will also obtain the plain text, but it's deprecated and will log a warning.</span>
    <span class="o">}</span>

    <span class="nd">@Extension</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">DescriptorImpl</span> <span class="kd">extends</span> <span class="nc">BuildStepDescriptor</span><span class="o">&lt;</span><span class="nc">Builder</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nc">Secret</span> <span class="n">password</span><span class="o">;</span> <i class="conum" data-value="2"></i><b>(2)</b>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPassword</span><span class="o">(</span><span class="nc">Secret</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="nc">Secret</span> <span class="nf">getPassword</span><span class="o">()</span> <span class="o">{</span> <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="k">return</span> <span class="n">password</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">StaplerRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">JSONObject</span> <span class="n">json</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">FormException</span> <span class="o">{</span>
            <span class="n">req</span><span class="o">.</span><span class="na">bindJSON</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">json</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="c1">// more code</span>
    <span class="o">}</span>

    <span class="c1">// more code</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To use the password, obtain the plain text.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>Secret</code> field will store the password encrypted on disk.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>Secret</code> getter, if used by the <code>f:password</code> form field (below), will round-trip the password on the UI in encrypted form and hide it from users without Configure permission.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="secrets-and-configuration-forms"><a class="anchor" href="#secrets-and-configuration-forms"></a>Secrets and Configuration Forms</h3>
<div class="paragraph">
<p>In the configuration form, display the secret itself (rather than the decrypted secret) hidden in a <code>&lt;f:password&gt;</code> field.
This requires that the getter or public field used to populate the form element also is a <a href="https://javadoc.jenkins.io/byShortName/Secret" title="Javadoc for Secret">Secret</a> (see above).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="xml">  <span class="nt">&lt;f:entry</span> <span class="na">title=</span><span class="s">"${%Password}"</span> <span class="na">field=</span><span class="s">"password"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;f:password</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/f:entry&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Secrets spanning multiple lines (such as certificates or SSH keys) should be masked from view by using the <code>&lt;f:secretTextarea&gt;</code> form element.
It is available from Jenkins 2.171.
Plugins with older core baselines can add a dependency on the standalone library <code>io.jenkins.temp.jelly:multiline-secrets-ui:1.0</code> (or newer) with the same form element.
See <a href="https://github.com/jenkinsci/lib-multiline-secrets-ui/blob/master/README.md">the documentation in its GitHub repository</a> for usage instructions and sample code.</p>
</div>
</div>
<div class="sect2">
<h3 id="encryption-of-secrets-and-credentials"><a class="anchor" href="#encryption-of-secrets-and-credentials"></a>Encryption of Secrets and Credentials</h3>
<div class="paragraph">
<p>Jenkins uses AES to encrypt and protect secrets, credentials, and their respective encryption keys.
These encryption keys are stored in <code>$JENKINS_HOME/secrets/</code> along with the master key used to protect said keys.
This directory should be configured so that only the operating system user the Jenkins controller is running as has read and write access to this directory (i.e., a <code>chmod</code> value of <code>0700</code> or using appropriate file attributes).
The master key (sometimes referred to as a "key encryption key" in cryptojargon) is stored <em>unencrypted</em> on the Jenkins controller filesystem in <code>$JENKINS_HOME/secrets/master.key</code> which does not protect against attackers with direct access to that file.
Most users and developers will use these encryption keys indirectly via either the <a href="https://javadoc.jenkins.io/byShortName/Secret" title="Javadoc for Secret">Secret</a> API for encrypting generic secret data or through the credentials API.
For the cryptocurious, Jenkins uses AES in cipher block chaining (CBC) mode with PKCS#5 padding and random IVs to encrypt instances of <a href="https://javadoc.jenkins.io/byShortName/CryptoConfidentialKey" title="Javadoc for CryptoConfidentialKey">CryptoConfidentialKey</a> which are stored in <code>$JENKINS_HOME/secrets/</code> with a filename corresponding to their <code>CryptoConfidentialKey</code> id.
Common key ids include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hudson.util.Secret</code>: used for generic secrets;</p>
</li>
<li>
<p><code>com.cloudbees.plugins.credentials.SecretBytes.KEY</code>: used for some credentials types;</p>
</li>
<li>
<p><code>jenkins.model.Jenkins.crumbSalt</code>: used by the <a href="https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery">CSRF protection mechanism</a>; and</p>
</li>
<li>
<p><code>org.jenkinsci.main.modules.instance_identity.InstanceIdentity.KEY</code>: used to identify the Jenkins instance.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>


<script src="/jenkins.io/independent-scrolling-patch/assets/bower/anchor-js/anchor.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/@popperjs/core/umd/popper.min.js"></script>
<script src="/jenkins.io/independent-scrolling-patch/assets/bower/bootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lit@2.5.0/polyfill-support.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.6.0/webcomponents-loader.js"></script>
<script data="ionicons" defer="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.esm.js" type="module"></script>
<script data="ionicons" defer="" nomodule="" src="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.5.2/ionicons/ionicons.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm" type="module"></script>
<script defer="" nomodule="" src="https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/"></script>
<jio-footer githubBranch="master" githubRepo="jenkins-infra/jenkins.io" property="https://www.jenkins.io" sourcePath="content//doc/developer/security/secrets.adoc"></jio-footer>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
ga('create', 'UA-000000-0', 'auto');
ga('send', 'pageview');
ga('set', 'anonymizeIp', true);

</script>

<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3" type="text/javascript"></script>
<script type="text/javascript">
docsearch({
  container: document.querySelector('input.searchbox').parentNode,
  indexName: 'jenkins',
  appId: "M6L7Q4Z8HS",
  apiKey: "52f8dfbff76ffd9106f1c68fee16154b",
  algoliaOptions: { 'facetFilters': ["tags:en"] },
  debug: false
});
</script>
</body>
</html>
